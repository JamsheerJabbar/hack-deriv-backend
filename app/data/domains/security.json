{
  "domain": "security",
  "description": "Configuration for security domain",
  "schema_context": "The database consists of exactly three tables: 'users' (identity/profile), 'transactions' (all financial acts like payments, trades, deposits), and 'login_events' (security logs). There are NO other tables.",
  "prompts": {
    "intent": "You are an AI assistant for the Security domain of a financial insights platform.\nYour task is to classify the user's intent and extract key parameters.\n\nFocus on:\n- Users and Profiles (username, age, kyc_status, risk_level, account_status)\n- Transactions and Trading (instrument, amount, currency, status, txn_type)\n- Login Events and Security (ip_address, country, city, device_type, failure_reason)\n\nIf the user asks for data retrieval, classify it as SELECT.\nIf the user's request is ambiguous, set needs_clarification to true.\n\n\nDOMAIN SPECIFIC INSTRUCTION:\nWhen analyzing user requests related to security data, pay close attention to terms like 'KYC status', 'risk level', 'risk score', 'PEP' (Politically Exposed Person), 'transaction type' (e.g., DEPOSIT, WITHDRAWAL, TRADE), 'status' (e.g., COMPLETED, FAILED, FLAGGED), 'flag reason' (e.g., AML alert, Geo mismatch), 'login status' (e.g., SUCCESS, FAILED, BLOCKED), and 'failure reason' (e.g., Invalid password, Account locked). These terms are critical for accurately identifying the user's intent and mapping it to the correct database operations.",
    "sql": "You are a strict SQLite expert for Security.\nACTUAL TABLES:\n- users (user_id, username, age, kyc_status, risk_level, risk_score, is_pep, account_status)\n- transactions (txn_id, user_id, txn_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method)\n- login_events (event_id, user_id, status, country, city, device_type, failure_reason)\n\nRULES:\n1. ONLY use tables: users, transactions, login_events.\n2. If user mentions 'payment', 'transfer', 'debit', or 'credit', ALWAYS use 'transactions' table.\n3. If user mentions 'flag', use 'transactions.status' or 'transactions.flag_reason'.\n4. USE 'username' for names and 'user_id' for IDs. NEVER use 'name' or 'id'.\n5. JOIN users and transactions on 'user_id'.\n6. Use UPPER() and LIKE with % for all string comparisons.\n"
  },
  "few_shots": [
    {
      "question": "Show me the usernames of users with instrument AMZN",
      "sql": "SELECT DISTINCT u.username FROM users u JOIN transactions t ON u.user_id = t.user_id WHERE UPPER(t.instrument) LIKE '%AMZN%';",
      "explanation": "Joins users and transactions using correct username column."
    },
    {
      "question": "Show failed login attempts for users with HIGH risk level",
      "sql": "SELECT le.*, u.username FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE UPPER(le.status) LIKE '%FAILED%' AND UPPER(u.risk_level) LIKE '%HIGH%';",
      "explanation": "Joins logins and users using correct columns."
    },
    {
      "question": "Find debit payments that were flagged",
      "sql": "SELECT t.*, u.username FROM transactions t JOIN users u ON t.user_id = u.user_id WHERE UPPER(t.payment_method) LIKE '%DEBIT%' AND UPPER(t.status) LIKE '%FLAGGED%';",
      "explanation": "Correctly uses transactions table for payments/debit and status for flagged."
    },
    {
      "question": "What is the average age of PEP users?",
      "sql": "SELECT AVG(age) FROM users WHERE is_pep = 1;",
      "explanation": "Simple filter on users table."
    }
  ],
  "db_profile": {
    "users": {
      "columns": [
        "user_id",
        "username",
        "age",
        "kyc_status",
        "risk_level",
        "risk_score",
        "is_pep",
        "account_status",
        "created_at",
        "updated_at"
      ],
      "unique_values": {
        "user_id": [
          "1",
          "10",
          "100",
          "11",
          "12",
          "13",
          "14",
          "15",
          "16",
          "17",
          "18",
          "19",
          "2",
          "20",
          "21",
          "22",
          "23",
          "24",
          "25",
          "26"
        ],
        "username": [
          "john_smith",
          "emma_wilson",
          "michael_brown",
          "sarah_davis",
          "james_miller",
          "olivia_garcia",
          "william_martinez",
          "ava_rodriguez",
          "alexander_lee",
          "sophia_hernandez",
          "benjamin_lopez",
          "mia_gonzalez",
          "ethan_wilson",
          "isabella_anderson",
          "daniel_thomas",
          "charlotte_taylor",
          "matthew_moore",
          "amelia_jackson",
          "joseph_martin",
          "harper_white"
        ],
        "age": [
          34,
          28,
          45,
          52,
          31,
          29,
          67,
          41,
          25,
          38,
          55,
          33,
          48,
          27,
          62,
          36,
          43,
          30,
          58,
          24
        ],
        "kyc_status": [
          "VERIFIED",
          "PENDING"
        ],
        "risk_level": [
          "LOW",
          "MEDIUM",
          "HIGH",
          "CRITICAL"
        ],
        "risk_score": [
          12,
          8,
          45,
          72,
          15,
          10,
          38,
          68,
          5,
          89,
          42,
          18,
          52,
          7,
          75,
          48,
          22,
          11,
          71,
          6
        ],
        "is_pep": [
          0,
          1
        ],
        "account_status": [
          "ACTIVE",
          "SUSPENDED",
          "INACTIVE",
          "PENDING"
        ],
        "created_at": [
          "2023-01-15T09:30:00Z",
          "2023-02-20T11:45:00Z",
          "2022-11-05T14:20:00Z",
          "2022-08-12T08:00:00Z",
          "2023-03-25T10:30:00Z",
          "2023-04-10T13:15:00Z",
          "2021-06-18T09:00:00Z",
          "2022-01-22T16:45:00Z",
          "2024-01-05T11:00:00Z",
          "2022-03-14T14:30:00Z",
          "2021-09-28T08:15:00Z",
          "2023-05-12T10:00:00Z",
          "2022-04-08T15:30:00Z",
          "2023-08-20T09:45:00Z",
          "2020-12-01T11:00:00Z",
          "2022-07-15T13:00:00Z",
          "2022-10-30T14:15:00Z",
          "2023-06-25T10:30:00Z",
          "2021-03-18T09:00:00Z",
          "2024-02-14T12:00:00Z"
        ],
        "updated_at": [
          "2025-12-10T14:22:00Z",
          "2025-11-28T09:15:00Z",
          "2025-12-05T16:30:00Z",
          "2025-10-15T11:00:00Z",
          "2025-12-12T08:45:00Z",
          "2025-11-30T17:20:00Z",
          "2025-12-01T10:10:00Z",
          "2025-12-08T13:30:00Z",
          "2025-12-14T09:00:00Z",
          "2025-09-20T15:45:00Z",
          "2025-11-25T12:00:00Z",
          "2025-12-11T14:15:00Z",
          "2025-12-03T11:30:00Z",
          "2025-12-09T16:00:00Z",
          "2025-11-18T10:30:00Z",
          "2025-08-22T09:15:00Z",
          "2025-12-13T08:00:00Z",
          "2025-12-07T15:45:00Z",
          "2025-11-29T11:20:00Z",
          "2025-12-15T09:30:00Z"
        ]
      }
    },
    "transactions": {
      "columns": [
        "txn_id",
        "user_id",
        "txn_type",
        "instrument",
        "amount",
        "currency",
        "amount_usd",
        "status",
        "flag_reason",
        "payment_method",
        "external_ref",
        "ip_address",
        "created_at",
        "processed_at"
      ],
      "unique_values": {
        "txn_id": [
          "TXN-000001",
          "TXN-000002",
          "TXN-000003",
          "TXN-000004",
          "TXN-000005",
          "TXN-000006",
          "TXN-000007",
          "TXN-000008",
          "TXN-000009",
          "TXN-000010",
          "TXN-000011",
          "TXN-000012",
          "TXN-000013",
          "TXN-000014",
          "TXN-000015",
          "TXN-000016",
          "TXN-000017",
          "TXN-000018",
          "TXN-000019",
          "TXN-000020"
        ],
        "user_id": [
          "86",
          "9",
          "83",
          "49",
          "52",
          "80",
          "14",
          "60",
          "95",
          "46",
          "73",
          "85",
          "3",
          "2",
          "99",
          "42",
          "21",
          "98",
          "11",
          "31"
        ],
        "txn_type": [
          "REFUND",
          "DEPOSIT",
          "WITHDRAWAL",
          "TRANSFER",
          "TRADE",
          "FEE"
        ],
        "instrument": [
          "XRP/USD",
          "AMZN",
          "AAPL",
          "DAX",
          "",
          "FTSE100",
          "GOOGL",
          "AUD/USD",
          "Natural Gas",
          "Nikkei",
          "Oil",
          "NVDA",
          "EUR/USD",
          "BTC/USD",
          "ETH/USD",
          "NASDAQ",
          "GBP/USD",
          "USD/JPY",
          "MSFT",
          "TSLA"
        ],
        "amount": [
          18965.78,
          1394.77,
          9845.6,
          8934.1,
          90538.18,
          747.69,
          1589.39,
          121.81,
          493.51,
          28431.87,
          428.75,
          7999.93,
          1057.59,
          1769.05,
          6666.34,
          285.03,
          95.6,
          38.25,
          1900.18,
          364.01
        ],
        "currency": [
          "AUD",
          "CAD",
          "USD",
          "CHF",
          "SGD",
          "GBP",
          "AED",
          "EUR",
          "JPY",
          "SAR"
        ],
        "amount_usd": [
          12327.76,
          906.6,
          7285.74,
          8934.1,
          66998.25,
          747.69,
          1796.01,
          121.81,
          493.51,
          21039.58,
          544.51,
          5919.95,
          285.55,
          1910.57,
          4933.09,
          185.27,
          103.25,
          0.26,
          513.05,
          2.44
        ],
        "status": [
          "COMPLETED",
          "FAILED",
          "CANCELLED",
          "FLAGGED",
          "PENDING"
        ],
        "flag_reason": [
          "",
          "AML alert",
          "Geo mismatch",
          "Unusual pattern",
          "Velocity check",
          "PEP transaction",
          "Sanctions match",
          "High amount"
        ],
        "payment_method": [
          "Wire Transfer",
          "Bank Transfer",
          "E-Wallet",
          "Debit Card",
          "SEPA",
          "ACH",
          "Crypto Wallet",
          "Credit Card"
        ],
        "external_ref": [
          "EXT-XQ01LWYF63TD",
          "EXT-TR0NB0HQNCKD",
          "EXT-7UJ89XK6ZODR",
          "EXT-VV9FPQLJ1PIO",
          "EXT-4E4748EQW66A",
          "EXT-6PIRD4M57DKG",
          "EXT-A3FVTXS5V0G1",
          "EXT-BGGIPFCS80WD",
          "EXT-NSP4FIPGDKC7",
          "EXT-UC1YZHW0MW03",
          "EXT-FTYDQUKNL248",
          "EXT-IPURBQZN3O3L",
          "EXT-XM7EHSW8P0IK",
          "EXT-ZRXEWGWNR4MA",
          "EXT-928Y5YXPFHRV",
          "EXT-8OMXHALIH9YE",
          "EXT-KYNPEQDU7MK6",
          "EXT-7J6K2XKUC1UX",
          "EXT-TQBJWXEBJE0J",
          "EXT-F3K6IGVP6Z9M"
        ],
        "ip_address": [
          "128.74.249.135",
          "159.219.125.82",
          "96.142.98.142",
          "151.85.182.73",
          "135.190.198.126",
          "36.62.236.209",
          "210.227.77.106",
          "28.41.179.113",
          "214.120.164.85",
          "106.139.243.25",
          "127.190.240.60",
          "89.137.115.163",
          "189.150.91.198",
          "11.169.141.147",
          "12.226.46.65",
          "194.167.123.8",
          "134.218.60.184",
          "207.57.39.169",
          "37.247.73.106",
          "169.164.254.96"
        ],
        "created_at": [
          "3/31/24 6:07",
          "5/29/25 18:11",
          "10/12/24 8:49",
          "12/10/25 2:55",
          "6/7/24 5:27",
          "10/20/24 13:17",
          "9/7/24 15:10",
          "10/16/25 8:30",
          "5/25/24 8:26",
          "12/12/25 16:51",
          "2/27/24 21:54",
          "5/7/24 13:09",
          "2/19/25 23:20",
          "5/11/24 1:49",
          "9/11/24 9:46",
          "5/1/25 2:34",
          "6/21/24 11:59",
          "1/25/25 23:47",
          "11/17/24 7:01",
          "5/21/24 3:19"
        ],
        "processed_at": [
          "3/31/24 18:08",
          "5/30/25 3:00",
          "10/12/24 8:12",
          "12/10/25 20:20",
          "6/7/24 10:47",
          "10/20/24 19:38",
          "9/7/24 11:18",
          "10/16/25 19:05",
          "5/25/24 19:05",
          "12/12/25 20:37",
          "2/28/24 7:40",
          "5/7/24 15:42",
          "2/20/25 14:00",
          "5/11/24 6:56",
          "9/12/24 2:42",
          "5/1/25 3:01",
          "6/21/24 13:13",
          "",
          "11/17/24 18:53",
          "5/21/24 16:15"
        ]
      }
    },
    "login_events": {
      "columns": [
        "event_id",
        "user_id",
        "email_attempted",
        "ip_address",
        "country",
        "city",
        "device_type",
        "device_fingerprint",
        "user_agent",
        "status",
        "failure_reason",
        "created_at"
      ],
      "unique_values": {
        "event_id": [
          "EVT-000001",
          "EVT-000002",
          "EVT-000003",
          "EVT-000004",
          "EVT-000005",
          "EVT-000006",
          "EVT-000007",
          "EVT-000008",
          "EVT-000009",
          "EVT-000010",
          "EVT-000011",
          "EVT-000012",
          "EVT-000013",
          "EVT-000014",
          "EVT-000015",
          "EVT-000016",
          "EVT-000017",
          "EVT-000018",
          "EVT-000019",
          "EVT-000020"
        ],
        "user_id": [
          "87",
          "46",
          "22",
          "13",
          "85",
          "33",
          "11",
          "89",
          "65",
          "81",
          "90",
          "25",
          "44",
          "41",
          "6",
          "29",
          "77",
          "17",
          "52",
          "79"
        ],
        "email_attempted": [
          "james.white@company.com",
          "amelia_jackson@yahoo.com",
          "alexanderharris97@hotmail.com",
          "bmartinez@hotmail.com",
          "emma_martin@yahoo.com",
          "jmiller@yahoo.com",
          "hlee@gmail.com",
          "mhernandez@email.net",
          "alexanderbrown65@email.net",
          "amelialopez67@outlook.com",
          "amelia_anderson@email.net",
          "charlotte_brown@outlook.com",
          "matthewhernandez56@email.net",
          "johnmiller23@work.org",
          "isabella.davis@yahoo.com",
          "sbrown@outlook.com",
          "mia.harris@email.net",
          "emma.brown@outlook.com",
          "olivialee67@yahoo.com",
          "janderson@company.com"
        ],
        "ip_address": [
          "156.219.212.124",
          "51.113.67.105",
          "62.176.56.58",
          "93.249.15.185",
          "206.84.36.43",
          "211.75.72.30",
          "39.90.6.86",
          "183.4.97.155",
          "180.156.30.74",
          "114.242.150.133",
          "14.102.177.180",
          "204.226.202.109",
          "48.118.68.151",
          "165.21.177.139",
          "111.129.167.79",
          "17.92.186.243",
          "91.189.186.76",
          "222.255.73.141",
          "204.138.176.3",
          "10.50.251.139"
        ],
        "country": [
          "Saudi Arabia",
          "Singapore",
          "France",
          "India",
          "Brazil",
          "United Kingdom",
          "Canada",
          "Japan",
          "Germany",
          "UAE",
          "Kuwait",
          "Qatar",
          "United States",
          "Australia",
          "Bahrain"
        ],
        "city": [
          "Dammam",
          "Singapore",
          "Nice",
          "Chennai",
          "Brasilia",
          "Manchester",
          "Sao Paulo",
          "Calgary",
          "Toronto",
          "London",
          "Osaka",
          "Berlin",
          "Ajman",
          "Abu Dhabi",
          "Hawalli",
          "Al Wakrah",
          "San Francisco",
          "Vancouver",
          "Sydney",
          "Tokyo"
        ],
        "device_type": [
          "Desktop",
          "Mobile",
          "Tablet"
        ],
        "device_fingerprint": [
          "e7db58b7947c93374fa2b69c422b7610",
          "e942387685fbfd09804b87abc51c4a65",
          "6c1515c28d3dc71a356db96e46efca6f",
          "2d63097d171c63ed7465bb752371cc5a",
          "3dd0094eb4955d11194550b66993c159",
          "80a5858431ec2c8eeea50262971b6105",
          "c5faa4241dd3147c5f72bac9a963c13e",
          "3b4c6aed9eb847d94204b5db0d47ca5c",
          "88b4793b5808161f4e8452e2a82a8cbe",
          "02989aaf7a6f2427b83aa3bb2c656c0e",
          "0bc8dbed318bfe14ccfeeec3fb1240f6",
          "1756f22aefbfe36e6fd16c68a234aeb0",
          "03c9e8a141744955c803c04034d3a762",
          "e171f42b63d521caf5082cde30b84020",
          "f6cdeb433ac761740b2106790ff30f54",
          "5206012f35be550262f2e7dfb81ae871",
          "c6cf91841922e5948b7b2094e403c30d",
          "1f3554f9039932112398e6afae9c21a2",
          "01f49087ea0c5f7ce535f8d2a25c2a7f",
          "c11101e948e0d9dbfd0c4295d6e94ae9"
        ],
        "user_agent": [
          "Mozilla/5.0 (macOS 13; rv:121.0) Gecko/20100101 Firefox/121.0",
          "Mozilla/5.0 (Linux) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
          "Mozilla/5.0 (iOS 17) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
          "Mozilla/5.0 (iOS 17) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0",
          "Mozilla/5.0 (Windows 11) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0",
          "Mozilla/5.0 (macOS 13) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0",
          "Mozilla/5.0 (Windows 11) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0",
          "Mozilla/5.0 (Android 14) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0",
          "Mozilla/5.0 (macOS 13) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0",
          "Mozilla/5.0 (iOS 17) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15",
          "Mozilla/5.0 (iOS 17; rv:121.0) Gecko/20100101 Firefox/121.0",
          "Mozilla/5.0 (Windows 10) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
          "Mozilla/5.0 (Windows 11) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15",
          "Mozilla/5.0 (Windows 10; rv:121.0) Gecko/20100101 Firefox/121.0",
          "Mozilla/5.0 (macOS 14) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0",
          "Mozilla/5.0 (iOS 17) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0",
          "Mozilla/5.0 (Android 14) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15",
          "Mozilla/5.0 (Android 14; rv:121.0) Gecko/20100101 Firefox/121.0",
          "Mozilla/5.0 (Android 14) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
          "Mozilla/5.0 (Linux) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0"
        ],
        "status": [
          "FAILED",
          "SUCCESS",
          "BLOCKED"
        ],
        "failure_reason": [
          "Invalid email",
          "",
          "Invalid password",
          "Session expired",
          "Account locked",
          "IP blocked",
          "MFA failed",
          "Too many attempts",
          "Suspicious activity"
        ],
        "created_at": [
          "2024-04-18 21:53:35",
          "2025-10-14 21:13:05",
          "2024-11-15 05:33:54",
          "2025-04-19 18:47:40",
          "2025-10-22 18:39:16",
          "2025-08-19 08:22:58",
          "2025-01-20 19:14:18",
          "2025-03-22 09:00:50",
          "2024-03-29 22:09:01",
          "2025-08-23 02:32:10",
          "2025-11-19 12:50:28",
          "2025-07-07 15:33:48",
          "2024-03-05 18:10:16",
          "2025-02-25 07:01:08",
          "2025-11-13 19:37:52",
          "2025-05-11 19:19:07",
          "2025-05-30 00:18:42",
          "2025-11-25 16:39:05",
          "2024-11-22 10:35:23",
          "2025-03-18 02:55:58"
        ]
      }
    }
  }
}
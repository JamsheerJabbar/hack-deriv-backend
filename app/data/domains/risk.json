{
  "domain": "risk",
  "description": "Configuration for risk domain",
  "schema_context": "The database contains information about users, their transactions, login events, risk-related alerts and rules, audit logs, and dashboards. The 'users' table stores user profile information including KYC status, risk level, and account details. The 'transactions' table logs financial activities with details on transaction type, amount, currency, and status. 'login_events' tracks user authentication attempts, including IP addresses and device information. 'alert_rules' defines conditions for triggering alerts, and 'alerts' records instances where these rules were violated. 'audit_logs' provides a record of system actions performed by users. The 'dashboards' table stores metadata about user-created analytical dashboards.",
  "prompts": {
    "intent": "You are an AI assistant...\n\nDOMAIN SPECIFIC INSTRUCTION:\nPay close attention to the following terms and their meanings in the context of risk management: KYC Status (EXPIRED, PENDING, REJECTED, VERIFIED), Risk Level (HIGH, LOW, MEDIUM), Is PEP (Politically Exposed Person), Account Status (ACTIVE, FROZEN, SUSPENDED), Flag Reason (e.g., Automated screening, Risk threshold exceeded), Alert Severity (CRITICAL, HIGH, LOW, MEDIUM), and Transaction Types (BONUS, DEPOSIT, FEE, TRADE, WITHDRAWAL).\n\nDOMAIN SPECIFIC INSTRUCTION:\nClarify the meaning of KYC status (EXPIRED, PENDING, REJECTED, VERIFIED), account status (ACTIVE, FROZEN, SUSPENDED), risk level (HIGH, MEDIUM, LOW), transaction status (COMPLETED, FAILED, FLAGGED, PENDING) and PEP (Politically Exposed Person).\n\nDOMAIN SPECIFIC INSTRUCTION:\nThe user is asking questions related to risk management, user behavior, and transaction monitoring. Pay close attention to terms like 'risk_level', 'kyc_status', 'is_pep', 'flagged transactions', 'login failures', 'suspicious activity', and 'alert rules'.",
    "sql": null
  },
  "few_shots": [
    {
      "question": "What are the user ids and kyc statuses of all users?",
      "sql": "SELECT user_id, kyc_status FROM users",
      "explanation": "This query retrieves the user ID and KYC status from the `users` table, showing the KYC verification status for each user."
    },
    {
      "question": "Show me all transactions that have been flagged with 'Risk threshold exceeded' as the reason.",
      "sql": "SELECT * FROM transactions WHERE flag_reason = 'Risk threshold exceeded'",
      "explanation": "This query filters the `transactions` table to find transactions where the `flag_reason` is 'Risk threshold exceeded', indicating potentially risky transactions."
    },
    {
      "question": "What is the average risk score for users with account status 'ACTIVE'?",
      "sql": "SELECT AVG(risk_score) FROM users WHERE account_status = 'ACTIVE'",
      "explanation": "This query calculates the average `risk_score` from the `users` table for users whose `account_status` is 'ACTIVE', providing an overall risk assessment for active users."
    },
    {
      "question": "List the rule names and severity of all alert rules.",
      "sql": "SELECT rule_name, severity FROM alert_rules",
      "explanation": "This query shows all alert rules' names and their defined severity levels.  It helps to understand which rules are in place and the importance assigned to them."
    },
    {
      "question": "Find the user IDs and full names of users who are marked as PEP (Politically Exposed Person).",
      "sql": "SELECT user_id, full_name FROM users WHERE is_pep = 1",
      "explanation": "This query retrieves the user ID and full name from the `users` table where the `is_pep` flag is set to 1, indicating users who are politically exposed persons."
    },
    {
      "question": "Show me all users with a KYC status of 'PENDING'.",
      "sql": "SELECT user_id, email FROM users WHERE kyc_status = 'PENDING'",
      "explanation": "This query selects the user_id and email from the users table, filtering for users where the kyc_status is 'PENDING'."
    },
    {
      "question": "List all transactions with a 'FLAGGED' status and 'Large amount' as the flag reason.",
      "sql": "SELECT txn_id, user_id, amount, currency FROM transactions WHERE status = 'FLAGGED' AND flag_reason = 'Large amount'",
      "explanation": "This query retrieves transaction details (txn_id, user_id, amount, currency) from the transactions table, filtering for transactions that are 'FLAGGED' due to a 'Large amount'."
    },
    {
      "question": "What are the names of the alert rules with 'HIGH' severity?",
      "sql": "SELECT rule_name FROM alert_rules WHERE severity = 'HIGH'",
      "explanation": "This SQL query selects the names of alert rules that have a severity level of 'HIGH'."
    },
    {
      "question": "Find all login events from the country 'DE' that resulted in a 'FAILED' status.",
      "sql": "SELECT event_id, user_id, email_attempted FROM login_events WHERE country = 'DE' AND status = 'FAILED'",
      "explanation": "This SQL query retrieves the event ID, user ID, and attempted email addresses of login events originating from Germany ('DE') that failed."
    },
    {
      "question": "Show the emails of users whose accounts are 'FROZEN' and have a risk level of 'HIGH'.",
      "sql": "SELECT email FROM users WHERE account_status = 'FROZEN' AND risk_level = 'HIGH'",
      "explanation": "This SQL query selects the email addresses of users who have 'FROZEN' accounts and are classified as having a 'HIGH' risk level."
    },
    {
      "question": "How many users have a 'HIGH' risk level and are from 'CA'?",
      "sql": "SELECT COUNT(user_id) FROM users WHERE risk_level = 'HIGH' AND country = 'CA';",
      "explanation": "This query counts users who meet specific criteria for risk level and country, directly extracting information from the 'users' table."
    },
    {
      "question": "Show me all transactions that were flagged and the reason for the flag.",
      "sql": "SELECT txn_id, flag_reason FROM transactions WHERE status = 'FLAGGED';",
      "explanation": "This query retrieves transaction IDs and their associated flag reasons for transactions that are marked as 'FLAGGED' in the 'transactions' table."
    },
    {
      "question": "List the email addresses of users who have had a 'SUSPICIOUS_ACTIVITY' failure reason during login.",
      "sql": "SELECT DISTINCT u.email FROM users u JOIN login_events le ON u.user_id = le.user_id WHERE le.failure_reason = 'SUSPICIOUS_ACTIVITY';",
      "explanation": "This query joins the 'users' and 'login_events' tables to find users whose login attempts failed due to 'SUSPICIOUS_ACTIVITY' and returns their email addresses."
    },
    {
      "question": "What is the total 'amount_usd' for all 'COMPLETED' 'WITHDRAWAL' transactions?",
      "sql": "SELECT SUM(amount_usd) FROM transactions WHERE status = 'COMPLETED' AND txn_type = 'WITHDRAWAL';",
      "explanation": "This query calculates the sum of 'amount_usd' for transactions that have a 'COMPLETED' status and are of the 'WITHDRAWAL' type, aggregating data from the 'transactions' table."
    },
    {
      "question": "Find users whose KYC status is 'EXPIRED' and their KYC expiry date.",
      "sql": "SELECT full_name, kyc_expiry_date FROM users WHERE kyc_status = 'EXPIRED';",
      "explanation": "This query selects the full name and KYC expiry date for users whose KYC status is 'EXPIRED', retrieving data from the 'users' table."
    }
  ]
}
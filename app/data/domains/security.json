{
  "domain": "security",
  "description": "Configuration for security domain",
  "schema_context": "The database contains information about users, their transactions, login events, security alerts, and audit logs. \n\n**Users Table:** Stores user profiles including personal information (full name, date of birth, country, phone), KYC status and verification details, risk assessment (risk level, risk score, is_pep), account status, and timestamps for creation and updates.\n**Transactions Table:** Records financial transactions with details like transaction ID, user ID, transaction type (DEPOSIT, WITHDRAWAL, TRADE, etc.), instrument traded, amount, currency, USD equivalent, status (COMPLETED, FAILED, FLAGGED, PENDING), reasons for flagging, payment method, external references, IP address, and timestamps.\n**Login Events Table:** Logs user login attempts, capturing event ID, user ID, attempted email, IP address, geographical location (country, city), device information (device type, fingerprint, user agent), login status (SUCCESS, FAILED, BLOCKED), and reasons for failure. \n**Alert Rules Table:** Defines rules for generating security alerts, including rule ID, name, type (e.g., THRESHOLD, VELOCITY), conditions, severity, and activation status.\n**Alerts Table:** Logs triggered security alerts, linking to specific rules and transactions, user IDs, severity, status, detailed information, assigned personnel, resolution details, and timestamps.\n**Audit Logs Table:** Tracks system actions performed by users or administrators, including log ID, actor ID, action performed, resource type and ID affected, query text (if applicable), IP address, and timestamp.\n**Dashboards Table:** Stores metadata about created dashboards, including ID, name, owner, widget configurations, layout, deployment status, URL, and refresh intervals.",
  "prompts": {
    "intent": "You are an AI assistant...\n\nDOMAIN SPECIFIC INSTRUCTION:\nWhen interpreting user questions, pay close attention to security-related keywords such as 'KYC', 'FLAGGED', 'MFA_FAILED', 'risk_level', 'risk_score', 'is_pep', 'account_status', 'fraud', 'alerts', 'login events', 'suspicious activity', and be aware of the specific alert rule names like 'Dormant Account Activity', 'Failed Auth Spike', 'High Risk Country', 'Large Transaction', 'New Geo Login'. When a query references 'alerts', understand they can have statuses like 'DISMISSED', 'INVESTIGATING', 'OPEN', and 'RESOLVED'.\n\nDOMAIN SPECIFIC INSTRUCTION:\nAdd this instruction to the system prompt: Pay close attention to KYC statuses like 'EXPIRED', 'PENDING', 'REJECTED', 'VERIFIED', account statuses such as 'ACTIVE', 'FROZEN', 'SUSPENDED', transaction statuses like 'COMPLETED', 'FAILED', 'FLAGGED', 'PENDING', and login event statuses like 'BLOCKED', 'FAILED', 'SUCCESS'. Also consider flag reasons like 'Automated screening', 'Risk threshold exceeded', 'Large amount', 'Unusual pattern', and failure reasons such as 'MFA_FAILED', 'IP_BLOCKED', 'WRONG_PASSWORD', 'ACCOUNT_LOCKED', 'SUSPICIOUS_ACTIVITY'. When the user asks a query regarding rule conditions, always examine the JSON format.\n\nDOMAIN SPECIFIC INSTRUCTION:\nYou are a highly skilled SQL generation AI. Your task is to translate natural language questions about security-related data into precise SQL queries. Pay close attention to specific jargon within the data, such as 'KYC status', 'risk_level', 'txn_type', 'flag_reason', 'failure_reason', 'is_pep', and 'account_status'. When encountering these terms, infer the user's intent and map them directly to the corresponding database columns. For example, if a user asks about 'identity verification', consider the 'kyc_status' column. If they mention 'suspicious activity' or 'risk', look at 'risk_level', 'risk_score', or 'flag_reason'.",
    "sql": null
  },
  "few_shots": [
    {
      "question": "Show me all users with KYC status 'PENDING'.",
      "sql": "SELECT user_id, email FROM users WHERE kyc_status = 'PENDING';",
      "explanation": "This query selects the user ID and email from the 'users' table where the 'kyc_status' column is equal to 'PENDING'."
    },
    {
      "question": "What are the transaction IDs of all 'FLAGGED' transactions using 'CARD' payment method?",
      "sql": "SELECT txn_id FROM transactions WHERE status = 'FLAGGED' AND payment_method = 'CARD';",
      "explanation": "This query selects the transaction IDs from the 'transactions' table where the 'status' is 'FLAGGED' and the 'payment_method' is 'CARD'."
    },
    {
      "question": "List all login events with 'WRONG_PASSWORD' as the failure reason.",
      "sql": "SELECT event_id, user_id, email_attempted FROM login_events WHERE failure_reason = 'WRONG_PASSWORD';",
      "explanation": "This query retrieves the event ID, user ID, and attempted email address from the 'login_events' table for entries where the 'failure_reason' is 'WRONG_PASSWORD'."
    },
    {
      "question": "How many alerts have a severity of 'CRITICAL'?",
      "sql": "SELECT count(*) FROM alerts WHERE severity = 'CRITICAL';",
      "explanation": "This query counts the number of rows in the 'alerts' table where the 'severity' is 'CRITICAL'."
    },
    {
      "question": "Show me the audit logs for 'LOGIN' actions on the 'USER' resource type.",
      "sql": "SELECT log_id, actor_id, ip_address, created_at FROM audit_logs WHERE action = 'LOGIN' AND resource_type = 'USER';",
      "explanation": "This query retrieves the log ID, actor ID, IP address, and creation timestamp from the 'audit_logs' table where the 'action' is 'LOGIN' and the 'resource_type' is 'USER'."
    },
    {
      "question": "What are the names and risk levels of users with KYC status 'VERIFIED'?",
      "sql": "SELECT full_name, risk_level FROM users WHERE kyc_status = 'VERIFIED';",
      "explanation": "This query selects the full name and risk level from the users table, filtering for users whose KYC status is 'VERIFIED'."
    },
    {
      "question": "Show me the transaction IDs, amounts, and flag reasons for transactions that are flagged.",
      "sql": "SELECT txn_id, amount, flag_reason FROM transactions WHERE status = 'FLAGGED';",
      "explanation": "This retrieves the transaction ID, amount, and flag reason from the transactions table, specifically for transactions with a 'FLAGGED' status."
    },
    {
      "question": "List the distinct failure reasons for login events.",
      "sql": "SELECT DISTINCT failure_reason FROM login_events;",
      "explanation": "This query retrieves all the unique failure reasons for logins present in the login_events table."
    },
    {
      "question": "Find all dashboards created in '2025-09'. Display their name and deploy_url.",
      "sql": "SELECT name, deploy_url FROM dashboards WHERE created_at LIKE '2025-09%';",
      "explanation": "This query retrieves the names and deploy urls from the dashboards table for dashboards that were created in september of 2025."
    },
    {
      "question": "Show the average amount_usd for COMPLETED transactions.",
      "sql": "SELECT AVG(amount_usd) FROM transactions WHERE status = 'COMPLETED';",
      "explanation": "This query computes the average amount in USD for transactions where the status is COMPLETED."
    },
    {
      "question": "Show me all users from the AE, AU, and CA countries.",
      "sql": "SELECT * FROM users WHERE country IN ('AE', 'AU', 'CA')",
      "explanation": "This query retrieves all columns for users whose country is listed in the provided set of country codes, demonstrating filtering by country."
    },
    {
      "question": "What are the transaction types and their total amounts in USD for 'USR-0001'?",
      "sql": "SELECT txn_type, SUM(amount_usd) FROM transactions WHERE user_id = 'USR-0001' GROUP BY txn_type",
      "explanation": "This query aggregates the total transaction amounts in USD for a specific user, grouped by transaction type, showing aggregation and filtering by user_id."
    },
    {
      "question": "List all login events that failed due to 'WRONG_PASSWORD' from the last 7 days.",
      "sql": "SELECT * FROM login_events WHERE failure_reason = 'WRONG_PASSWORD' AND created_at >= DATE('now', '-7 days')",
      "explanation": "This query filters login events by a specific failure reason and a time range (last 7 days), demonstrating date-based filtering and specific status filtering."
    },
    {
      "question": "How many users have a 'HIGH' risk level and have not been verified (KYC status is not 'VERIFIED')?",
      "sql": "SELECT COUNT(user_id) FROM users WHERE risk_level = 'HIGH' AND kyc_status != 'VERIFIED'",
      "explanation": "This query counts users based on two criteria: risk level and KYC status, demonstrating conditional counting and multiple filters."
    },
    {
      "question": "Find all transactions that were flagged for 'Risk threshold exceeded' and their corresponding user's full name.",
      "sql": "SELECT T.txn_id, U.full_name FROM transactions AS T JOIN users AS U ON T.user_id = U.user_id WHERE T.flag_reason = 'Risk threshold exceeded'",
      "explanation": "This query joins the transactions and users tables to retrieve transaction details along with the full name of the associated user, illustrating a JOIN operation based on a specific flagging reason."
    }
  ]
}
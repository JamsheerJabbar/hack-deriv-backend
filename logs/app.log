<<<<<<< HEAD
2026-01-25 14:31:48,587 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:31:48,827 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:31:50,873 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:17,274 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:17,315 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:17,333 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:28,802 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:28,887 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:28,903 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:40,242 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:40,278 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:40,290 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:03,987 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:04,024 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:04,070 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:04,110 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:04,157 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:04,185 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:15,121 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:15,156 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:15,196 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:15,199 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:15,229 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:15,233 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:30,801 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:30,833 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:30,872 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:30,892 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:30,922 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:30,953 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:45,018 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:45,035 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:45,042 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:45,068 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:45,149 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:45,168 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:54,259 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:54,289 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:54,293 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:54,300 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:54,327 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:54,335 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:11,210 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:11,238 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:11,244 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:11,261 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:11,285 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:11,293 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:36,195 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:36,237 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:36,285 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:36,317 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:36,320 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:36,355 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:46,272 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:46,280 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:46,308 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:46,313 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:46,320 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:46,344 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:35:10,246 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:35:10,316 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:36:30,778 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: risk
2026-01-25 14:36:30,784 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:36:30,791 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: What are the compliance violations in the last 30 days?
2026-01-25 14:36:30,798 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:36:32,822 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:36:32,825 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:36:32,829 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:36:32,912 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:36:32,912 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: What are the compliance violations in the last 30 days?
2026-01-25 14:36:32,922 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:36:33,928 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain inform...
2026-01-25 14:36:33,932 - nl2sql - WARNING - sql_generation.py:69 - SQL Generation guidance response for query: What are the compliance violations in the last 30 days? | Msg: Error: The database schema does not contain inform...
2026-01-25 14:36:33,935 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not contain inform...
2026-01-25 14:36:33,941 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:36:33,943 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain information about compliance violations. Try asking about: users, transacti
2026-01-25 14:36:33,951 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:36:35,089 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT * FROM audit_logs WHERE timestamp...
2026-01-25 14:36:35,092 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:36:35,096 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));
2026-01-25 14:36:35,106 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:36:36,046 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM audit_logs WHERE timestamp >= strfti...
2026-01-25 14:36:36,052 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:36:36,069 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:36:36,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));
2026-01-25 14:36:36,078 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: timestamp
[SQL: SELECT * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));
2026-01-25 14:36:36,078 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:36:36,082 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the compliance violations in the last 30 days?
2026-01-25 14:36:36,091 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:37:06,792 - nl2sql - INFO - endpoints.py:14 - Incoming query: show the compliace violations | Domain: risk
2026-01-25 14:37:06,797 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:37:06,801 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: show the compliace violations
2026-01-25 14:37:06,803 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:37:07,744 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:37:07,744 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 14:37:07,751 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 14:37:07,801 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 14:37:08,739 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Could you please specify the time range you'd like...
2026-01-25 14:37:08,742 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: show the compliace violations
2026-01-25 14:37:18,698 - nl2sql - INFO - endpoints.py:14 - Incoming query: last year | Domain: risk
2026-01-25 14:37:18,699 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:37:18,705 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: last year
2026-01-25 14:37:18,705 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:37:19,792 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:37:19,792 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:19,795 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:19,850 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:37:19,853 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: last year
2026-01-25 14:37:19,857 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:37:20,989 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Your request is not clear. Please specify w...
2026-01-25 14:37:20,992 - nl2sql - WARNING - sql_generation.py:69 - SQL Generation guidance response for query: last year | Msg: Error: Your request is not clear. Please specify w...
2026-01-25 14:37:20,995 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Your request is not clear. Please specify w...
2026-01-25 14:37:20,999 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:21,004 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: Your [4mrequest[0m is not clear. Please specify which data from the last year you want to query. Try asking about: use
2026-01-25 14:37:21,014 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:37:22,457 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT * FROM users WHERE strftime('%Y',...
2026-01-25 14:37:22,463 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:22,469 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));
2026-01-25 14:37:22,473 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:37:23,339 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE strftime('%Y', registrat...
2026-01-25 14:37:23,342 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:23,355 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:37:23,359 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));
2026-01-25 14:37:23,363 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: registration_date
[SQL: SELECT * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));
2026-01-25 14:37:23,367 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:37:23,373 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: last year
2026-01-25 14:37:23,378 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:37:36,265 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents and the count | Domain: risk
2026-01-25 14:37:36,269 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:37:36,274 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: Show me all high severity incidents and the count
2026-01-25 14:37:36,282 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:37:37,203 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:37:37,206 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:37,207 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:37,277 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:37:37,281 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: Show me all high severity incidents and the count
2026-01-25 14:37:37,283 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:37:38,093 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT severity, COUNT(*) FROM alerts WHERE severi...
2026-01-25 14:37:38,095 - nl2sql - INFO - sql_generation.py:80 - SQL Generated and cleaned: SELECT severity, COUNT(*) FROM alerts WHERE severi...
2026-01-25 14:37:38,095 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT severity, COUNT(*) FROM alerts WHERE severi...
2026-01-25 14:37:38,104 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:38,121 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:37:38,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT severity, COUNT(*) FROM alerts WHERE severity = 'HIGH' GROUP BY severity;
2026-01-25 14:37:38,133 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 14:37:38,135 - nl2sql - INFO - workflow.py:92 - Query execution returned 1 rows.
2026-01-25 14:37:38,140 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:37:39,460 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Count...
2026-01-25 14:37:39,468 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents and the count
2026-01-25 14:37:39,471 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-25 14:38:48,036 - nl2sql - INFO - endpoints.py:14 - Incoming query: List all open security risks | Domain: risk
2026-01-25 14:38:48,043 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:38:48,046 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: List all open security risks
2026-01-25 14:38:48,046 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:38:49,236 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:38:49,241 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:38:49,245 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:38:49,308 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:38:49,313 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: List all open security risks
2026-01-25 14:38:49,314 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:38:50,356 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sql
SELECT alert_id, rule_name, severity, user_...
2026-01-25 14:38:50,360 - nl2sql - INFO - sql_generation.py:80 - SQL Generated and cleaned: SELECT alert_id, rule_name, severity, user_id, tra...
2026-01-25 14:38:50,363 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT alert_id, rule_name, severity, user_id, tra...
2026-01-25 14:38:50,370 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:38:50,379 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:38:50,383 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT alert_id, rule_name, severity, user_id, transaction_id FROM alerts WHERE status = 'OPEN';
2026-01-25 14:38:50,385 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT alert_id, rule_name, severity, user_id, transaction_id FROM alerts WHERE status = 'OPEN';]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT alert_id, rule_name, severity, user_id, transaction_id FROM alerts WHERE status = 'OPEN';
2026-01-25 14:38:50,392 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:38:50,402 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: List all open security risks
2026-01-25 14:38:50,402 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:44:27,327 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:27,362 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:27,469 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:27,507 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:28,625 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:28,640 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:46,166 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:46,199 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:46,212 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:46,216 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:46,255 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:46,262 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:45:11,892 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:45:11,909 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:45:28,091 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: security
2026-01-25 14:45:28,098 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:45:28,098 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Show me all high severity incidents
2026-01-25 14:45:28,112 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:45:29,613 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:45:29,618 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:45:29,618 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:45:29,630 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:45:31,005 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "severity":...
2026-01-25 14:45:31,006 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 14:45:31,012 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:45:31,012 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: Show me all high severity incidents
2026-01-25 14:45:31,014 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 14:45:31,972 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT alert_id, rule_name, user_id, txn_id, detai...
2026-01-25 14:45:31,974 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT alert_id, rule_name, user_id, txn_id, detai...
2026-01-25 14:45:31,974 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT alert_id, rule_name, user_id, txn_id, detai...
2026-01-25 14:45:31,978 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:45:31,983 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:45:31,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT alert_id, rule_name, user_id, txn_id, details FROM alerts WHERE severity = 'HIGH';
2026-01-25 14:45:31,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 99 rows.
2026-01-25 14:45:31,992 - nl2sql - INFO - workflow.py:92 - Query execution returned 99 rows.
2026-01-25 14:45:31,992 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:45:33,573 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Hig...
2026-01-25 14:45:33,578 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 14:45:33,578 - nl2sql - INFO - endpoints.py:48 - Query success! 99 rows returned.
2026-01-25 14:46:01,984 - nl2sql - INFO - endpoints.py:14 - Incoming query: what is this domian speciality | Domain: risk
2026-01-25 14:46:01,992 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:46:01,996 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: what is this domian speciality
2026-01-25 14:46:01,996 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:46:03,037 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "UNKNOWN",
  "confidence": 0...
2026-01-25 14:46:03,042 - nl2sql - INFO - intent_classification.py:81 - Classification Result: UNKNOWN (conf: 0.3) | Needs Clarification: True
2026-01-25 14:46:03,042 - nl2sql - INFO - workflow.py:24 - Intent classified: UNKNOWN (conf: 0.3) | Needs Clarification: True
2026-01-25 14:46:03,050 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:46:04,380 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:46:04,384 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:46:04,393 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 14:46:05,308 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Could you please tell me which area of the RISK do...
2026-01-25 14:46:05,314 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what is this domian speciality
2026-01-25 14:46:22,141 - nl2sql - INFO - endpoints.py:14 - Incoming query: which table has data related to fruad detection | Domain: risk
2026-01-25 14:46:22,141 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:46:22,150 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: which table has data related to fruad detection
2026-01-25 14:46:22,159 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:46:23,205 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:46:23,205 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:23,209 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:23,215 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:46:24,203 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:46:24,203 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:46:24,213 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:46:24,213 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: which table has data related to fruad detection
2026-01-25 14:46:24,224 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:46:25,299 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not explicitly con...
2026-01-25 14:46:25,301 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: which table has data related to fruad detection | Msg: Error: The database schema does not explicitly con...
2026-01-25 14:46:25,304 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not explicitly con...
2026-01-25 14:46:25,310 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:25,314 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not explicitly contain a "fraud detection" table. However, the `alerts`, `transactions`
2026-01-25 14:46:25,322 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:46:26,355 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT DISTINCT tbl_name FROM sqlite_mas...
2026-01-25 14:46:26,360 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:26,363 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m DISTINCT tbl_name FROM sqlite_master WHERE type = 'table' AND tbl_name IN ('alerts', 'transactions'
2026-01-25 14:46:26,371 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:46:27,222 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT tbl_name FROM sqlite_master WHERE ...
2026-01-25 14:46:27,225 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:27,238 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:46:27,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT tbl_name FROM sqlite_master WHERE type = 'table' AND tbl_name IN ('alerts', 'transactions', 'users', 'login_events');
2026-01-25 14:46:27,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 14:46:27,259 - nl2sql - INFO - workflow.py:92 - Query execution returned 4 rows.
2026-01-25 14:46:27,264 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:46:28,432 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Tab...
2026-01-25 14:46:28,441 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: which table has data related to fruad detection
2026-01-25 14:46:28,443 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-25 14:46:46,517 - nl2sql - INFO - endpoints.py:14 - Incoming query: ok what the columns in transcations table | Domain: risk
2026-01-25 14:46:46,524 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:46:46,531 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: ok what the columns in transcations table
2026-01-25 14:46:46,534 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:46:47,797 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:46:47,797 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:47,806 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:47,811 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:46:48,659 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:46:48,662 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:46:48,668 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:46:48,668 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: ok what the columns in transcations table
2026-01-25 14:46:48,678 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:46:49,679 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:46:49,682 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:46:49,686 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:46:49,690 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:49,703 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:46:49,703 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5
2026-01-25 14:46:49,708 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5
2026-01-25 14:46:49,715 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:46:49,727 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: ok what the columns in transcations table
2026-01-25 14:46:49,731 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:47:34,240 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are the cloumns in transcation table | Domain: risk
2026-01-25 14:47:34,245 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:47:34,248 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: what are the cloumns in transcation table
2026-01-25 14:47:34,255 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:47:35,170 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:47:35,173 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:47:35,178 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:47:35,187 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:47:36,069 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:47:36,071 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:47:36,079 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:47:36,082 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: what are the cloumns in transcation table
2026-01-25 14:47:36,083 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:47:37,061 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: To understand the columns in the `transacti...
2026-01-25 14:47:37,065 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: what are the cloumns in transcation table | Msg: Error: To understand the columns in the `transacti...
2026-01-25 14:47:37,065 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: To understand the columns in the `transacti...
2026-01-25 14:47:37,073 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:47:37,078 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 20.
  Error: To [4munderstand[0m the columns in the `transactions` table, query a few rows from it, for example using `SELECT * FROM
2026-01-25 14:47:37,087 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:47:37,882 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions LIMIT 5;
...
2026-01-25 14:47:37,892 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:47:37,900 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:47:37,900 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions LIMIT 5;
2026-01-25 14:47:37,905 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 14:47:37,911 - nl2sql - INFO - workflow.py:92 - Query execution returned 5 rows.
2026-01-25 14:47:37,914 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:47:39,328 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Sam...
2026-01-25 14:47:39,336 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: what are the cloumns in transcation table
2026-01-25 14:47:39,342 - nl2sql - INFO - endpoints.py:48 - Query success! 5 rows returned.
2026-01-25 14:48:05,591 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me only the column names from transaction table | Domain: risk
2026-01-25 14:48:05,600 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:48:05,600 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: give me only the column names from transaction table
2026-01-25 14:48:05,606 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:48:06,650 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:48:06,656 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:48:06,657 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:48:06,662 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:48:07,591 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:48:07,595 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:48:07,602 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:48:07,602 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: give me only the column names from transaction table
2026-01-25 14:48:07,611 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:48:08,633 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:48:08,636 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:48:08,637 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:48:08,642 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:48:08,652 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:48:08,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5;
2026-01-25 14:48:08,662 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5;
2026-01-25 14:48:08,668 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:48:08,678 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me only the column names from transaction table
2026-01-25 14:48:08,685 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:48:59,713 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:48:59,752 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:48:59,760 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:48:59,794 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:00,741 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:00,762 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:12,558 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:12,572 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:12,597 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:12,600 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:12,616 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:12,640 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:28,389 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:28,405 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:51:28,161 - nl2sql - INFO - endpoints.py:14 - Incoming query: What columns are in the transactions table? | Domain: general
2026-01-25 14:51:28,169 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:51:28,169 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: What columns are in the transactions table?
2026-01-25 14:51:28,182 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:51:29,965 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 14:51:29,969 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-25 14:51:29,969 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-25 14:51:29,982 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:51:30,888 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:51:30,890 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:51:30,909 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 14:51:34,336 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Okay, here's a breakdown of the columns within the...
2026-01-25 14:51:34,341 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: What columns are in the transactions table?
2026-01-25 14:56:25,353 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: general
2026-01-25 14:56:25,360 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:56:25,363 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show me all high severity incidents
2026-01-25 14:56:25,369 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:56:27,665 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:56:27,668 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:56:27,672 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:56:27,678 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:56:28,771 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "severity":...
2026-01-25 14:56:28,771 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 14:56:28,783 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:56:28,788 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show me all high severity incidents
2026-01-25 14:56:28,796 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 14:56:29,755 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE severity = 'HIGH';
...
2026-01-25 14:56:29,757 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM alerts WHERE severity = 'HIGH';...
2026-01-25 14:56:29,760 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM alerts WHERE severity = 'HIGH';...
2026-01-25 14:56:29,762 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:56:29,782 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:56:29,784 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE severity = 'HIGH';
2026-01-25 14:56:29,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 99 rows.
2026-01-25 14:56:29,801 - nl2sql - INFO - workflow.py:92 - Query execution returned 99 rows.
2026-01-25 14:56:29,809 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:56:31,466 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Hig...
2026-01-25 14:56:31,466 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 14:56:31,478 - nl2sql - INFO - endpoints.py:48 - Query success! 99 rows returned.
2026-01-25 14:59:54,949 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show operational metrics for last quarter | Domain: general
2026-01-25 14:59:54,957 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:59:54,962 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show operational metrics for last quarter
2026-01-25 14:59:54,965 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:59:56,164 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:59:56,166 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:59:56,170 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:59:56,179 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:59:57,228 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:59:57,233 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:59:57,241 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:59:57,245 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show operational metrics for last quarter
2026-01-25 14:59:57,252 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 14:59:58,621 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain specif...
2026-01-25 14:59:58,624 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show operational metrics for last quarter | Msg: Error: The database schema does not contain specif...
2026-01-25 14:59:58,628 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not contain specif...
2026-01-25 14:59:58,633 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:59:58,633 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain specific tables or columns for operational metrics. Try asking about: users
2026-01-25 14:59:58,648 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:00:00,009 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT
  COUNT(T.transaction_id)
FROM tr...
2026-01-25 15:00:00,013 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:00:00,021 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m
  COUNT(T.transaction_id)
FROM transactions AS T
WHERE
  T.timestamp BETWEEN date('now', '-3 months
2026-01-25 15:00:00,030 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:00:00,983 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT
  COUNT(transaction_id)
FROM transactions
W...
2026-01-25 15:00:00,991 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:00:00,996 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:00:00,996 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT
  COUNT(transaction_id)
FROM transactions
WHERE
  timestamp BETWEEN date('now', '-3 months') AND date('now');
2026-01-25 15:00:01,012 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT
  COUNT(transaction_id)
FROM transactions
WHERE
  timestamp BETWEEN date('now', '-3 months') AND date('now');]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT
  COUNT(transaction_id)
FROM transactions
WHERE
  timestamp BETWEEN date('now', '-3 months') AND date('now');
2026-01-25 15:00:01,020 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:00:01,033 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show operational metrics for last quarter
2026-01-25 15:00:01,036 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:01:43,658 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are you capabitliies | Domain: security
2026-01-25 15:01:43,664 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:01:43,666 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: what are you capabitliies
2026-01-25 15:01:43,671 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:01:44,794 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 15:01:44,794 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.95) | Needs Clarification: False
2026-01-25 15:01:44,802 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 0.95) | Needs Clarification: False
2026-01-25 15:01:44,812 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:01:45,754 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:01:45,760 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:01:45,768 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 15:02:04,766 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Okay, here's a breakdown of the database schema an...
2026-01-25 15:02:04,766 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are you capabitliies
2026-01-25 15:03:56,788 - nl2sql - INFO - endpoints.py:14 - Incoming query: ok show me good visaulization of user queries | Domain: security
2026-01-25 15:03:56,792 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:03:56,792 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: ok show me good visaulization of user queries
2026-01-25 15:03:56,803 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:03:58,007 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "UNKNOWN",
  "confidence": 0...
2026-01-25 15:03:58,009 - nl2sql - INFO - intent_classification.py:82 - Classification Result: UNKNOWN (conf: 0.6) | Needs Clarification: True
2026-01-25 15:03:58,012 - nl2sql - INFO - workflow.py:24 - Intent classified: UNKNOWN (conf: 0.6) | Needs Clarification: True
2026-01-25 15:03:58,015 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:03:59,013 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:03:59,013 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:03:59,028 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:04:00,270 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: What kind of user queries are you interested in vi...
2026-01-25 15:04:00,274 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: ok show me good visaulization of user queries
2026-01-25 15:04:05,442 - nl2sql - INFO - endpoints.py:14 - Incoming query: signups | Domain: security
2026-01-25 15:04:05,446 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:04:05,446 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: signups
2026-01-25 15:04:05,452 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:04:06,433 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:04:06,433 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.8) | Needs Clarification: True
2026-01-25 15:04:06,441 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.8) | Needs Clarification: True
2026-01-25 15:04:06,442 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:04:07,596 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:04:07,601 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:04:07,635 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:04:08,842 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: What time range are you interested in for signups ...
2026-01-25 15:04:08,846 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: signups
2026-01-25 15:04:14,462 - nl2sql - INFO - endpoints.py:14 - Incoming query: daily | Domain: security
2026-01-25 15:04:14,469 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:04:14,469 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: daily
2026-01-25 15:04:14,478 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:04:15,403 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:04:15,409 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:04:15,412 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:04:15,415 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:04:16,513 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:04:16,517 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:04:16,526 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:04:16,531 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: daily
2026-01-25 15:04:16,536 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 15:04:17,516 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Please specify what information about "dail...
2026-01-25 15:04:17,525 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: daily | Msg: Error: Please specify what information about "dail...
2026-01-25 15:04:17,525 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Please specify what information about "dail...
2026-01-25 15:04:17,533 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:04:17,536 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 21.
  Error: Please [4mspecify[0m what information about "daily" you want to retrieve. Try asking about: users, transactions, alerts,
2026-01-25 15:04:17,542 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:04:18,388 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM daily;
...
2026-01-25 15:04:18,392 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:04:18,401 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:04:18,405 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM daily;
2026-01-25 15:04:18,409 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: daily
[SQL: SELECT * FROM daily;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM daily;
2026-01-25 15:04:18,411 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:04:18,421 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: daily
2026-01-25 15:04:18,427 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:05:55,067 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:05:55,069 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:05:55,087 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:05:55,096 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:05:57,630 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:05:57,655 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:06:29,047 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: security
2026-01-25 15:06:29,063 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:06:29,063 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:06:29,073 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:06:34,603 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 0.98,
  "c...
2026-01-25 15:06:34,603 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-25 15:06:34,603 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-25 15:06:34,613 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:07:43,838 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:07:43,840 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:07:43,852 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: security
2026-01-25 15:07:43,862 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:07:43,864 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Show me all high severity incidents
2026-01-25 15:07:43,869 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:07:46,647 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-25 15:07:46,651 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:07:46,651 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:07:46,659 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:07:50,609 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "severity": "HIGH"
...
2026-01-25 15:07:50,612 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 15:07:50,656 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:07:50,660 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:07:50,663 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 15:08:04,005 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-25 15:08:04,005 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-25 15:08:04,005 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-25 15:08:04,011 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:08:04,012 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:08:04,016 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: Show me all high severity incidents
2026-01-25 15:08:04,016 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 15:08:08,595 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT alert_id, rule_name, user_id, severity, sta...
2026-01-25 15:08:08,595 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT alert_id, rule_name, user_id, severity, sta...
2026-01-25 15:08:08,600 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT alert_id, rule_name, user_id, severity, sta...
2026-01-25 15:08:08,604 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:08:08,612 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:08:08,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE created_at >= datetime('now', '-30 days');
2026-01-25 15:08:08,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 161 rows.
2026-01-25 15:08:08,627 - nl2sql - INFO - workflow.py:92 - Query execution returned 161 rows.
2026-01-25 15:08:08,633 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 15:08:17,826 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "Compliance ...
2026-01-25 15:08:17,828 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:08:17,828 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT alert_id, rule_name, user_id, severity, status, created_at FROM alerts WHERE severity = 'HIGH';
2026-01-25 15:08:17,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 99 rows.
2026-01-25 15:08:17,835 - nl2sql - INFO - workflow.py:92 - Query execution returned 99 rows.
2026-01-25 15:08:17,837 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 15:08:28,807 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "High Severi...
2026-01-25 15:08:28,813 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the compliance violations in the last 30 days?
2026-01-25 15:08:28,815 - nl2sql - INFO - endpoints.py:48 - Query success! 161 rows returned.
2026-01-25 15:08:28,831 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 15:08:28,834 - nl2sql - INFO - endpoints.py:48 - Query success! 99 rows returned.
2026-01-25 15:10:34,976 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:10:34,976 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:10:35,079 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:10:35,088 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:10:37,328 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:10:37,352 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:10:37,375 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: general
2026-01-25 15:10:37,378 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:10:37,381 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:10:37,387 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:10:39,260 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:10:39,261 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:10:39,262 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:10:39,262 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:10:39,802 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:10:39,803 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:10:39,808 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:10:39,809 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:10:39,812 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 15:10:40,925 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT alert_rules.rule_name FROM alerts ...
2026-01-25 15:10:40,928 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT DISTINCT alert_rules.rule_name FROM alerts ...
2026-01-25 15:10:40,928 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT DISTINCT alert_rules.rule_name FROM alerts ...
2026-01-25 15:10:40,928 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:10:40,933 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:10:40,933 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_rules.rule_name FROM alerts JOIN alert_rules ON alerts.rule_id = alert_rules.rule_id WHERE alerts.severity IN ('HIGH', 'CRITICAL') AND alerts.creation_timestamp >= date('now', '-30 days')
2026-01-25 15:10:40,938 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: alerts.creation_timestamp
[SQL: SELECT DISTINCT alert_rules.rule_name FROM alerts JOIN alert_rules ON alerts.rule_id = alert_rules.rule_id WHERE alerts.severity IN ('HIGH', 'CRITICAL') AND alerts.creation_timestamp >= date('now', '-30 days')]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT DISTINCT alert_rules.rule_name FROM alerts JOIN alert_rules ON alerts.rule_id = alert_rules.rule_id WHERE alerts.severity IN ('HIGH', 'CRITICAL') AND alerts.creation_timestamp >= date('now', '-30 days')
2026-01-25 15:10:40,938 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:10:40,942 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the compliance violations in the last 30 days?
2026-01-25 15:10:40,942 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:11:16,772 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show operational metrics for last quarter | Domain: general
2026-01-25 15:11:16,772 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:11:16,780 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show operational metrics for last quarter
2026-01-25 15:11:16,783 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:11:17,543 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:11:17,545 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:11:17,545 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:11:17,551 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:11:18,305 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:11:18,307 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:11:18,312 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:11:18,316 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show operational metrics for last quarter
2026-01-25 15:11:18,316 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 15:11:19,089 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Cannot determine "operational metrics" from...
2026-01-25 15:11:19,092 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show operational metrics for last quarter | Msg: Error: Cannot determine "operational metrics" from...
2026-01-25 15:11:19,096 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Cannot determine "operational metrics" from...
2026-01-25 15:11:19,098 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:19,105 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 23.
  Error: Cannot [4mdetermine[0m "operational metrics" from the provided schema. Try asking about: users, transactions, login_events
2026-01-25 15:11:19,112 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:11:19,973 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(*) FROM login_events WHERE event_time...
2026-01-25 15:11:19,978 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:19,991 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:11:19,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(*) FROM login_events WHERE event_timestamp >= date('now', '-3 months')
2026-01-25 15:11:19,997 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: event_timestamp
[SQL: SELECT COUNT(*) FROM login_events WHERE event_timestamp >= date('now', '-3 months')]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT COUNT(*) FROM login_events WHERE event_timestamp >= date('now', '-3 months')
2026-01-25 15:11:19,997 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:11:20,005 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show operational metrics for last quarter
2026-01-25 15:11:20,009 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:11:42,012 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me operation metrics all | Domain: general
2026-01-25 15:11:42,016 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:11:42,025 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me operation metrics all
2026-01-25 15:11:42,030 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:11:42,981 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:11:42,983 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:11:42,983 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:11:42,992 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:11:43,743 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:11:43,746 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:11:43,749 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:11:43,754 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: show me operation metrics all
2026-01-25 15:11:43,754 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 15:11:44,353 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: "operation metrics" is too vague. Try askin...
2026-01-25 15:11:44,355 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: show me operation metrics all | Msg: Error: "operation metrics" is too vague. Try askin...
2026-01-25 15:11:44,355 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: "operation metrics" is too vague. Try askin...
2026-01-25 15:11:44,363 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:44,363 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 29.
  Error: "operation metrics" [4mis[0m too vague. Try asking about: transactions, login_events, alerts.
2026-01-25 15:11:44,371 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:11:45,078 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions UNION ALL SELECT * FROM...
2026-01-25 15:11:45,082 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:45,095 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:11:45,098 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions UNION ALL SELECT * FROM login_events UNION ALL SELECT * FROM alerts
2026-01-25 15:11:45,102 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) SELECTs to the left and right of UNION ALL do not have the same number of result columns
[SQL: SELECT * FROM transactions UNION ALL SELECT * FROM login_events UNION ALL SELECT * FROM alerts]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM transactions UNION ALL SELECT * FROM login_events UNION ALL SELECT * FROM alerts
2026-01-25 15:11:45,104 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:11:45,115 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me operation metrics all
2026-01-25 15:11:45,117 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:12:07,304 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me all operational metrics | Domain: operations
2026-01-25 15:12:07,312 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:12:07,312 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: show me all operational metrics
2026-01-25 15:12:07,312 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:12:07,971 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:12:07,971 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:12:07,977 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:12:07,983 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:12:08,970 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:12:08,974 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:12:08,983 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:12:08,983 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: operations | Query: show me all operational metrics
2026-01-25 15:12:08,991 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the operation...
2026-01-25 15:12:10,034 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The term "operational metrics" is too broad...
2026-01-25 15:12:10,034 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: show me all operational metrics | Msg: Error: The term "operational metrics" is too broad...
2026-01-25 15:12:10,034 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The term "operational metrics" is too broad...
2026-01-25 15:12:10,041 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:12:10,050 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 15.
  Error: The [4mterm[0m "operational metrics" is too broad. Please specify which operational metrics you are interested in.
2026-01-25 15:12:10,058 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:12:10,819 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions...
2026-01-25 15:12:10,824 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:12:10,833 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:12:10,833 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions
2026-01-25 15:12:12,836 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 15:12:12,836 - nl2sql - INFO - workflow.py:92 - Query execution returned 50000 rows.
2026-01-25 15:12:12,842 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 15:12:14,188 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "All...
2026-01-25 15:12:14,197 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me all operational metrics
2026-01-25 15:12:14,201 - nl2sql - INFO - endpoints.py:48 - Query success! 50000 rows returned.
2026-01-25 15:18:08,767 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are complaice in UAE ? | Domain: compliance
2026-01-25 15:18:08,791 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:18:08,797 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what are complaice in UAE ?
2026-01-25 15:18:08,819 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:18:10,238 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:18:10,238 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:18:10,242 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:18:10,262 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:18:11,136 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "country": ...
2026-01-25 15:18:11,136 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'country': 'AE'}
2026-01-25 15:18:11,152 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:18:11,683 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: To help me understand what you're looking for rega...
2026-01-25 15:18:11,685 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are complaice in UAE ?
2026-01-25 15:18:29,425 - nl2sql - INFO - endpoints.py:14 - Incoming query: politcally expoed person | Domain: compliance
2026-01-25 15:18:29,430 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:18:29,431 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: politcally expoed person
2026-01-25 15:18:29,436 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:18:30,492 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:18:30,492 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:18:30,492 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:18:30,501 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:18:31,368 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "is_pep": t...
2026-01-25 15:18:31,371 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'is_pep': True}
2026-01-25 15:18:31,378 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:18:31,385 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: politcally expoed person
2026-01-25 15:18:31,392 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 15:18:32,013 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, email FROM users WHERE pep_status ...
2026-01-25 15:18:32,020 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT user_id, email FROM users WHERE pep_status ...
2026-01-25 15:18:32,023 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT user_id, email FROM users WHERE pep_status ...
2026-01-25 15:18:32,023 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:18:32,042 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:18:32,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, email FROM users WHERE pep_status = 1
2026-01-25 15:18:32,080 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: pep_status
[SQL: SELECT user_id, email FROM users WHERE pep_status = 1]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT user_id, email FROM users WHERE pep_status = 1
2026-01-25 15:18:32,083 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:18:32,092 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: politcally expoed person
2026-01-25 15:18:32,099 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:22:47,413 - nl2sql - INFO - endpoints.py:14 - Incoming query: accroding to transaction monitoring rules in UAE  apid Fund MovementDeposit + withdrawal within short periodAML red flag ..lets see from our data if we are complaint | Domain: compliance
2026-01-25 15:22:47,421 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:22:47,421 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: accroding to transaction monitoring rules in UAE  apid Fund MovementDeposit + withdrawal within short periodAML red flag ..lets see from our data if we are complaint
2026-01-25 15:22:47,430 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:22:49,327 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:22:49,327 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:22:49,332 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:22:49,340 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:22:50,305 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "country": ...
2026-01-25 15:22:50,305 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'country': 'AE', 'transaction_type': ['DEPOSIT', 'WITHDRAWAL']}
2026-01-25 15:22:50,333 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:22:51,192 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: To help me check your compliance with UAE transact...
2026-01-25 15:22:51,195 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: accroding to transaction monitoring rules in UAE  apid Fund MovementDeposit + withdrawal within short periodAML red flag ..lets see from our data if we are complaint
2026-01-25 15:23:10,743 - nl2sql - INFO - endpoints.py:14 - Incoming query: lets whatever time period we have | Domain: compliance
2026-01-25 15:23:10,751 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:23:10,751 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: lets whatever time period we have
2026-01-25 15:23:10,760 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:23:11,602 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:23:11,608 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.7) | Needs Clarification: True
2026-01-25 15:23:11,610 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.7) | Needs Clarification: True
2026-01-25 15:23:11,612 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:23:12,492 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:23:12,496 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:23:12,499 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:23:14,479 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: To effectively check for rapid fund movements, cou...
2026-01-25 15:23:14,482 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: lets whatever time period we have
2026-01-25 15:23:22,078 - nl2sql - INFO - endpoints.py:14 - Incoming query: 24 hrs | Domain: compliance
2026-01-25 15:23:22,083 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:23:22,083 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: 24 hrs
2026-01-25 15:23:22,093 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:23:23,033 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:23:23,033 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:23:23,033 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:23:23,045 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:23:23,887 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:23:23,887 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:23:23,896 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:23:23,900 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: 24 hrs
2026-01-25 15:23:23,905 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 15:23:25,018 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The request "24 hrs" is too vague. It's unc...
2026-01-25 15:23:25,021 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: 24 hrs | Msg: Error: The request "24 hrs" is too vague. It's unc...
2026-01-25 15:23:25,022 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The request "24 hrs" is too vague. It's unc...
2026-01-25 15:23:25,028 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:23:25,030 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Error tokenizing 'y asking about: transactions, login_events, alert'
2026-01-25 15:23:25,047 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:23:26,474 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: This request is to fix an invalid SQL query based ...
2026-01-25 15:23:26,478 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:23:26,496 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 15.
  This request [4mis[0m to fix an invalid SQL query based on the provided error message. The error message indicates that t
2026-01-25 15:23:26,504 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:23:27,297 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(*) FROM transactions WHERE transactio...
2026-01-25 15:23:27,299 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:23:27,319 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:23:27,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(*) FROM transactions WHERE transaction_time >= strftime('%s', 'now', '-24 hours')
2026-01-25 15:23:27,337 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_time
[SQL: SELECT COUNT(*) FROM transactions WHERE transaction_time >= strftime('%s', 'now', '-24 hours')]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT COUNT(*) FROM transactions WHERE transaction_time >= strftime('%s', 'now', '-24 hours')
2026-01-25 15:23:27,339 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:23:27,347 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: 24 hrs
2026-01-25 15:23:27,351 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 16:03:59,009 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:03:59,009 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:03:59,057 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:03:59,060 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:04:10,829 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:04:10,850 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:04:10,870 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:04:10,890 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:04:19,034 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:04:19,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:19,063 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:19,063 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:19,066 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:19,066 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,069 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,071 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:19,075 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:19,078 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:19,082 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,089 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,091 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:19,098 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,098 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:19,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:19,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:19,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,113 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,120 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:19,122 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:19,123 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,125 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,128 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,133 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,133 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:19,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,205 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:19,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:19,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:19,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:19,728 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,728 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,783 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,785 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:19,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,799 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:19,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,829 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,829 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,830 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,830 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:19,832 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:19,832 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,838 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:19,846 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,846 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:19,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:19,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:19,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:19,941 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:19,951 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,951 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:19,954 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:19,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,962 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,970 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:19,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,980 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:19,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:19,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:19,986 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:19,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:19,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:19,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:20,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:20,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,025 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,029 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,029 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,033 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,035 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:20,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:20,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:20,040 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:20,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:20,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,045 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:20,048 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,050 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,064 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:20,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:20,064 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,070 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,074 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,076 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:20,099 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:20,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,110 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:20,149 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:20,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:20,153 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,160 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,161 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:20,165 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:20,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:20,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:20,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:20,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:20,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:20,201 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:20,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:20,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,210 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,214 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,214 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:20,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:20,218 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:20,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:20,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:20,237 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,244 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:25,466 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:25,470 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:25,478 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:25,478 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:25,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:25,482 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,486 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:25,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:25,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:25,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,512 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:25,515 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,521 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,528 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:25,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,533 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:25,535 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:25,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,557 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,557 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:25,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:25,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,571 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,578 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,578 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:25,583 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,586 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:25,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,590 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:25,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:25,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:25,650 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:25,670 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,670 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:25,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,679 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:25,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,681 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,682 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,684 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,686 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,688 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:25,690 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:25,690 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,702 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:25,702 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,702 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:25,714 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:25,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,733 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:25,741 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,759 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:25,768 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,778 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:25,778 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:25,778 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,782 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,783 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,785 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,787 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,787 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,789 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,790 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,791 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,794 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,797 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:25,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,799 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,802 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:25,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,806 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:25,806 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,810 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,812 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:25,814 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:25,814 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,818 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:25,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:25,822 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,824 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,825 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,829 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:25,831 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,831 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:25,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,844 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:25,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,853 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:25,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:25,857 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,857 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,865 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,870 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:25,873 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:25,877 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,878 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:25,880 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:25,882 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:25,882 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,885 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:25,887 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,890 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,892 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,892 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,895 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,895 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:25,895 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:25,899 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,899 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,903 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,905 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:25,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,907 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:25,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,918 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,922 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:30,241 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:30,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:30,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:30,270 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:30,270 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:30,270 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,279 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:30,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,288 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:30,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:30,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:30,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,304 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:30,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,316 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:30,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:30,322 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,322 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:30,324 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:30,324 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,328 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,335 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,335 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:30,340 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:30,341 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,344 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,345 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,357 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,358 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:30,362 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,364 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:30,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:30,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,396 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:30,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,402 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,405 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,412 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:30,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,460 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:30,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:30,477 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,479 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:30,479 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,482 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:30,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,485 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:30,494 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:30,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,512 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:30,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,533 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,533 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:30,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,541 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:30,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:30,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:30,560 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,560 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:30,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,566 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:30,568 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:30,569 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,571 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,573 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,573 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,575 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,576 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,579 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,581 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,582 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,582 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:30,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,592 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,613 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:30,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,621 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,621 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,624 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:30,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,627 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:30,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,641 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,641 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:30,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:30,651 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,651 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:30,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:30,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:30,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,660 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:30,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,678 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:30,681 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,683 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:30,685 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,685 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:30,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,688 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:30,691 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,693 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,695 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,695 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:34,914 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:34,929 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:34,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:34,935 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:34,937 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:34,939 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:34,942 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:34,945 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,946 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:34,947 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,947 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:34,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,954 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:34,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:34,962 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:34,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:34,978 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:34,980 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:34,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:34,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:34,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,987 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:34,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:34,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:35,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,028 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:35,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,033 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:35,036 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,040 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:35,044 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,057 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:35,080 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,082 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:35,084 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,085 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:35,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,087 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:35,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:35,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:35,128 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,128 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,140 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:35,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:35,143 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,143 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:35,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:35,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:35,160 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:35,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:35,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:35,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,183 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,186 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:35,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:35,190 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:35,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,217 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,226 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:35,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,235 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,235 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,235 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:35,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:35,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:35,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:35,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,275 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:35,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:35,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:35,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,285 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:35,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,290 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:39,454 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:39,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:39,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:39,503 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:39,505 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:39,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:39,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,513 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:39,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,519 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:39,520 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,520 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,529 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:39,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,532 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:39,532 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:39,540 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:39,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:39,591 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:39,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:39,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:39,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:39,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,651 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,652 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:39,660 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:39,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,678 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:39,696 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,698 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:39,706 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,709 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,714 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:39,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,719 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:39,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:39,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,723 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,725 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,726 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:39,731 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,732 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:39,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,734 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:39,740 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:39,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,743 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,759 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:39,760 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:39,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,764 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,764 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,775 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,776 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,778 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:39,781 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,781 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,783 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,783 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,785 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,785 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:39,794 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,796 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:39,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,799 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,801 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:39,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:39,804 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,805 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,805 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,809 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,811 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,813 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,815 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:39,815 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,817 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:39,820 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:39,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:39,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:39,828 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,828 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:39,831 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,832 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,835 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,835 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,835 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:39,842 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:39,842 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,844 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,844 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:39,851 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,853 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:39,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:39,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,864 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:39,867 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,875 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,880 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:44,752 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:31:11,686 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 16:31:11,686 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 16:31:11,747 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:31:11,752 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:31:24,874 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 16:31:24,908 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:32:49,822 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are the complaince data capabilities | Domain: compliance
2026-01-25 16:32:49,834 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:32:49,842 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what are the complaince data capabilities
2026-01-25 16:32:49,852 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:32:51,254 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 16:32:51,255 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.8) | Needs Clarification: False
2026-01-25 16:32:51,255 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 0.8) | Needs Clarification: False
2026-01-25 16:32:51,270 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:32:52,368 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 16:32:52,368 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 16:32:52,378 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 16:32:59,181 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As a Database Expert, I can help you understand th...
2026-01-25 16:32:59,186 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are the complaince data capabilities
2026-01-25 16:34:32,592 - nl2sql - INFO - endpoints.py:14 - Incoming query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)? | Domain: compliance
2026-01-25 16:34:32,598 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:34:32,598 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)?
2026-01-25 16:34:32,606 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:34:33,492 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:34:33,492 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:34:33,496 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:34:33,505 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:34:34,155 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-25 16:34:34,155 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'kyc_status': ['PENDING', 'VERIFIED']}
2026-01-25 16:34:34,163 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:34:34,170 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)?
2026-01-25 16:34:34,170 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 16:34:34,894 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-25 16:34:34,897 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-25 16:34:34,903 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-25 16:34:34,903 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:34:34,921 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:34:34,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT kyc_status, COUNT(*) FROM users GROUP BY kyc_status
2026-01-25 16:34:34,942 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:34:34,946 - nl2sql - INFO - workflow.py:92 - Query execution returned 4 rows.
2026-01-25 16:34:34,952 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:34:35,798 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "User ...
2026-01-25 16:34:35,801 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)?
2026-01-25 16:34:35,801 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-25 16:34:48,313 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: compliance
2026-01-25 16:34:48,313 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:34:48,321 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Show me all high severity incidents
2026-01-25 16:34:48,321 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:34:49,525 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 16:34:49,528 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 16:34:49,531 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 16:34:49,536 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:34:50,629 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "severity":...
2026-01-25 16:34:50,630 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 16:34:50,635 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:34:50,641 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Show me all high severity incidents
2026-01-25 16:34:50,643 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 16:34:51,442 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 16:34:51,442 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 16:34:51,447 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 16:34:51,454 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:34:51,465 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:34:51,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE severity = 'HIGH'
2026-01-25 16:34:51,493 - nl2sql - INFO - database.py:60 - Execution complete. Returned 239 rows.
2026-01-25 16:34:51,493 - nl2sql - INFO - workflow.py:92 - Query execution returned 239 rows.
2026-01-25 16:34:51,499 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:34:52,596 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Hig...
2026-01-25 16:34:52,610 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 16:34:52,612 - nl2sql - INFO - endpoints.py:48 - Query success! 239 rows returned.
2026-01-25 16:40:55,802 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me user with rsik score more than 25 | Domain: compliance
2026-01-25 16:40:55,811 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:40:55,813 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: show me user with rsik score more than 25
2026-01-25 16:40:55,815 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:40:56,712 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:40:56,714 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:40:56,714 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:40:56,722 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:40:57,592 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 16:40:57,592 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 16:40:57,599 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:40:57,599 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: show me user with rsik score more than 25
2026-01-25 16:40:57,606 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 16:40:59,091 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The provided schema does not contain a 'ris...
2026-01-25 16:40:59,091 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: show me user with rsik score more than 25 | Msg: Error: The provided schema does not contain a 'ris...
2026-01-25 16:40:59,091 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The provided schema does not contain a 'ris...
2026-01-25 16:40:59,099 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:40:59,107 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mprovided[0m schema does not contain a 'risk_score' column for users or a direct way to query by a numerical ris
2026-01-25 16:40:59,114 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 16:41:00,094 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE risk_level = 'HIGH'...
2026-01-25 16:41:00,101 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:41:00,113 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:41:00,114 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE risk_level = 'HIGH'
2026-01-25 16:41:00,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 17 rows.
2026-01-25 16:41:00,119 - nl2sql - INFO - workflow.py:92 - Query execution returned 17 rows.
2026-01-25 16:41:00,123 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:41:01,290 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Use...
2026-01-25 16:41:01,294 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me user with rsik score more than 25
2026-01-25 16:41:01,294 - nl2sql - INFO - endpoints.py:48 - Query success! 17 rows returned.
2026-01-25 16:42:07,983 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me users with risk score more than 25 | Domain: general
2026-01-25 16:42:07,984 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:42:07,991 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me users with risk score more than 25
2026-01-25 16:42:08,000 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:42:09,607 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:42:09,609 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:42:09,609 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:42:09,613 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:42:10,456 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_score...
2026-01-25 16:42:10,458 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_score': 25}
2026-01-25 16:42:10,462 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:42:10,471 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: show me users with risk score more than 25
2026-01-25 16:42:10,476 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 16:42:11,105 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 16:42:11,105 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 16:42:11,111 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 16:42:11,112 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:42:11,120 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:42:11,130 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, full_name, risk_score FROM users WHERE risk_score > 25
2026-01-25 16:42:11,140 - nl2sql - INFO - database.py:60 - Execution complete. Returned 131 rows.
2026-01-25 16:42:11,142 - nl2sql - INFO - workflow.py:92 - Query execution returned 131 rows.
2026-01-25 16:42:11,144 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:42:12,278 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Use...
2026-01-25 16:42:12,283 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me users with risk score more than 25
2026-01-25 16:42:12,288 - nl2sql - INFO - endpoints.py:48 - Query success! 131 rows returned.
2026-01-25 16:49:13,854 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are risk metrics available in db | Domain: risk
2026-01-25 16:49:13,862 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:49:13,862 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: what are risk metrics available in db
2026-01-25 16:49:13,862 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:49:14,928 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 16:49:14,928 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-25 16:49:14,933 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-25 16:49:14,937 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:49:15,941 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_asses...
2026-01-25 16:49:15,941 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_assessment.level': 'level', 'risk_assessment.score': 'score', 'risk_assessment.pep_status': 'PEP status'}
2026-01-25 16:49:15,950 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 16:49:21,401 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As a Database Expert, I can help you understand th...
2026-01-25 16:49:21,405 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are risk metrics available in db
2026-01-25 16:52:55,692 - nl2sql - INFO - endpoints.py:14 - Incoming query: Detect multiple failed login_attempts for a user_id, which could indicate brute-force attacks. | Domain: risk
2026-01-25 16:52:55,698 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:52:55,698 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: Detect multiple failed login_attempts for a user_id, which could indicate brute-force attacks.
2026-01-25 16:52:55,707 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:52:56,501 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:52:56,508 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:52:56,514 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:52:56,558 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:52:57,413 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "login_stat...
2026-01-25 16:52:57,417 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'login_status': 'FAILED'}
2026-01-25 16:52:57,421 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:52:57,421 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: Detect multiple failed login_attempts for a user_id, which could indicate brute-force attacks.
2026-01-25 16:52:57,436 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 16:52:58,295 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, COUNT(*) AS failed_login_count FRO...
2026-01-25 16:52:58,295 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT user_id, COUNT(*) AS failed_login_count FRO...
2026-01-25 16:52:58,303 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT user_id, COUNT(*) AS failed_login_count FRO...
2026-01-25 16:52:58,305 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:52:58,328 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:52:58,332 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, COUNT(*) AS failed_login_count FROM login_events WHERE event_type = 'FAILED' GROUP BY user_id HAVING COUNT(*) > 5
2026-01-25 16:52:58,346 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: event_type
[SQL: SELECT user_id, COUNT(*) AS failed_login_count FROM login_events WHERE event_type = 'FAILED' GROUP BY user_id HAVING COUNT(*) > 5]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT user_id, COUNT(*) AS failed_login_count FROM login_events WHERE event_type = 'FAILED' GROUP BY user_id HAVING COUNT(*) > 5
2026-01-25 16:52:58,353 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 16:52:58,364 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Detect multiple failed login_attempts for a user_id, which could indicate brute-force attacks.
2026-01-25 16:52:58,365 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 16:53:15,394 - nl2sql - INFO - endpoints.py:14 - Incoming query: Are there any suspicious actions performed by users whose kyc_status is not fully verified? | Domain: risk
2026-01-25 16:53:15,399 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:53:15,401 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: Are there any suspicious actions performed by users whose kyc_status is not fully verified?
2026-01-25 16:53:15,408 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:53:16,140 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:53:16,145 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:53:16,151 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:53:16,160 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:53:17,144 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-25 16:53:17,144 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'kyc_status': 'NOT_VERIFIED'}
2026-01-25 16:53:17,154 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:53:17,154 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: Are there any suspicious actions performed by users whose kyc_status is not fully verified?
2026-01-25 16:53:17,162 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 16:53:17,700 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT al.user_id FROM audit_logs al JOIN...
2026-01-25 16:53:17,701 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT DISTINCT al.user_id FROM audit_logs al JOIN...
2026-01-25 16:53:17,702 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT DISTINCT al.user_id FROM audit_logs al JOIN...
2026-01-25 16:53:17,707 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:53:17,717 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:53:17,721 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT al.user_id FROM audit_logs al JOIN users u ON al.user_id = u.user_id WHERE u.kyc_status <> 'VERIFIED'
2026-01-25 16:53:17,728 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: al.user_id
[SQL: SELECT DISTINCT al.user_id FROM audit_logs al JOIN users u ON al.user_id = u.user_id WHERE u.kyc_status <> 'VERIFIED']
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT DISTINCT al.user_id FROM audit_logs al JOIN users u ON al.user_id = u.user_id WHERE u.kyc_status <> 'VERIFIED'
2026-01-25 16:53:17,729 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 16:53:17,742 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Are there any suspicious actions performed by users whose kyc_status is not fully verified?
2026-01-25 16:53:17,744 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 16:53:31,708 - nl2sql - INFO - endpoints.py:14 - Incoming query: Are there any suspicious actions performed by users whose kyc_status is not fully verified? | Domain: risk
2026-01-25 16:53:31,711 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:53:31,713 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: Are there any suspicious actions performed by users whose kyc_status is not fully verified?
2026-01-25 16:53:31,716 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:53:32,494 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:53:32,497 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:53:32,499 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:53:32,501 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:53:33,363 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-25 16:53:33,366 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'kyc_status': 'NOT_VERIFIED'}
2026-01-25 16:53:33,366 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:53:33,373 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: Are there any suspicious actions performed by users whose kyc_status is not fully verified?
2026-01-25 16:53:33,375 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 16:53:34,133 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT a.user_id, a.action, a.timestamp F...
2026-01-25 16:53:34,140 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT DISTINCT a.user_id, a.action, a.timestamp F...
2026-01-25 16:53:34,143 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT DISTINCT a.user_id, a.action, a.timestamp F...
2026-01-25 16:53:34,147 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:53:34,165 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:53:34,165 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT a.user_id, a.action, a.timestamp FROM audit_logs a JOIN users u ON a.user_id = u.user_id WHERE u.kyc_status <> 'VERIFIED'
2026-01-25 16:53:34,165 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: a.user_id
[SQL: SELECT DISTINCT a.user_id, a.action, a.timestamp FROM audit_logs a JOIN users u ON a.user_id = u.user_id WHERE u.kyc_status <> 'VERIFIED']
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT DISTINCT a.user_id, a.action, a.timestamp FROM audit_logs a JOIN users u ON a.user_id = u.user_id WHERE u.kyc_status <> 'VERIFIED'
2026-01-25 16:53:34,165 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 16:53:34,179 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Are there any suspicious actions performed by users whose kyc_status is not fully verified?
2026-01-25 16:53:34,182 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 17:06:44,086 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: security
2026-01-25 17:06:44,091 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 17:06:44,098 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Show me all high severity incidents
2026-01-25 17:06:44,108 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 17:06:45,166 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 17:06:45,166 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 17:06:45,171 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 17:06:45,177 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 17:06:45,932 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "severity":...
2026-01-25 17:06:45,932 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 17:06:45,942 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 17:06:45,945 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: Show me all high severity incidents
2026-01-25 17:06:45,953 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 17:06:46,830 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 17:06:46,832 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 17:06:46,832 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 17:06:46,836 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 17:06:46,846 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 17:06:46,846 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE severity = 'HIGH'
2026-01-25 17:06:46,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 239 rows.
2026-01-25 17:06:46,877 - nl2sql - INFO - workflow.py:92 - Query execution returned 239 rows.
2026-01-25 17:06:46,884 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 17:06:47,928 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Hig...
2026-01-25 17:06:47,933 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 17:06:47,933 - nl2sql - INFO - endpoints.py:48 - Query success! 239 rows returned.
2026-01-25 17:08:51,725 - nl2sql - INFO - endpoints.py:14 - Incoming query: How can ypu hel[ me ith this | Domain: compliance
2026-01-25 17:08:51,728 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 17:08:51,729 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How can ypu hel[ me ith this
2026-01-25 17:08:51,731 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 17:08:52,630 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "UNKNOWN",
  "confidence": 0...
2026-01-25 17:08:52,631 - nl2sql - INFO - intent_classification.py:82 - Classification Result: UNKNOWN (conf: 0.9) | Needs Clarification: True
2026-01-25 17:08:52,633 - nl2sql - INFO - workflow.py:24 - Intent classified: UNKNOWN (conf: 0.9) | Needs Clarification: True
2026-01-25 17:08:52,651 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 17:08:53,339 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 17:08:53,340 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 17:08:53,348 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 17:08:54,148 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: To help me understand what you need, could you ple...
2026-01-25 17:08:54,151 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: How can ypu hel[ me ith this
2026-01-25 17:09:18,844 - nl2sql - INFO - endpoints.py:14 - Incoming query: What kind of compliance issues you are capable of answering? | Domain: compliance
2026-01-25 17:09:18,849 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 17:09:18,849 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What kind of compliance issues you are capable of answering?
2026-01-25 17:09:18,849 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 17:09:19,695 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "Compliance and Risk Managem...
2026-01-25 17:09:19,697 - nl2sql - INFO - intent_classification.py:82 - Classification Result: Compliance and Risk Management (conf: 0.9) | Needs Clarification: False
2026-01-25 17:09:19,699 - nl2sql - INFO - workflow.py:24 - Intent classified: Compliance and Risk Management (conf: 0.9) | Needs Clarification: False
2026-01-25 17:09:19,707 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 17:09:20,380 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 17:09:20,383 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 17:09:20,391 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 17:09:20,392 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What kind of compliance issues you are capable of answering?
2026-01-25 17:09:20,396 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 17:09:21,269 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The query cannot be answered with the given...
2026-01-25 17:09:21,271 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: What kind of compliance issues you are capable of answering? | Msg: Error: The query cannot be answered with the given...
2026-01-25 17:09:21,271 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The query cannot be answered with the given...
2026-01-25 17:09:21,278 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 17:09:21,288 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 16.
  Error: The [4mquery[0m cannot be answered with the given schema. The database schema does not contain information about ge
2026-01-25 17:09:21,295 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 17:09:21,912 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT 'I can answer questions about users, transa...
2026-01-25 17:09:21,919 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 17:09:21,928 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 17:09:21,931 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT 'I can answer questions about users, transactions, login_events, alerts, and alert_rules.'
2026-01-25 17:09:21,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 17:09:21,937 - nl2sql - INFO - workflow.py:92 - Query execution returned 1 rows.
2026-01-25 17:09:21,944 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 17:09:22,962 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Com...
2026-01-25 17:09:22,966 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What kind of compliance issues you are capable of answering?
2026-01-25 17:09:22,966 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-25 17:10:35,062 - nl2sql - INFO - endpoints.py:14 - Incoming query: Can you give me user transactions from high compliance issue regions? | Domain: compliance
2026-01-25 17:10:35,068 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 17:10:35,071 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Can you give me user transactions from high compliance issue regions?
2026-01-25 17:10:35,072 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 17:10:35,747 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 17:10:35,755 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 17:10:35,755 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 17:10:35,762 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 17:10:36,765 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "country": "HIGH_RI...
2026-01-25 17:10:36,765 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'country': 'HIGH_RISK'}
2026-01-25 17:10:36,780 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 17:10:36,781 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Can you give me user transactions from high compliance issue regions?
2026-01-25 17:10:36,787 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 17:10:37,665 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: "high compliance issue regions" is ambiguou...
2026-01-25 17:10:37,665 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Can you give me user transactions from high compliance issue regions? | Msg: Error: "high compliance issue regions" is ambiguou...
2026-01-25 17:10:37,665 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: "high compliance issue regions" is ambiguou...
2026-01-25 17:10:37,678 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 17:10:37,681 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 41.
  Error: "high compliance issue regions" [4mis[0m ambiguous. Try asking about: users (country, risk_level), transactions (amount, instrument, status)
2026-01-25 17:10:37,683 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 17:10:38,535 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions WHERE user_id IN (SELEC...
2026-01-25 17:10:38,540 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 17:10:38,555 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 17:10:38,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions WHERE user_id IN (SELECT user_id FROM users WHERE country IN (SELECT country FROM compliance_issues WHERE level = 'high'))
2026-01-25 17:10:38,565 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: compliance_issues
[SQL: SELECT * FROM transactions WHERE user_id IN (SELECT user_id FROM users WHERE country IN (SELECT country FROM compliance_issues WHERE level = 'high'))]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM transactions WHERE user_id IN (SELECT user_id FROM users WHERE country IN (SELECT country FROM compliance_issues WHERE level = 'high'))
2026-01-25 17:10:38,565 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 17:10:38,573 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Can you give me user transactions from high compliance issue regions?
2026-01-25 17:10:38,573 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 17:12:18,698 - nl2sql - INFO - endpoints.py:14 - Incoming query: can you give me split of users with high risk score ? | Domain: compliance
2026-01-25 17:12:18,705 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 17:12:18,707 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: can you give me split of users with high risk score ?
2026-01-25 17:12:18,709 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 17:12:19,486 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 17:12:19,486 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 17:12:19,491 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 17:12:19,494 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 17:12:20,186 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_level...
2026-01-25 17:12:20,186 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_level': 'HIGH'}
2026-01-25 17:12:20,195 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 17:12:20,200 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: can you give me split of users with high risk score ?
2026-01-25 17:12:20,203 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 17:12:21,182 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT risk_level, COUNT(*) FROM users WHERE risk_...
2026-01-25 17:12:21,183 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT risk_level, COUNT(*) FROM users WHERE risk_...
2026-01-25 17:12:21,183 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT risk_level, COUNT(*) FROM users WHERE risk_...
2026-01-25 17:12:21,188 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 17:12:21,199 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 17:12:21,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level, COUNT(*) FROM users WHERE risk_level = 'HIGH' GROUP BY risk_level
2026-01-25 17:12:21,207 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 17:12:21,208 - nl2sql - INFO - workflow.py:92 - Query execution returned 1 rows.
2026-01-25 17:12:21,212 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 17:12:22,162 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Count...
2026-01-25 17:12:22,162 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: can you give me split of users with high risk score ?
2026-01-25 17:12:22,162 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-25 17:15:13,381 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me transactions with staus failed | Domain: compliance
2026-01-25 17:15:13,388 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 17:15:13,394 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: show me transactions with staus failed
2026-01-25 17:15:13,402 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 17:15:14,363 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 17:15:14,365 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 17:15:14,365 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 17:15:14,380 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 17:15:15,406 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "status": "...
2026-01-25 17:15:15,412 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'status': 'FAILED'}
2026-01-25 17:15:15,423 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 17:15:15,425 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: show me transactions with staus failed
2026-01-25 17:15:15,433 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 17:15:16,113 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions WHERE status = 'FAILED'...
2026-01-25 17:15:16,115 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM transactions WHERE status = 'FAILED'...
2026-01-25 17:15:16,115 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM transactions WHERE status = 'FAILED'...
2026-01-25 17:15:16,120 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 17:15:16,134 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 17:15:16,139 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions WHERE status = 'FAILED'
2026-01-25 17:15:16,432 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1867 rows.
2026-01-25 17:15:16,432 - nl2sql - INFO - workflow.py:92 - Query execution returned 1867 rows.
2026-01-25 17:15:16,442 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 17:15:17,722 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Fai...
2026-01-25 17:15:17,729 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me transactions with staus failed
2026-01-25 17:15:17,733 - nl2sql - INFO - endpoints.py:48 - Query success! 1867 rows returned.
2026-01-25 17:15:56,362 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: compliance
2026-01-25 17:15:56,367 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 17:15:56,367 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What are the compliance violations in the last 30 days?
2026-01-25 17:15:56,369 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 17:25:53,465 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv6:%5B2404:6800:4007:832::200a%5D:443: socket is null
2026-01-25 17:25:53,465 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-25 17:25:53,465 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 17:25:53,474 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 17:51:52,013 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv6:%5B2404:6800:4007:832::200a%5D:443: socket is null
2026-01-25 17:51:52,056 - nl2sql - ERROR - entity_extractor.py:88 - Entity Extraction Error: Expecting value: line 1 column 1 (char 0)
2026-01-25 17:51:52,343 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 17:51:52,349 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What are the compliance violations in the last 30 days?
2026-01-25 17:51:52,357 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 19:02:33,542 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:172.217.24.74:443: tcp handshaker shutdown
2026-01-25 19:02:34,168 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: What are the compliance violations in the last 30 days? | Msg: Error generating response: Timeout of 600.0s excee...
2026-01-25 19:02:34,183 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error generating response: Timeout of 600.0s excee...
2026-01-25 19:02:34,201 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 19:02:34,206 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 19:02:34,217 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 19:12:33,824 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.250.182.74:443: tcp handshaker shutdown
2026-01-25 19:12:33,828 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 19:12:33,828 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 19:12:33,832 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 19:22:30,616 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv6:%5B2404:6800:4007:83d::200a%5D:443: tcp handshaker shutdown
2026-01-25 19:22:30,616 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 19:22:30,616 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 19:22:30,623 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 19:32:26,157 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv6:%5B2404:6800:4007:808::200a%5D:443: tcp handshaker shutdown
2026-01-25 19:32:26,160 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 19:32:26,161 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 19:32:26,163 - nl2sql - INFO - endpoints.py:24 - Graph execution status: None for query: What are the compliance violations in the last 30 days?
2026-01-25 19:32:26,164 - nl2sql - WARNING - endpoints.py:38 - Validation failure for query: What are the compliance violations in the last 30 days? | Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 19:44:30,178 - nl2sql - INFO - endpoints.py:14 - Incoming query: what data you have right now | Domain: security
2026-01-25 19:44:30,183 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 19:44:30,191 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: what data you have right now
2026-01-25 19:44:30,197 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 19:54:26,204 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.251.222.170:443: tcp handshaker shutdown
2026-01-25 19:54:26,204 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-25 19:54:26,204 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 19:54:26,209 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 20:04:23,512 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.251.222.170:443: tcp handshaker shutdown
2026-01-25 20:04:23,512 - nl2sql - ERROR - entity_extractor.py:88 - Entity Extraction Error: Expecting value: line 1 column 1 (char 0)
2026-01-25 20:04:23,515 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 20:04:23,517 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: what data you have right now
2026-01-25 20:04:23,519 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 20:14:23,452 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.250.182.74:443: tcp handshaker shutdown
2026-01-25 20:14:23,452 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: what data you have right now | Msg: Error generating response: Timeout of 600.0s excee...
2026-01-25 20:14:23,454 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error generating response: Timeout of 600.0s excee...
2026-01-25 20:14:23,454 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 20:14:23,454 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 20:14:23,454 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 20:24:15,758 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.251.221.202:443: tcp handshaker shutdown
2026-01-25 20:24:15,763 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 20:24:15,767 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 20:24:15,773 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 20:28:39,689 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 20:28:39,733 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 20:36:31,838 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.251.222.170:443: tcp handshaker shutdown
2026-01-25 20:36:32,113 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 20:36:32,125 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 20:36:32,220 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 20:46:27,230 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:172.217.24.170:443: tcp handshaker shutdown
2026-01-25 20:46:27,237 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 20:46:27,240 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 20:46:27,243 - nl2sql - INFO - endpoints.py:24 - Graph execution status: None for query: what data you have right now
2026-01-25 20:46:27,246 - nl2sql - WARNING - endpoints.py:38 - Validation failure for query: what data you have right now | Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 20:47:19,542 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me users with failed login attempts | Domain: general
2026-01-25 20:47:19,550 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 20:47:19,555 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me users with failed login attempts
2026-01-25 20:47:19,563 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 20:57:15,779 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:172.217.24.170:443: tcp handshaker shutdown
2026-01-25 20:57:15,782 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-25 20:57:15,782 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 20:57:15,792 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 21:07:15,646 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.250.205.106:443: tcp handshaker shutdown
2026-01-25 21:07:15,662 - nl2sql - ERROR - entity_extractor.py:88 - Entity Extraction Error: Expecting value: line 1 column 1 (char 0)
2026-01-25 21:07:15,735 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 21:07:15,743 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: show me users with failed login attempts
2026-01-25 21:07:15,760 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 21:13:31,682 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 21:13:31,682 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 21:13:31,720 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 21:13:31,720 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 21:13:42,760 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 21:13:42,792 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 21:13:43,080 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 21:13:43,101 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 21:14:26,996 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 21:14:27,082 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 21:14:27,277 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 21:14:27,396 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 21:17:14,601 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.251.222.170:443: tcp handshaker shutdown
2026-01-25 21:17:14,601 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: show me users with failed login attempts | Msg: Error generating response: Timeout of 600.0s excee...
2026-01-25 21:17:14,604 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error generating response: Timeout of 600.0s excee...
2026-01-25 21:17:14,632 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 21:17:14,647 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 21:17:14,651 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 21:51:05,339 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.251.222.202:443: tcp handshaker shutdown
2026-01-25 21:51:06,408 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 21:51:06,417 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 21:51:06,431 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 22:03:15,923 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.250.206.10:443: tcp handshaker shutdown
2026-01-25 22:03:16,010 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 22:03:16,047 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 22:03:16,151 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 22:11:32,123 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me users with risk score more than 25 | Domain: general
2026-01-25 22:11:32,784 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 22:11:32,808 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me users with risk score more than 25
2026-01-25 22:11:33,428 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 22:11:38,277 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 22:11:38,285 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 22:11:38,293 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 22:11:38,309 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 22:11:39,266 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_score...
2026-01-25 22:11:39,270 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_score': 25}
2026-01-25 22:11:39,322 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 22:11:39,325 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: show me users with risk score more than 25
2026-01-25 22:11:39,333 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 22:11:39,779 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 22:11:39,792 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 22:11:39,845 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 22:11:39,990 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 22:11:40,144 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 22:11:40,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, full_name, risk_score FROM users WHERE risk_score > 25
2026-01-25 22:11:40,272 - nl2sql - INFO - database.py:60 - Execution complete. Returned 131 rows.
2026-01-25 22:11:40,292 - nl2sql - INFO - workflow.py:92 - Query execution returned 131 rows.
2026-01-25 22:11:40,316 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 22:11:40,983 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Use...
2026-01-25 22:11:41,053 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me users with risk score more than 25
2026-01-25 22:11:41,070 - nl2sql - INFO - endpoints.py:48 - Query success! 131 rows returned.
2026-01-25 22:12:03,929 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are your capabilities | Domain: general
2026-01-25 22:12:03,994 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 22:12:04,009 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: what are your capabilities
2026-01-25 22:12:04,065 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 22:12:04,983 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 22:12:05,016 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-25 22:12:05,068 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-25 22:12:05,167 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 22:12:06,194 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 22:12:06,230 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 22:12:06,448 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 22:12:12,455 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As a Database Expert, I have access to a comprehen...
2026-01-25 22:12:12,523 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are your capabilities
2026-01-25 22:13:01,364 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:13:01,363 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:13:02,074 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:13:02,074 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:13:14,674 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:142.251.222.202:443: tcp handshaker shutdown
2026-01-25 22:13:15,001 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 22:13:15,086 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 22:13:15,188 - nl2sql - INFO - endpoints.py:24 - Graph execution status: None for query: show me users with failed login attempts
2026-01-25 22:13:15,191 - nl2sql - WARNING - endpoints.py:38 - Validation failure for query: show me users with failed login attempts | Error: Invalid expression / Unexpected token. Line 1, Col: 25.
  Error generating [4mresponse[0m: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UN
2026-01-25 22:13:38,590 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:13:38,714 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:13:39,723 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:13:39,832 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:13:55,477 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:13:56,276 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:14:10,965 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:14:11,438 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:14:12,336 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:14:12,701 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:14:32,797 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:14:33,900 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:14:54,790 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:14:55,769 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:14:56,121 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:14:58,184 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:15:11,592 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:15:12,407 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:16:03,740 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:16:05,856 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:16:06,162 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:16:06,488 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:16:07,488 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:16:07,637 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:17:05,650 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:17:05,834 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:17:05,883 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:17:06,079 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:17:06,209 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:17:06,262 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:31:27,908 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:31:27,908 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:31:27,913 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:31:29,005 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:31:29,005 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:31:29,007 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:50:18,418 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:50:18,418 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:50:18,418 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:50:18,763 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:50:18,763 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:50:18,764 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:50:36,429 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:50:36,433 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:50:36,448 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:50:37,266 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:50:37,293 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:50:37,294 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:51:05,364 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:05,415 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:05,838 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:06,033 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:07,022 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:51:07,073 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:51:07,727 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:51:35,218 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:35,230 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 22:51:35,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 22:51:35,261 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 22:51:35,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 22:51:35,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 22:51:35,275 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:35,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 22:51:35,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:35,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 22:51:35,323 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:35,325 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 22:51:35,329 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 22:51:35,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 22:51:35,361 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 22:51:35,364 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 22:51:35,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 22:51:35,369 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 22:51:35,373 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:51:35,378 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 22:51:35,386 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 22:51:35,386 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 22:51:35,392 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:51:35,394 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 22:51:35,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 22:51:35,398 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 22:51:35,404 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 22:51:35,404 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 22:51:35,411 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 22:51:35,412 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 22:51:35,419 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:51:35,420 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 22:51:35,428 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:35,432 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 22:51:35,447 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:35,452 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 22:51:35,455 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 22:51:35,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 22:51:36,731 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:51:36,763 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 22:51:37,038 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:37,047 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 22:51:37,233 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 22:51:37,234 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 22:51:37,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 22:51:37,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 22:51:39,873 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:51:39,966 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 22:51:40,226 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:40,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 22:51:44,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:51:44,125 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 22:51:44,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:51:44,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 22:51:44,400 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:44,405 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 22:51:44,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:44,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 22:51:48,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:51:48,690 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 22:51:49,135 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:49,280 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:50,014 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:51:51,147 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:51:51,324 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:51:51,926 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:51:52,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:51:52,976 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 22:51:54,672 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 22:51:54,780 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 22:51:57,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 22:51:57,297 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 22:51:57,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:51:57,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 22:51:57,756 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 22:51:57,795 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 22:51:57,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:57,874 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 22:51:57,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:57,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 22:51:58,058 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 22:51:58,062 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 22:51:58,095 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 22:51:58,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 22:51:58,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:51:58,122 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 22:51:58,145 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 22:51:58,148 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 22:51:58,619 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 22:51:58,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 22:51:58,660 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:58,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 22:51:58,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:51:58,680 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 22:51:58,703 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 22:51:58,705 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 22:51:59,185 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 22:51:59,203 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 22:51:59,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 22:51:59,207 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 22:51:59,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:51:59,220 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 22:51:59,226 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:51:59,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 22:51:59,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 22:51:59,231 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 22:51:59,241 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:51:59,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 22:51:59,244 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:51:59,248 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 22:51:59,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:59,255 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 22:51:59,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:59,269 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 22:51:59,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:51:59,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 22:51:59,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 22:51:59,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 22:51:59,319 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:51:59,327 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 22:51:59,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:51:59,360 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 22:51:59,376 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 22:51:59,378 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 22:51:59,393 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:51:59,400 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 22:51:59,412 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:51:59,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 22:51:59,422 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:51:59,429 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 22:51:59,443 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 22:51:59,445 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 22:51:59,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:59,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 22:51:59,470 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 22:51:59,475 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 22:51:59,477 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:51:59,480 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 22:51:59,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 22:51:59,496 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 22:51:59,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 22:51:59,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 22:51:59,918 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 22:51:59,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 22:51:59,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:51:59,984 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 22:51:59,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 22:52:00,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 22:52:00,026 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 22:52:00,029 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 22:52:00,580 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 22:52:00,610 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 22:52:00,623 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:00,633 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 22:52:01,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 22:52:01,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 22:52:02,338 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 22:52:02,426 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 22:52:02,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 22:52:02,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 22:52:02,452 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 22:52:02,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 22:52:02,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 22:52:02,520 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 22:52:02,550 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 22:52:02,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 22:52:02,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 22:52:02,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 22:52:02,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,643 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 22:52:02,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:02,653 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 22:52:02,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 22:52:02,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 22:52:02,768 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:02,775 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 22:52:02,789 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:02,792 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 22:52:02,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:02,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 22:52:02,950 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:02,956 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 22:52:02,996 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:02,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 22:52:03,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:03,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 22:52:03,048 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:50,686 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:52:50,698 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 22:52:50,711 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 22:52:50,712 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 22:52:50,723 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 22:52:50,726 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 22:52:50,743 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:50,749 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 22:52:50,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:50,776 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 22:52:50,798 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:50,804 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 22:52:50,812 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 22:52:50,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 22:52:50,826 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 22:52:50,826 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 22:52:50,832 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 22:52:50,834 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 22:52:50,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:52:50,843 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 22:52:50,859 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 22:52:50,862 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 22:52:50,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:50,869 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 22:52:50,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 22:52:50,874 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 22:52:50,877 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 22:52:50,881 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 22:52:50,885 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 22:52:50,890 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 22:52:50,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:52:50,898 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 22:52:50,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:50,910 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 22:52:50,918 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:50,920 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 22:52:50,922 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 22:52:50,927 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 22:52:51,738 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:52:51,771 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 22:52:51,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:51,880 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 22:52:51,939 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 22:52:51,942 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 22:52:51,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 22:52:52,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 22:52:53,020 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:52:53,050 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 22:52:53,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:53,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 22:52:54,425 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:52:54,462 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 22:52:54,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:52:54,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 22:52:54,675 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:54,675 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 22:52:54,790 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:52:54,793 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 22:52:56,433 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:52:56,461 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 22:52:57,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 22:52:57,334 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 22:52:58,355 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 22:52:58,397 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 22:52:59,063 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 22:52:59,096 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 22:52:59,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:52:59,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 22:52:59,319 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 22:52:59,338 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 22:52:59,378 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:59,384 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 22:52:59,427 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:52:59,429 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 22:52:59,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 22:52:59,486 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 22:52:59,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 22:52:59,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 22:52:59,528 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:52:59,530 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 22:52:59,548 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 22:52:59,552 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 22:53:00,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 22:53:00,218 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 22:53:00,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:00,244 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 22:53:00,270 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:53:00,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 22:53:00,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 22:53:00,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 22:53:00,813 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 22:53:00,830 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 22:53:00,835 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 22:53:00,838 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 22:53:00,846 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:53:00,853 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 22:53:00,859 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:53:00,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 22:53:00,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 22:53:00,877 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 22:53:00,882 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:53:00,884 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 22:53:00,890 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:53:00,890 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 22:53:00,896 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:00,899 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 22:53:00,906 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:00,909 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 22:53:00,915 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:53:00,918 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 22:53:00,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 22:53:00,939 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 22:53:00,944 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:53:00,947 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 22:53:00,951 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 22:53:00,956 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 22:53:00,963 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 22:53:00,965 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 22:53:00,973 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:00,978 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 22:53:00,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:53:00,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 22:53:00,993 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 22:53:00,997 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 22:53:01,014 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 22:53:01,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 22:53:01,031 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,035 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 22:53:01,047 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 22:53:01,050 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 22:53:01,057 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,059 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 22:53:01,079 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 22:53:01,082 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 22:53:01,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 22:53:01,090 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 22:53:01,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 22:53:01,247 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 22:53:01,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 22:53:01,284 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 22:53:01,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 22:53:01,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 22:53:01,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 22:53:01,323 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 22:53:01,475 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 22:53:01,484 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 22:53:01,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,498 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 22:53:01,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 22:53:01,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 22:53:01,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 22:53:01,875 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 22:53:01,880 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 22:53:01,882 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 22:53:01,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,898 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 22:53:01,904 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,906 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 22:53:01,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,915 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 22:53:01,924 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 22:53:01,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,939 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 22:53:01,941 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,941 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 22:53:01,948 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,950 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 22:53:01,956 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 22:53:01,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,966 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 22:53:01,972 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 22:53:01,974 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 22:53:01,977 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 22:53:01,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 22:53:01,989 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:01,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 22:53:01,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:01,998 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 22:53:02,006 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:02,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 22:53:02,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:02,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 22:53:02,020 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:02,023 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 22:53:02,031 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:02,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 22:53:02,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 22:53:02,788 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 22:53:08,586 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:53:08,900 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:53:09,323 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 22:53:09,617 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:53:09,832 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 22:53:10,164 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:03:02,515 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:03:02,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:03:02,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:03:02,541 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:03:02,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:03:02,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:03:02,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:02,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:03:02,601 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:02,601 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:03:02,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:02,607 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:03:02,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:03:02,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:03:02,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:03:02,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:03:02,613 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:03:02,613 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:03:02,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:03:02,615 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:03:02,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:03:02,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:03:02,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:02,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:03:02,621 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:03:02,621 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:03:02,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:03:02,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:03:02,623 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:03:02,623 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:03:02,624 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:03:02,624 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:03:02,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:02,626 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:03:02,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:02,626 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:03:02,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:03:02,626 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:03:02,859 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:03:02,874 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:03:02,926 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:02,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:03:02,942 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:03:02,942 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:03:02,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:03:02,954 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:03:03,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:03:03,096 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:03:03,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:03,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:03:03,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:03:03,250 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:03:03,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:03:03,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:03:03,274 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:03,274 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:03:03,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:03,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:03:03,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:03:03,452 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:03:03,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:03:03,618 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:03:03,768 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:03:03,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:03:03,890 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:03:03,893 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:03:03,893 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:03:03,893 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:03:03,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:03:03,967 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:03:03,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:03,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:03:03,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:03,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:03:04,011 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:03:04,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:03:04,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:03:04,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:03:04,022 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:03:04,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:03:04,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:03:04,075 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:03:04,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:03:04,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:03:04,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:03:04,098 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:03:04,102 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:03:04,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:03:04,159 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:03:04,159 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:03:04,159 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:03:04,159 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:03:04,159 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:03:04,166 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:03:04,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:03:04,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:03:04,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:03:04,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:03:04,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:03:04,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:03:04,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:03:04,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:03:04,174 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:03:04,175 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,175 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:03:04,175 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:03:04,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:03:04,175 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:03:04,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:03:04,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:03:04,183 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:03:04,184 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:03:04,184 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:03:04,185 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:03:04,186 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:03:04,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:03:04,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:03:04,189 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:03:04,189 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:03:04,190 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:03:04,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:03:04,192 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:03:04,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:03:04,193 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:03:04,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:03:04,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:03:04,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:03:04,200 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:03:04,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:03:04,200 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:03:04,256 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:03:04,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:03:04,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:03:04,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:03:04,272 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:03:04,272 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:03:04,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:03:04,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:03:04,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:03:04,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:03:04,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,307 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:03:04,337 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:03:04,339 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:03:04,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:03:04,368 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:03:04,370 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:03:04,370 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:03:04,370 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,373 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:03:04,373 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,375 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:03:04,375 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,375 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:03:04,375 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,377 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:03:04,377 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,377 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:03:04,378 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,379 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:03:04,380 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,380 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:03:04,382 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,382 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:03:04,383 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,384 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:03:04,385 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:03:04,385 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:03:04,386 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:03:04,387 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:03:04,387 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,388 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:03:04,389 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,389 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:03:04,390 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,391 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:03:04,392 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,392 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:03:04,395 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,395 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:03:04,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,397 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:03:04,397 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:03:04,567 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:13:00,672 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:13:00,688 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:13:00,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:13:00,688 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:13:00,695 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:13:00,695 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:13:00,698 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:00,699 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:13:00,702 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:00,704 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:13:00,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:00,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:13:00,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:13:00,714 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:13:00,719 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:13:00,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:13:00,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:13:00,721 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:13:00,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:13:00,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:13:00,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:13:00,724 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:13:00,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:00,727 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:13:00,728 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:13:00,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:13:00,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:13:00,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:13:00,732 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:13:00,732 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:13:00,732 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:13:00,734 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:13:00,736 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:00,738 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:13:00,740 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:00,741 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:13:00,742 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:13:00,742 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:13:00,853 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:13:00,862 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:13:00,887 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:00,890 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:13:00,908 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:13:00,908 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:13:00,924 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:13:00,933 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:13:01,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:13:01,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:13:01,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:01,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:13:01,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:13:01,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:13:01,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:13:01,309 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:13:01,325 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:01,325 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:13:01,344 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:01,344 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:13:01,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:13:01,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:13:01,817 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:13:01,817 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:13:02,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:13:02,023 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:13:02,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:13:02,175 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:13:02,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:13:02,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:13:02,226 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:13:02,237 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:13:02,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:02,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:13:02,275 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:02,275 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:13:02,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:13:02,289 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:13:02,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:13:02,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:13:02,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,301 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:13:02,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:13:02,309 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:13:02,375 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:13:02,375 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:13:02,375 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,375 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:13:02,393 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:13:02,393 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:13:02,398 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:13:02,398 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:13:02,458 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:13:02,467 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:13:02,467 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:13:02,467 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:13:02,467 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:13:02,467 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:13:02,472 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:13:02,472 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:13:02,472 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:13:02,474 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:13:02,475 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:13:02,475 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:13:02,477 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:13:02,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:13:02,478 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:13:02,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,480 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:13:02,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:13:02,482 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:13:02,484 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:13:02,485 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:13:02,485 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:13:02,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:13:02,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:13:02,489 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:13:02,490 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:13:02,491 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:13:02,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:13:02,493 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:13:02,493 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:13:02,495 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:13:02,496 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:13:02,498 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:13:02,498 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:13:02,499 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:13:02,500 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:13:02,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:13:02,500 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:13:02,505 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:13:02,505 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:13:02,506 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:13:02,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:13:02,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:13:02,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:13:02,550 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:13:02,550 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:13:02,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:13:02,553 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:13:02,556 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:13:02,557 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:13:02,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:13:02,618 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:13:02,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,631 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:13:02,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:13:02,677 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:13:02,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:13:02,708 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:13:02,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:13:02,708 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:13:02,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:13:02,717 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,717 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:13:02,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,718 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:13:02,719 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:13:02,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:13:02,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,722 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:13:02,722 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:13:02,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,724 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:13:02,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,724 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:13:02,726 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:13:02,727 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:13:02,728 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:13:02,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:13:02,736 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,736 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:13:02,738 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,739 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:13:02,740 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:13:02,932 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:23:01,394 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:23:01,404 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:23:01,406 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:23:01,406 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:23:01,407 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:23:01,407 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:23:01,408 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:01,408 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:23:01,409 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:01,410 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:23:01,413 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:01,413 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:23:01,414 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:23:01,414 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:23:01,416 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:23:01,417 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:23:01,419 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:23:01,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:23:01,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:23:01,420 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:23:01,421 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:23:01,421 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:23:01,421 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:01,421 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:23:01,422 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:23:01,422 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:23:01,424 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:23:01,424 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:23:01,425 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:23:01,425 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:23:01,426 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:23:01,426 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:23:01,428 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:01,428 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:23:01,430 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:01,431 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:23:01,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:23:01,431 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:23:01,705 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:23:01,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:23:01,744 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:01,747 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:23:01,764 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:23:01,764 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:23:01,784 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:23:01,785 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:23:01,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:23:01,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:23:01,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:01,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:23:02,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:23:02,216 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:23:02,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:23:02,231 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:23:02,241 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:02,241 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:23:02,252 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:02,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:23:02,538 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:23:02,548 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:23:02,707 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:23:02,713 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:23:02,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:23:02,921 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:23:03,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:23:03,043 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:23:03,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:23:03,045 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:23:03,102 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:23:03,105 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:23:03,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:03,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:23:03,136 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:03,136 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:23:03,164 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:23:03,165 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:23:03,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:23:03,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:23:03,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,184 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:23:03,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:23:03,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:23:03,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:23:03,307 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:23:03,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:23:03,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:23:03,316 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:23:03,319 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:23:03,320 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:23:03,401 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:23:03,405 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:23:03,407 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:23:03,408 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:23:03,410 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:23:03,411 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:23:03,412 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:23:03,412 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:23:03,413 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:23:03,414 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:23:03,415 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:23:03,416 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:23:03,416 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:23:03,417 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:23:03,418 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,418 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:23:03,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,422 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:23:03,423 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:23:03,423 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:23:03,425 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:23:03,425 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:23:03,426 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:23:03,426 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:23:03,427 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:23:03,428 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:23:03,430 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:23:03,430 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:23:03,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,432 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:23:03,433 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:23:03,434 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:23:03,435 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:23:03,435 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:23:03,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:23:03,441 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:23:03,442 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,443 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:23:03,445 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:23:03,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:23:03,447 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,447 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:23:03,451 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:23:03,452 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:23:03,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:23:03,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:23:03,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:23:03,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:23:03,514 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:23:03,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:23:03,519 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:23:03,519 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:23:03,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:23:03,522 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:23:03,563 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:23:03,565 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:23:03,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:23:03,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:23:03,597 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:23:03,631 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:23:03,634 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:23:03,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:23:03,635 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:23:03,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:23:03,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:23:03,639 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,639 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:23:03,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:23:03,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:23:03,642 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:23:03,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:23:03,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:23:03,645 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:23:03,646 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:23:03,646 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:23:03,646 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:23:03,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:23:03,648 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,648 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:23:03,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:23:03,650 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,650 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:23:03,650 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,651 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:23:03,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,652 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:23:03,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:23:03,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:23:03,839 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:32:59,176 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:32:59,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:32:59,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:32:59,190 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:32:59,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:32:59,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:32:59,193 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:32:59,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:32:59,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:32:59,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:32:59,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:32:59,198 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:32:59,198 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:32:59,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:32:59,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:32:59,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:32:59,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:32:59,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:32:59,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:32:59,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:32:59,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:32:59,205 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:32:59,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:32:59,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:32:59,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:32:59,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:32:59,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:32:59,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:32:59,209 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:32:59,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:32:59,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:32:59,210 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:32:59,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:32:59,211 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:32:59,213 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:32:59,213 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:32:59,213 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:32:59,215 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:32:59,313 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:32:59,317 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:32:59,327 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:32:59,340 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:32:59,350 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:32:59,350 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:32:59,365 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:32:59,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:32:59,499 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:32:59,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:32:59,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:32:59,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:32:59,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:32:59,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:32:59,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:32:59,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:32:59,676 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:32:59,678 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:32:59,687 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:32:59,687 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:32:59,838 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:32:59,844 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:32:59,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:32:59,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:33:00,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:33:00,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:33:00,266 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:33:00,272 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:33:00,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:33:00,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:33:00,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:33:00,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:33:00,327 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:33:00,328 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:33:00,333 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:33:00,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:33:00,348 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:33:00,349 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:33:00,354 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:33:00,354 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:33:00,357 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,357 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:33:00,362 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:33:00,362 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:33:00,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:33:00,422 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:33:00,427 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,429 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:33:00,433 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:33:00,434 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:33:00,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:33:00,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:33:00,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:33:00,492 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:33:00,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:33:00,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:33:00,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:33:00,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:33:00,500 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:33:00,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:33:00,501 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:33:00,501 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:33:00,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:33:00,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:33:00,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:33:00,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:33:00,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:33:00,505 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,506 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:33:00,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:33:00,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:33:00,509 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:33:00,510 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:33:00,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:33:00,512 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:33:00,512 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:33:00,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:33:00,514 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:33:00,514 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:33:00,515 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,515 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:33:00,516 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:33:00,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:33:00,516 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:33:00,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:33:00,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:33:00,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:33:00,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:33:00,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:33:00,521 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:33:00,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,522 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:33:00,523 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:33:00,523 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:33:00,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:33:00,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:33:00,547 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:33:00,549 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:33:00,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:33:00,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:33:00,557 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:33:00,557 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:33:00,559 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:33:00,559 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:33:00,581 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:33:00,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:33:00,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:33:00,621 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:33:00,623 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:33:00,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:33:00,651 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:33:00,651 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:33:00,652 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:33:00,653 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:33:00,653 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:33:00,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:33:00,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:33:00,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,658 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:33:00,659 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:33:00,659 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:33:00,660 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,660 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:33:00,661 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,662 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:33:00,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:33:00,663 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:33:00,664 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:33:00,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:33:00,664 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:33:00,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,667 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:33:00,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:33:00,668 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:33:00,668 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:33:00,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,670 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:33:00,670 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:33:00,838 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:35:24,904 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:35:24,908 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:35:24,916 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:35:24,918 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:35:24,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:35:24,927 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:35:24,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:24,935 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:35:24,943 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:24,945 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:35:24,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:24,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:35:24,960 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:35:24,960 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:35:24,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:35:24,969 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:35:24,969 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:35:24,969 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:35:24,978 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:35:24,978 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:35:24,974 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:35:24,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:35:24,984 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:35:24,989 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:35:24,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:35:24,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:24,994 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:35:24,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:35:25,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:35:25,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:35:25,006 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:35:25,011 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:35:25,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:35:25,013 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:35:25,013 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:35:25,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:25,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:35:25,033 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:25,037 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:35:25,042 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:35:25,044 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:35:25,510 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:35:25,511 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:35:25,511 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:35:25,556 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:35:25,568 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:35:25,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:25,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:35:25,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:35:25,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:35:25,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:35:25,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:35:25,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:35:25,880 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:35:25,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:25,897 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:35:26,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:35:26,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:35:26,140 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:35:26,145 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:35:26,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:26,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:35:26,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:26,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:35:26,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:35:26,540 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:35:26,817 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:35:26,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:35:27,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:35:27,204 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:35:27,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:35:27,477 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:35:27,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:35:27,480 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:35:27,558 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:35:27,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:35:27,573 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:27,573 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:35:27,599 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:27,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:35:27,645 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:35:27,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:35:27,657 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:35:27,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:35:27,671 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:27,671 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:35:27,681 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:35:27,681 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:35:27,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:35:27,825 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:35:27,834 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:27,839 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:35:27,846 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:35:27,847 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:35:27,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:35:27,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:35:28,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:35:28,212 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:35:28,218 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:35:28,220 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:35:28,229 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:35:28,231 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:35:28,235 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:35:28,240 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:35:28,248 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:35:28,251 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:35:28,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:35:28,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:35:28,293 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:35:28,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:35:28,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,309 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:35:28,313 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,314 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:35:28,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:35:28,317 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:35:28,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:35:28,338 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:35:28,342 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:35:28,346 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:35:28,347 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:35:28,348 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:35:28,354 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:35:28,356 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:35:28,363 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:28,365 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:35:28,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:35:28,368 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:35:28,372 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:35:28,375 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:35:28,388 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:35:28,389 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:35:28,397 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,398 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:35:28,405 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:35:28,407 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:35:28,412 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,413 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:35:28,422 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:35:28,425 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:35:28,432 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:35:28,434 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:35:28,498 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:35:28,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:35:28,513 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:35:28,514 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:35:28,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:35:28,522 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:35:28,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:35:28,529 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:35:28,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:35:28,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:35:28,605 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:35:28,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:35:28,684 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:35:28,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:35:28,771 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:35:28,771 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:35:28,773 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:35:28,775 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,778 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:35:28,779 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,779 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:35:28,779 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,779 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:35:28,782 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,784 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:35:28,786 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,786 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:35:28,788 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,788 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:35:28,790 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,792 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:35:28,795 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,795 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:35:28,795 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,798 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:35:28,800 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:35:28,802 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:35:28,802 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:35:28,804 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:35:28,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:28,804 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:35:28,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:28,804 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:35:28,807 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:28,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:35:28,808 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:28,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:35:28,808 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:28,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:35:28,814 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:28,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:35:28,819 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:35:29,164 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:41:37,012 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:41:37,012 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:41:37,012 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:41:40,173 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:41:40,173 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:42:07,474 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:42:07,476 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:42:07,898 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:42:07,898 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:42:07,908 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:42:08,722 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:42:08,722 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:42:08,722 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:42:08,722 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:42:08,722 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:42:08,734 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:42:08,739 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:08,742 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:42:08,747 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:08,750 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:42:08,757 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:08,760 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:42:08,761 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:42:08,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:42:08,767 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:42:08,768 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:42:08,768 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:42:08,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:42:08,771 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:42:08,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:42:08,778 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:42:08,779 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:42:08,780 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:08,782 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:42:08,782 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:42:08,782 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:42:08,786 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:42:08,786 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:42:08,787 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:42:08,787 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:42:08,792 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:42:08,792 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:42:08,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:08,797 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:42:08,808 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:08,808 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:42:08,808 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:42:08,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:42:09,068 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:42:09,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:42:09,114 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:09,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:42:09,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:42:09,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:42:09,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:42:09,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:42:09,338 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:42:09,344 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:42:09,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:09,374 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:42:09,545 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:42:09,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:42:09,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:42:09,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:42:09,593 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:09,593 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:42:09,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:09,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:42:09,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:42:09,870 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:42:10,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:42:10,140 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:42:10,406 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:42:10,425 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:42:10,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:42:10,614 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:42:10,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:42:10,615 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:42:10,675 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:42:10,675 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:42:10,695 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:10,695 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:42:10,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:10,708 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:42:10,739 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:42:10,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:42:10,749 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:42:10,749 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:42:10,761 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:10,764 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:42:10,772 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:42:10,772 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:42:10,858 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:42:10,858 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:42:10,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:10,872 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:42:10,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:42:10,872 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:42:10,888 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:42:10,889 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:42:10,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:42:10,972 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:42:10,973 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:42:10,973 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:42:10,973 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:42:10,978 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:42:10,980 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:42:10,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:42:10,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:42:10,982 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:42:10,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:42:10,982 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:42:10,986 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:42:10,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:42:10,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:10,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:42:10,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:10,991 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:42:10,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:42:10,993 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:42:10,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:42:10,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:42:11,000 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:42:11,000 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:42:11,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:42:11,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:42:11,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:42:11,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:42:11,010 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:11,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:42:11,014 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:42:11,015 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:42:11,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:42:11,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:42:11,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:42:11,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:42:11,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:42:11,024 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:42:11,024 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:42:11,024 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,024 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:42:11,032 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:42:11,033 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:42:11,036 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:42:11,039 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:42:11,068 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:42:11,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:42:11,080 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:42:11,081 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:42:11,086 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:42:11,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:42:11,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:42:11,091 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:42:11,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:42:11,140 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:42:11,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,149 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:42:11,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:42:11,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:42:11,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:42:11,235 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:42:11,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:42:11,239 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:42:11,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,243 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:42:11,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:42:11,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:42:11,251 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:42:11,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:42:11,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:42:11,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,263 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:42:11,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,263 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:42:11,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:42:11,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:42:11,269 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:42:11,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:42:11,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:42:11,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:11,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:42:11,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:11,289 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:42:11,293 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:11,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:42:11,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:11,298 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:42:11,298 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:11,298 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:42:11,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:11,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:42:11,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:42:12,180 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:42:57,187 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:45:28,542 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:45:28,556 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:45:28,560 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:45:28,563 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:45:28,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:45:28,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:45:28,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:28,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:45:28,571 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:28,572 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:45:28,574 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:28,576 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:45:28,580 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:45:28,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:45:28,582 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:45:28,582 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:45:28,583 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:45:28,583 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:45:28,586 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:45:28,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:45:28,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:45:28,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:45:28,591 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:28,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:45:28,596 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:45:28,596 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:45:28,597 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:45:28,597 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:45:28,598 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:45:28,598 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:45:28,598 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:45:28,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:45:28,604 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:28,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:45:28,606 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:28,607 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:45:28,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:45:28,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:45:28,764 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:45:28,776 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:45:28,803 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:28,812 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:45:28,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:45:28,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:45:28,847 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:45:28,847 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:45:29,073 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:45:29,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:45:29,114 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:29,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:45:29,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:45:29,340 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:45:29,365 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:45:29,367 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:45:29,388 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:29,388 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:45:29,411 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:29,413 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:45:29,759 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:45:29,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:45:30,070 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:45:30,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:45:30,527 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:45:30,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:45:30,734 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:45:30,751 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:45:30,751 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:45:30,751 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:45:30,805 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:45:30,809 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:45:30,826 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:30,826 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:45:30,826 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:30,839 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:45:30,859 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:45:30,859 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:45:30,862 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:45:30,866 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:45:30,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:30,871 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:45:30,877 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:45:30,878 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:45:30,954 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:45:30,959 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:45:30,965 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:30,966 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:45:30,973 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:45:30,973 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:45:30,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:45:30,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:45:31,074 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:45:31,081 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:45:31,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:45:31,081 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:45:31,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:45:31,084 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:45:31,085 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:45:31,085 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:45:31,086 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:45:31,086 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:45:31,086 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:45:31,089 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:45:31,092 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:45:31,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:45:31,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,093 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:45:31,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,094 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:45:31,095 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:45:31,095 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:45:31,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:45:31,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:45:31,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:45:31,101 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:45:31,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:45:31,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:45:31,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:45:31,105 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:45:31,107 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:45:31,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:45:31,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:45:31,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:45:31,109 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:45:31,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:45:31,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:45:31,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:45:31,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:45:31,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:45:31,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:45:31,122 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:45:31,124 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:45:31,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:45:31,126 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:45:31,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:45:31,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:45:31,165 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:45:31,166 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:45:31,168 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:45:31,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:45:31,172 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:45:31,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:45:31,209 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:45:31,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:45:31,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,217 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:45:31,246 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:45:31,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:45:31,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:45:31,295 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:45:31,295 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:45:31,299 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:45:31,299 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,299 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:45:31,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,301 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:45:31,303 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,304 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:45:31,306 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:45:31,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,309 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:45:31,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:45:31,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:45:31,315 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,316 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:45:31,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,317 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:45:31,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:45:31,318 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:45:31,320 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:45:31,322 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:45:31,325 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,325 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:45:31,326 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,326 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:45:31,327 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,327 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:45:31,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,330 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:45:31,332 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:45:31,334 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,334 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:45:31,335 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:45:31,561 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:47:50,716 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:47:50,716 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:47:50,716 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:47:50,969 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:47:50,969 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:47:50,976 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:47:52,225 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:47:52,225 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:47:52,225 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:47:52,225 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:47:52,225 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:47:52,225 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:47:52,236 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:52,237 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:47:52,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:52,240 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:47:52,244 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:52,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:47:52,247 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:47:52,247 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:47:52,251 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:47:52,251 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:47:52,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:47:52,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:47:52,255 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:47:52,255 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:47:52,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:47:52,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:47:52,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:52,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:47:52,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:47:52,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:47:52,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:47:52,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:47:52,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:47:52,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:47:52,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:47:52,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:47:52,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:52,272 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:47:52,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:52,276 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:47:52,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:47:52,279 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:47:52,454 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:47:52,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:47:52,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:52,468 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:47:52,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:47:52,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:47:52,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:47:52,526 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:47:52,722 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:47:52,738 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:47:52,744 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:52,744 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:47:52,888 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:47:52,893 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:47:52,904 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:47:52,908 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:47:52,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:52,920 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:47:52,921 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:52,921 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:47:53,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:47:53,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:47:53,255 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:47:53,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:47:53,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:47:53,445 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:47:53,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:47:53,568 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:47:53,568 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:47:53,568 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:47:53,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:47:53,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:47:53,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:53,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:47:53,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:53,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:47:53,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:47:53,654 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:47:53,659 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:47:53,660 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:47:53,664 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:53,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:47:53,668 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:47:53,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:47:53,727 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:47:53,727 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:47:53,727 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:53,737 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:47:53,744 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:47:53,744 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:47:53,748 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:47:53,748 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:47:53,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:47:53,804 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:47:53,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:47:53,804 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:47:53,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:47:53,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:47:53,808 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:47:53,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:47:53,811 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:47:53,811 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:47:53,812 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:47:53,814 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:47:53,815 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:47:53,815 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:47:53,815 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:53,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:47:53,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:53,817 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:47:53,818 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:47:53,818 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:47:53,820 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:47:53,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:47:53,822 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:47:53,822 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:47:53,824 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:47:53,824 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:47:53,826 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:47:53,826 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:53,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:47:53,836 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:47:53,836 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:47:53,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:53,837 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:47:53,840 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:47:53,840 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:47:53,840 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:47:53,842 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:47:53,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:47:53,866 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:47:53,867 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:47:53,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:47:53,875 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:47:53,876 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:47:53,878 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:47:53,879 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:47:53,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:47:53,908 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:47:53,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:53,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:47:53,943 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:47:53,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:47:53,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:47:53,988 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:47:53,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:47:53,993 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:47:53,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,000 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:47:54,001 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,003 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:47:54,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:47:54,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:47:54,010 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,013 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:47:54,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:47:54,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:47:54,020 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,020 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:47:54,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:47:54,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:47:54,024 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:47:54,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:47:54,030 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:47:54,031 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:54,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:47:54,034 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:54,035 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:47:54,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:54,038 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:47:54,039 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:54,039 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:47:54,042 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:54,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:47:54,047 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:54,050 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:47:54,054 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:47:54,817 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:52:05,629 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:52:05,643 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:52:05,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:52:05,643 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:52:05,648 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:52:05,648 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:52:05,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:05,652 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:52:05,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:05,654 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:52:05,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:05,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:52:05,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:52:05,658 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:52:05,661 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:52:05,662 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:52:05,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:52:05,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:52:05,663 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:52:05,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:52:05,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:52:05,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:52:05,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:05,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:52:05,668 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:52:05,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:52:05,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:52:05,670 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:52:05,671 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:52:05,671 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:52:05,671 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:52:05,672 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:52:05,674 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:05,674 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:52:05,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:05,679 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:52:05,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:52:05,679 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:52:05,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:52:05,786 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:52:05,803 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:05,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:52:05,817 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:52:05,817 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:52:05,832 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:52:05,832 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:52:05,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:52:05,969 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:52:05,980 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:05,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:52:06,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:52:06,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:52:06,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:52:06,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:52:06,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:06,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:52:06,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:06,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:52:06,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:52:06,318 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:52:06,472 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:52:06,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:52:06,621 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:52:06,633 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:52:06,756 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:52:06,762 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:52:06,763 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:52:06,763 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:52:06,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:52:06,809 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:52:06,819 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:06,819 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:52:06,819 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:06,819 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:52:06,838 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:52:06,838 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:52:06,847 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:52:06,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:52:06,849 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:06,849 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:52:06,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:52:06,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:52:06,908 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:52:06,908 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:52:06,917 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:06,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:52:06,923 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:52:06,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:52:06,924 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:52:06,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:52:06,978 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:52:06,987 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:52:06,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:52:06,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:52:06,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:52:06,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:52:06,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:52:06,994 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:52:06,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:52:06,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:52:06,996 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:52:06,996 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:52:06,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:52:06,998 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:52:06,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:06,998 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:52:06,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:06,998 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:52:06,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:52:06,998 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:52:07,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:52:07,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:52:07,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:52:07,005 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:52:07,006 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:52:07,006 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:52:07,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:52:07,009 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:52:07,010 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:52:07,011 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:52:07,011 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:52:07,012 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:52:07,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:52:07,014 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:52:07,015 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:52:07,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:52:07,019 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:52:07,020 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:52:07,020 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:52:07,024 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:52:07,025 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:52:07,026 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:52:07,028 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:52:07,052 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:52:07,054 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:52:07,059 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:52:07,059 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:52:07,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:52:07,063 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:52:07,065 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:52:07,065 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:52:07,091 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:52:07,091 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:52:07,091 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,101 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:52:07,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:52:07,132 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:52:07,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:52:07,163 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:52:07,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:52:07,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:52:07,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:52:07,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,166 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:52:07,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:52:07,168 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:52:07,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:52:07,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:52:07,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:52:07,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:52:07,172 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:52:07,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:52:07,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:52:07,178 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:52:07,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:52:07,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:52:07,826 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:53:24,470 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:53:24,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:53:24,472 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:53:24,474 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:53:24,475 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:53:24,475 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:53:24,478 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:24,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:53:24,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:24,480 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:53:24,484 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:24,484 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:53:24,485 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:53:24,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:53:24,489 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:53:24,490 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:53:24,491 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:53:24,491 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:53:24,493 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:53:24,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:53:24,496 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:53:24,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:53:24,498 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:24,499 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:53:24,501 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:53:24,501 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:53:24,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:53:24,502 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:53:24,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:53:24,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:53:24,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:53:24,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:53:24,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:24,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:53:24,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:24,510 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:53:24,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:53:24,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:53:24,671 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:53:24,676 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:53:24,696 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:24,697 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:53:24,707 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:53:24,709 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:53:24,719 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:53:24,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:53:24,858 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:53:24,864 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:53:24,875 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:24,877 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:53:25,015 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:53:25,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:53:25,030 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:53:25,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:53:25,041 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:53:25,051 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,052 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:53:25,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:53:25,211 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:53:25,353 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:53:25,360 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:53:25,509 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:53:25,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:53:25,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:53:25,636 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:53:25,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:53:25,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:53:25,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:53:25,682 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:53:25,689 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:25,690 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:53:25,699 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:25,699 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:53:25,709 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:53:25,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:53:25,715 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:53:25,715 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:53:25,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:25,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:53:25,723 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:53:25,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:53:25,781 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:53:25,783 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:53:25,788 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,788 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:53:25,793 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:53:25,794 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:53:25,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:53:25,797 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:53:25,856 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:53:25,857 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:53:25,859 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:53:25,860 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:53:25,860 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:53:25,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:53:25,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:53:25,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:53:25,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:53:25,864 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:53:25,865 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:53:25,866 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:53:25,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:53:25,868 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:53:25,869 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,870 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:53:25,871 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,872 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:53:25,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:53:25,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:53:25,878 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:53:25,879 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:53:25,880 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:53:25,881 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:53:25,883 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:53:25,883 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:53:25,885 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:53:25,886 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:53:25,886 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:25,888 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:53:25,889 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:53:25,889 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:53:25,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:53:25,891 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:53:25,894 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:53:25,895 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:53:25,896 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,896 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:53:25,899 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:53:25,900 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:53:25,900 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,900 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:53:25,904 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:53:25,904 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:53:25,906 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:53:25,907 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:53:25,932 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:53:25,934 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:53:25,939 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:53:25,940 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:53:25,943 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:53:25,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:53:25,946 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:53:25,946 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:53:25,977 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:53:25,978 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:53:25,980 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:25,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:53:26,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:53:26,024 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:53:26,061 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:53:26,063 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:53:26,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:53:26,064 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:53:26,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:53:26,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:53:26,069 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,069 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:53:26,070 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,070 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:53:26,072 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,072 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:53:26,073 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,074 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:53:26,075 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,076 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:53:26,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,078 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:53:26,078 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:53:26,080 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:53:26,080 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:53:26,082 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:53:26,082 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:53:26,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:26,084 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:53:26,084 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:26,085 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:53:26,086 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:26,087 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:53:26,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:26,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:53:26,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:26,090 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:53:26,091 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:26,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:53:26,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:53:26,908 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:55:24,440 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:55:24,452 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:55:24,452 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:55:24,452 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:55:24,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:55:24,454 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:55:24,456 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:24,456 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:55:24,458 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:24,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:55:24,460 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:24,460 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:55:24,461 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:55:24,461 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:55:24,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:55:24,463 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:55:24,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:55:24,464 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:55:24,465 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:55:24,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:55:24,467 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:55:24,467 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:55:24,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:24,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:55:24,470 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:55:24,470 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:55:24,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:55:24,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:55:24,472 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:55:24,472 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:55:24,473 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:55:24,474 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:55:24,478 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:24,479 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:55:24,483 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:24,484 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:55:24,485 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:55:24,485 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:55:24,589 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:55:24,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:55:24,621 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:24,623 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:55:24,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:55:24,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:55:24,646 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:55:24,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:55:24,786 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:55:24,791 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:55:24,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:24,806 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:55:24,972 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:55:24,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:55:24,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:55:24,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:55:25,001 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:25,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:55:25,014 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:25,014 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:55:25,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:55:25,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:55:25,380 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:55:25,386 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:55:25,606 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:55:25,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:55:25,777 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:55:25,783 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:55:25,784 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:55:25,784 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:55:25,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:55:25,839 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:55:25,849 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:25,850 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:55:25,860 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:25,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:55:25,878 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:55:25,880 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:55:25,884 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:55:25,885 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:55:25,888 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:25,889 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:55:25,894 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:55:25,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:55:25,986 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:55:25,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:55:25,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:25,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:55:26,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:55:26,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:55:26,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:55:26,009 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:55:26,074 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:55:26,077 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:55:26,078 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:55:26,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:55:26,079 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:55:26,080 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:55:26,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:55:26,082 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:55:26,082 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:55:26,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:55:26,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:55:26,084 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:55:26,085 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:55:26,087 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:55:26,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:55:26,089 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,089 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:55:26,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:55:26,090 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:55:26,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:55:26,094 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:55:26,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:55:26,096 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:55:26,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:55:26,098 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:55:26,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:55:26,101 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:55:26,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:55:26,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:55:26,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:55:26,105 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:55:26,105 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:55:26,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:55:26,109 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:55:26,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,111 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:55:26,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:55:26,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:55:26,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,114 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:55:26,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:55:26,118 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:55:26,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:55:26,119 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:55:26,142 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:55:26,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:55:26,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:55:26,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:55:26,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:55:26,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:55:26,156 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:55:26,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:55:26,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:55:26,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:55:26,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:55:26,244 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:55:26,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:55:26,275 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:55:26,277 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:55:26,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:55:26,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:55:26,278 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,279 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:55:26,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:55:26,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,281 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:55:26,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:55:26,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:55:26,284 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,284 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:55:26,285 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,286 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:55:26,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:55:26,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:55:26,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:55:26,291 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:55:26,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:55:26,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:55:26,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:55:26,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:55:26,295 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:55:26,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:55:26,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:55:26,298 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,298 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:55:26,299 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:55:26,500 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:57:53,284 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-25 23:57:53,293 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:57:53,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:57:53,295 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:57:53,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:57:53,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:57:53,302 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:53,304 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:57:53,306 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:53,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:57:53,307 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:53,307 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:57:53,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:57:53,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:57:53,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:57:53,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:57:53,313 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:57:53,314 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:57:53,315 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:57:53,315 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:57:53,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:57:53,318 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:57:53,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:53,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:57:53,319 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:57:53,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:57:53,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:57:53,321 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:57:53,323 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:57:53,323 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:57:53,324 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:57:53,324 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:57:53,327 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:53,328 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:57:53,330 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:53,331 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:57:53,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:57:53,331 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:57:53,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:57:53,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:57:53,476 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:53,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:57:53,490 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:57:53,490 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:57:53,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:57:53,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:57:53,695 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:57:53,701 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:57:53,719 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:53,722 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:57:53,902 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:57:53,910 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:57:53,928 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:57:53,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:57:53,947 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:53,948 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:57:53,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:53,966 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:57:54,139 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:57:54,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:57:54,347 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:57:54,353 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:57:54,520 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:57:54,525 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:57:54,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:57:54,675 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:57:54,676 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:57:54,676 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:57:54,726 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:57:54,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:57:54,736 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:54,739 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:57:54,750 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:54,750 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:57:54,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:57:54,766 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:57:54,771 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:57:54,771 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:57:54,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:54,775 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:57:54,778 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:57:54,779 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:57:54,844 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:57:54,846 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:57:54,850 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:54,851 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:57:54,856 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:57:54,858 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:57:54,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:57:54,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:57:54,926 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:57:54,929 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:57:54,929 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:57:54,929 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:57:54,931 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:57:54,933 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:57:54,934 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:57:54,934 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:57:54,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:57:54,935 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:57:54,937 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:57:54,938 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:57:54,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:57:54,939 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:57:54,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:54,940 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:57:54,942 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:54,942 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:57:54,943 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:57:54,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:57:54,946 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:57:54,946 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:57:54,949 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:57:54,949 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:57:54,950 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:57:54,951 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:57:54,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:57:54,953 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:57:54,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:54,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:57:54,956 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:57:54,956 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:57:54,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:57:54,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:57:54,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:57:54,960 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:57:54,961 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:54,963 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:57:54,964 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:57:54,966 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:57:54,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:54,967 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:57:54,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:57:54,969 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:57:54,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:57:54,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:57:54,993 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:57:54,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:57:54,999 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:57:55,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:57:55,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:57:55,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:57:55,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:57:55,005 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:57:55,032 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:57:55,034 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:57:55,035 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,036 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:57:55,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:57:55,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:57:55,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:57:55,095 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:57:55,096 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:57:55,096 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:57:55,096 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:57:55,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:57:55,099 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,099 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:57:55,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:57:55,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,101 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:57:55,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:57:55,102 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:57:55,102 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:57:55,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:57:55,106 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:57:55,106 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:57:55,107 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:57:55,107 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:57:55,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:55,109 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:57:55,110 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:55,111 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:57:55,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:55,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:57:55,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:55,113 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:57:55,114 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:55,115 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:57:55,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:55,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:57:55,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:57:55,830 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 23:58:47,544 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:58:47,600 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:58:47,667 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:58:47,761 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:58:47,818 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:58:47,878 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 23:58:48,860 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 23:58:48,862 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 23:58:48,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:58:48,864 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 23:58:48,865 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 23:58:48,865 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-25 23:58:48,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:48,868 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-25 23:58:48,871 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:48,871 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-25 23:58:48,874 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:48,875 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-25 23:58:48,876 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:58:48,876 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-25 23:58:48,879 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-25 23:58:48,880 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-25 23:58:48,881 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:58:48,881 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-25 23:58:48,883 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:58:48,883 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-25 23:58:48,886 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-25 23:58:48,888 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-25 23:58:48,889 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:48,889 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-25 23:58:48,890 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:58:48,890 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-25 23:58:48,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-25 23:58:48,892 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-25 23:58:48,893 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 23:58:48,893 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-25 23:58:48,893 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:58:48,895 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-25 23:58:48,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:48,897 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-25 23:58:48,900 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:48,901 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 23:58:48,902 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 23:58:48,902 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-25 23:58:49,053 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:58:49,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-25 23:58:49,078 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:49,081 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-25 23:58:49,095 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:58:49,095 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-25 23:58:49,106 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:58:49,106 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-25 23:58:49,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:58:49,251 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-25 23:58:49,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:49,265 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-25 23:58:49,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:58:49,402 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-25 23:58:49,416 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:58:49,418 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-25 23:58:49,428 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:49,429 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-25 23:58:49,439 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:49,439 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-25 23:58:49,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:58:49,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-25 23:58:49,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 23:58:49,776 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-25 23:58:49,924 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-25 23:58:49,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-25 23:58:50,105 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-25 23:58:50,113 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 23:58:50,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:58:50,115 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-25 23:58:50,160 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:58:50,164 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-25 23:58:50,174 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:50,176 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-25 23:58:50,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:50,183 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-25 23:58:50,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-25 23:58:50,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-25 23:58:50,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-25 23:58:50,200 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-25 23:58:50,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,205 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-25 23:58:50,209 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:58:50,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-25 23:58:50,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-25 23:58:50,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-25 23:58:50,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-25 23:58:50,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:58:50,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-25 23:58:50,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 23:58:50,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-25 23:58:50,405 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-25 23:58:50,408 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 23:58:50,410 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:58:50,410 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-25 23:58:50,411 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:58:50,413 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-25 23:58:50,413 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:58:50,413 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-25 23:58:50,415 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:58:50,416 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-25 23:58:50,417 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:58:50,418 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-25 23:58:50,419 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:58:50,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-25 23:58:50,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,421 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-25 23:58:50,422 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,423 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 23:58:50,424 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:58:50,424 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-25 23:58:50,429 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:58:50,430 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-25 23:58:50,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:58:50,432 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-25 23:58:50,433 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 23:58:50,434 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-25 23:58:50,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-25 23:58:50,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-25 23:58:50,437 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,439 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-25 23:58:50,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:58:50,441 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-25 23:58:50,442 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 23:58:50,443 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-25 23:58:50,446 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-25 23:58:50,447 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-25 23:58:50,448 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,448 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-25 23:58:50,450 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-25 23:58:50,451 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-25 23:58:50,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,454 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-25 23:58:50,457 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-25 23:58:50,458 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 23:58:50,458 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 23:58:50,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-25 23:58:50,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:58:50,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-25 23:58:50,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-25 23:58:50,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-25 23:58:50,506 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-25 23:58:50,506 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-25 23:58:50,509 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 23:58:50,509 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-25 23:58:50,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:58:50,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-25 23:58:50,543 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-25 23:58:50,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-25 23:58:50,598 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-25 23:58:50,663 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-25 23:58:50,667 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 23:58:50,671 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 23:58:50,672 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-25 23:58:50,676 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,677 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-25 23:58:50,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,679 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-25 23:58:50,682 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,685 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-25 23:58:50,687 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,687 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-25 23:58:50,689 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,689 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-25 23:58:50,691 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-25 23:58:50,693 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,693 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-25 23:58:50,694 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,695 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-25 23:58:50,696 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,698 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-25 23:58:50,701 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 23:58:50,702 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 23:58:50,703 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 23:58:50,704 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-25 23:58:50,705 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,705 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-25 23:58:50,706 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,706 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-25 23:58:50,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,709 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-25 23:58:50,711 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,713 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-25 23:58:50,714 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-25 23:58:50,717 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:50,718 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-25 23:58:50,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 23:58:51,676 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:01:59,088 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:01:59,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:01:59,092 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:01:59,092 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:01:59,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:01:59,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:01:59,105 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:01:59,105 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:01:59,107 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:01:59,107 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:01:59,110 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:01:59,110 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:01:59,110 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:01:59,110 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:01:59,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:01:59,113 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:01:59,114 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:01:59,114 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:01:59,114 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:01:59,115 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:01:59,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:01:59,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:01:59,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:01:59,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:01:59,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:01:59,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:01:59,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:01:59,119 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:01:59,120 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:01:59,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:01:59,121 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:01:59,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:01:59,123 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:01:59,124 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:01:59,125 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:01:59,126 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:01:59,126 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:01:59,126 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:01:59,217 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:01:59,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:01:59,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:01:59,250 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:01:59,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:01:59,261 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:01:59,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:01:59,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:01:59,412 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:01:59,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:01:59,430 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:01:59,430 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:01:59,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:01:59,578 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:01:59,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:01:59,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:01:59,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:01:59,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:01:59,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:01:59,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:01:59,767 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:01:59,767 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:01:59,918 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:01:59,918 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:02:00,075 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:02:00,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:02:00,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:02:00,203 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:02:00,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:02:00,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:02:00,239 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:02:00,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:02:00,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:02:00,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:02:00,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:02:00,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:02:00,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:02:00,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:02:00,293 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:02:00,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:02:00,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:02:00,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:02:00,300 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:02:00,354 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:02:00,360 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:02:00,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,368 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:02:00,373 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:02:00,373 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:02:00,377 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:02:00,378 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:02:00,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:02:00,441 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:02:00,441 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:02:00,441 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:02:00,441 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:02:00,445 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:02:00,446 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:02:00,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:02:00,447 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:02:00,447 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:02:00,448 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:02:00,448 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:02:00,450 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:02:00,454 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:02:00,454 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:02:00,454 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:02:00,454 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:02:00,456 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:02:00,456 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:02:00,458 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:02:00,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:02:00,459 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:02:00,460 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:02:00,460 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:02:00,461 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:02:00,461 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:02:00,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:02:00,463 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:02:00,464 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,464 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:02:00,464 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:02:00,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:02:00,466 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:02:00,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:02:00,469 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:02:00,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:02:00,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:02:00,491 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:02:00,493 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:02:00,494 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:02:00,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:02:00,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:02:00,502 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:02:00,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:02:00,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:02:00,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:02:00,534 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:02:00,538 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:02:00,558 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:02:00,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:02:00,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:02:00,588 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:02:00,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:02:00,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:02:00,597 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,597 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:02:00,597 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,597 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:02:00,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:02:00,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:02:00,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,602 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:02:00,602 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:02:00,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:02:00,604 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:02:00,605 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,605 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:02:00,605 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:02:00,606 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:02:00,606 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:02:00,607 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:02:00,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:02:00,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:02:00,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:02:00,610 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,610 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:02:00,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:02:00,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:00,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:02:00,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:02:01,182 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:03:20,273 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:03:20,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:03:20,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:03:20,294 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:03:20,303 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:03:20,304 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:03:20,307 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:20,307 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:03:20,313 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:20,313 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:03:20,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:20,320 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:03:20,323 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:03:20,323 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:03:20,325 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:03:20,327 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:03:20,329 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:03:20,332 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:03:20,333 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:03:20,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:03:20,338 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:03:20,338 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:03:20,338 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:20,341 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:03:20,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:03:20,342 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:03:20,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:03:20,347 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:03:20,348 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:03:20,349 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:03:20,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:03:20,349 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:03:20,352 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:20,353 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:03:20,358 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:20,358 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:03:20,360 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:03:20,361 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:03:20,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:03:20,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:03:20,548 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:20,553 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:03:20,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:03:20,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:03:20,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:03:20,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:03:20,876 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:03:20,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:03:20,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:20,918 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:03:21,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:03:21,139 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:03:21,159 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:03:21,165 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:03:21,175 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:21,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:03:21,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:21,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:03:21,514 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:03:21,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:03:21,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:03:21,739 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:03:22,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:03:22,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:03:22,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:03:22,435 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:03:22,437 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:03:22,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:03:22,499 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:03:22,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:03:22,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:22,536 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:03:22,557 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:22,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:03:22,580 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:03:22,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:03:22,596 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:03:22,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:03:22,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:22,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:03:22,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:03:22,618 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:03:22,709 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:03:22,713 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:03:22,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:22,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:03:22,728 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:03:22,732 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:03:22,741 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:03:22,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:03:22,881 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:03:22,885 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:03:22,886 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:03:22,886 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:03:22,887 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:03:22,889 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:03:22,889 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:03:22,891 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:03:22,892 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:03:22,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:03:22,898 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:03:22,902 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:03:22,904 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:03:22,904 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:03:22,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:22,910 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:03:22,910 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:22,912 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:03:22,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:03:22,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:03:22,921 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:03:22,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:03:22,928 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:03:22,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:03:22,929 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:03:22,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:03:22,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:03:22,936 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:03:22,937 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:22,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:03:22,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:03:22,938 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:03:22,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:03:22,940 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:03:22,945 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:03:22,945 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:03:22,947 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:22,948 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:03:22,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:03:22,952 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:03:22,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:22,954 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:03:22,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:03:22,960 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:03:22,960 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:03:22,960 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:03:23,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:03:23,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:03:23,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:03:23,020 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:03:23,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:03:23,023 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:03:23,026 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:03:23,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:03:23,072 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:03:23,072 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:03:23,072 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,080 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:03:23,122 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:03:23,135 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:03:23,193 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:03:23,199 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:03:23,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:03:23,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:03:23,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:03:23,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,210 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:03:23,213 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,215 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:03:23,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:03:23,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:03:23,223 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,225 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:03:23,227 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,227 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:03:23,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,231 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:03:23,235 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,235 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:03:23,236 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:03:23,236 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:03:23,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:03:23,240 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:03:23,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:23,243 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:03:23,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:23,247 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:03:23,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:23,251 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:03:23,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:23,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:03:23,256 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:23,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:03:23,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:23,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:03:23,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:03:25,502 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:04:14,037 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:04:14,037 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:04:14,613 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:04:14,614 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:04:14,616 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:04:38,072 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:04:38,077 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:04:38,164 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:04:38,763 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:04:38,765 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:04:38,847 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:05:13,359 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:05:13,363 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:05:13,365 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:05:13,366 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:05:13,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:05:13,368 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:05:13,372 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:13,373 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:05:13,378 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:13,382 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:05:13,390 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:13,393 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:05:13,395 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:05:13,395 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:05:13,399 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:05:13,401 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:05:13,403 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:05:13,403 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:05:13,404 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:13,406 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:05:13,410 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:05:13,411 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:05:13,412 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:13,412 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:05:13,413 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:13,413 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:05:13,416 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:05:13,417 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:05:13,418 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:05:13,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:05:13,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:13,421 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:05:13,425 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:13,425 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:05:13,428 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:13,430 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:05:13,432 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:05:13,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:05:13,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:13,828 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:05:13,829 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:05:13,833 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:05:14,087 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:05:14,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:14,106 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:05:14,155 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:05:14,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:05:14,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:05:14,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:05:14,496 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:05:14,499 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:05:14,591 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:05:14,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:14,727 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:05:14,758 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:14,763 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:05:15,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:15,109 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:05:15,141 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:15,145 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:05:15,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:15,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:05:15,207 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:15,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:05:15,674 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:15,689 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:05:16,019 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:16,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:05:16,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:05:16,448 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:05:16,884 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:05:16,898 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:05:16,899 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:16,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:05:17,049 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:05:17,053 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:05:17,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:17,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:05:17,135 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:17,136 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:05:17,160 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:05:17,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:05:17,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:05:17,181 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:05:17,190 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:17,192 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:05:17,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:17,205 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:05:17,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:05:17,373 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:05:17,381 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:17,388 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:05:17,398 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:17,399 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:05:17,407 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:17,410 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:05:17,538 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:05:17,549 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:05:17,552 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:17,553 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:05:17,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:17,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:05:17,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:17,563 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:05:17,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:17,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:05:17,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:17,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:05:17,568 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:17,569 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:05:17,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:17,571 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:05:17,571 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:17,575 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:05:17,576 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:17,576 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:05:17,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:05:17,634 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:05:17,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:17,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:05:17,639 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:17,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:05:17,645 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:05:17,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:05:17,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:17,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:05:17,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:17,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:05:17,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:17,654 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:05:17,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:05:17,658 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:05:17,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:17,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:05:17,665 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:05:17,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:05:17,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:17,667 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:05:17,675 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:05:17,676 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:05:17,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:05:17,677 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:05:17,754 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:17,760 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:05:17,835 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:17,837 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:05:17,842 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:05:17,843 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:05:17,845 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:05:17,845 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:05:17,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:17,922 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:05:17,925 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:17,927 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:05:17,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:17,994 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:05:18,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:05:18,067 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:05:18,069 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:05:18,069 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:05:18,071 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,071 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:05:18,075 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,076 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:05:18,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:05:18,079 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,080 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:05:18,080 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,081 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:05:18,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,081 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:05:18,086 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,086 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:05:18,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,087 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:05:18,089 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,089 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:05:18,091 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:18,093 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:05:18,096 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:18,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:05:18,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:18,101 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:05:18,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:18,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:05:18,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:18,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:05:18,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:18,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:05:18,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:18,110 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:05:18,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:18,111 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:05:18,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:19,982 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:05:21,432 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:05:21,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:05:21,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:05:21,488 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:05:21,494 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:05:21,496 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:05:21,499 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:21,499 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:05:21,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:21,502 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:05:21,506 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:21,506 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:05:21,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:05:21,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:05:21,509 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:05:21,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:05:21,512 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:05:21,512 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:05:21,513 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:21,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:05:21,515 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:05:21,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:05:21,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:21,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:05:21,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:21,521 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:05:21,523 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:05:21,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:05:21,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:05:21,530 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:05:21,530 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:21,530 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:05:21,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:21,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:05:21,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:21,541 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:05:21,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:05:21,545 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:05:21,787 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:21,802 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:05:21,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:21,838 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:05:21,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:05:21,866 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:05:21,888 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:05:21,888 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:05:22,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:22,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:05:22,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:22,226 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:05:22,525 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:22,536 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:05:22,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:22,570 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:05:22,593 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:22,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:05:22,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:22,618 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:05:23,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:23,115 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:05:23,530 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:23,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:05:23,831 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:05:23,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:05:24,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:05:24,192 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:05:24,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:24,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:05:24,278 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:05:24,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:05:24,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:24,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:05:24,324 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:24,325 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:05:24,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:05:24,342 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:05:24,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:05:24,350 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:05:24,353 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:24,353 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:05:24,361 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:24,361 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:05:24,496 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:05:24,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:05:24,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:24,521 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:05:24,533 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:24,533 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:05:24,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:24,553 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:05:24,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:05:24,696 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:05:24,699 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:24,699 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:05:24,703 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:24,707 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:05:24,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:24,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:05:24,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:24,722 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:05:24,722 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:24,722 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:05:24,722 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:24,722 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:05:24,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:24,733 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:05:24,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:24,733 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:05:24,738 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:24,739 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:05:24,739 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:05:24,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:05:24,750 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:24,750 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:05:24,754 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:24,755 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:05:24,758 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:05:24,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:05:24,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:24,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:05:24,763 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:24,763 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:05:24,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:24,767 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:05:24,771 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:05:24,771 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:05:24,773 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:24,773 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:05:24,773 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:05:24,779 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:05:24,780 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:24,781 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:05:24,790 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:05:24,794 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:05:24,794 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:05:24,795 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:05:24,832 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:24,834 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:05:24,844 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:24,846 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:05:24,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:05:24,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:05:24,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:05:24,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:05:24,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:24,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:05:24,917 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:24,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:05:24,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:24,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:05:25,053 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:05:25,060 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:05:25,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:05:25,063 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:05:25,063 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,064 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:05:25,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,070 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:05:25,071 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,072 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:05:25,073 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,076 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:05:25,078 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,078 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:05:25,079 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,080 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:05:25,082 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,082 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:05:25,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:05:25,089 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,090 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:05:25,091 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:25,091 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:05:25,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:25,093 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:05:25,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:25,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:05:25,099 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:25,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:05:25,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:25,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:05:25,101 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:25,101 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:05:25,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:25,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:05:25,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:25,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:05:25,105 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:25,418 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:05:41,971 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:05:41,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:05:41,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:05:41,989 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:05:41,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:05:41,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:05:41,999 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:42,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:05:42,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:42,009 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:05:42,013 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:42,013 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:05:42,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:05:42,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:05:42,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:05:42,026 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:05:42,029 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:05:42,031 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:05:42,034 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:42,036 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:05:42,042 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:05:42,046 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:05:42,047 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:42,047 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:05:42,053 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:42,055 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:05:42,056 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:05:42,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:05:42,063 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:05:42,064 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:05:42,065 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:42,066 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:05:42,075 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:42,078 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:05:42,084 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:42,086 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:05:42,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:05:42,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:05:42,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:42,495 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:05:42,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:42,572 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:05:42,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:05:42,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:05:42,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:05:42,691 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:05:43,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:43,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:05:43,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:43,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:05:43,584 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:43,596 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:05:43,634 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:43,639 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:05:43,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:43,678 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:05:43,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:43,708 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:05:44,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:44,351 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:05:44,859 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:05:44,875 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:05:45,489 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:05:45,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:05:45,781 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:05:45,796 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:05:45,798 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:45,798 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:05:45,932 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:05:45,941 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:05:45,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:45,972 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:05:46,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:46,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:05:46,047 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:05:46,048 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:05:46,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:05:46,064 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:05:46,072 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:46,073 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:05:46,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:46,084 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:05:46,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:05:46,264 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:05:46,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:46,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:05:46,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:46,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:05:46,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:05:46,313 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:05:46,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:05:46,525 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:05:46,528 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:46,528 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:05:46,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:46,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:05:46,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:46,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:05:46,544 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:46,547 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:05:46,549 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:46,549 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:05:46,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:46,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:05:46,560 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:46,601 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:05:46,605 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:46,607 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:05:46,610 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:46,613 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:05:46,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:05:46,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:05:46,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:46,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:05:46,623 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:05:46,625 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:05:46,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:05:46,631 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:05:46,631 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:46,634 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:05:46,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:46,639 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:05:46,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:05:46,641 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:05:46,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:05:46,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:05:46,651 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:46,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:05:46,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:05:46,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:05:46,663 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:46,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:05:46,672 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:05:46,676 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:05:46,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:05:46,680 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:05:46,750 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:46,756 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:05:46,779 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:05:46,779 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:05:46,789 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:05:46,790 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:05:46,795 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:05:46,795 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:05:46,896 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:46,897 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:05:46,906 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:46,910 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:05:46,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:05:46,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:05:47,061 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:05:47,067 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:05:47,070 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:05:47,072 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:05:47,073 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:05:47,079 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:05:47,085 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:05:47,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,091 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:05:47,096 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,096 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:05:47,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:05:47,105 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:05:47,110 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,110 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:05:47,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:05:47,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:05:47,119 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:05:47,122 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:05:47,126 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:05:47,130 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:47,131 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:05:47,136 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:47,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:05:47,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:47,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:05:47,143 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:47,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:05:47,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:47,149 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:05:47,151 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:47,151 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:05:47,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:05:49,234 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:05:52,757 - nl2sql - ERROR - llm.py:66 - LLM Error: 400 The input token count exceeds the maximum number of tokens allowed (1048576).
2026-01-26 00:07:01,259 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:07:01,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:07:01,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:07:01,263 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:07:01,265 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:07:01,265 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:07:01,266 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:01,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:07:01,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:01,268 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:07:01,270 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:01,270 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:07:01,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:07:01,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:07:01,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:07:01,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:07:01,274 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:07:01,275 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:07:01,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:01,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:07:01,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:07:01,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:07:01,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:01,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:07:01,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:07:01,281 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:07:01,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:07:01,281 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:07:01,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:07:01,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:07:01,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:01,285 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:07:01,288 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:01,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:07:01,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:01,290 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:07:01,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:07:01,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:07:01,460 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:01,465 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:07:01,481 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:01,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:07:01,498 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:07:01,499 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:07:01,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:07:01,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:07:01,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:01,672 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:07:01,682 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:01,682 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:07:01,818 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:01,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:07:01,839 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:01,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:07:01,851 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:01,851 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:07:01,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:01,864 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:07:02,068 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:02,074 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:07:02,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:02,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:07:02,560 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:07:02,583 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:07:03,190 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:07:03,214 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:07:03,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:03,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:07:03,448 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:07:03,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:07:03,491 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:03,496 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:07:03,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:03,527 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:07:03,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:07:03,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:07:03,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:07:03,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:07:03,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:03,633 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:07:03,648 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:07:03,650 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:07:03,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:07:03,947 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:07:03,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:03,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:07:03,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:03,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:07:04,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:07:04,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:07:04,275 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:07:04,283 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:07:04,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:07:04,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:07:04,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:04,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:07:04,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:04,298 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:07:04,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:07:04,307 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:07:04,310 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:04,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:07:04,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:04,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:07:04,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:04,322 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:07:04,324 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:04,325 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:07:04,332 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:04,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:07:04,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:07:04,346 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:07:04,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:04,350 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:07:04,356 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:04,357 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:07:04,364 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:07:04,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:07:04,368 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:04,368 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:07:04,375 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:04,376 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:07:04,379 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:04,380 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:07:04,393 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:07:04,395 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:07:04,398 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:04,405 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:07:04,410 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:07:04,411 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:07:04,416 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:04,417 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:07:04,429 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:07:04,430 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:07:04,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:07:04,435 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:07:04,572 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:07:04,579 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:07:04,601 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:04,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:07:04,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:07:04,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:07:04,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:07:04,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:07:04,775 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:07:04,791 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:07:04,815 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:04,818 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:07:05,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:07:05,270 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:07:05,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:07:05,549 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:07:05,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:07:05,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:07:05,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:07:05,589 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:07:05,602 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:07:05,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,619 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:07:05,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,643 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:07:05,663 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,670 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:07:05,680 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,686 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:07:05,687 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,687 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:07:05,690 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,691 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:07:05,695 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:05,698 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:07:05,701 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:07:05,704 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:07:05,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:05,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:07:05,738 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:05,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:07:05,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:05,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:07:05,785 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:05,788 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:07:05,808 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:05,813 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:07:05,824 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:05,825 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:07:05,836 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:08,855 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:07:52,009 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:07:52,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:07:52,201 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:07:52,206 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:07:52,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:07:52,215 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:07:52,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:52,233 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:07:52,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:52,249 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:07:52,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:52,270 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:07:52,272 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:07:52,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:07:52,286 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:07:52,289 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:07:52,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:07:52,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:07:52,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:52,301 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:07:52,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:07:52,313 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:07:52,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:52,323 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:07:52,325 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:07:52,328 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:07:52,334 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:07:52,335 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:07:52,339 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:07:52,340 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:07:52,347 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:52,351 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:07:52,361 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:52,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:07:52,372 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:52,374 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:07:52,382 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:07:52,385 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:07:53,413 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:53,428 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:07:53,474 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:53,485 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:07:53,545 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:07:53,549 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:07:53,664 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:07:53,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:07:54,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:54,249 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:07:54,298 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:54,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:07:54,968 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:54,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:07:55,036 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:55,044 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:07:55,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:55,091 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:07:55,141 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:55,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:07:56,073 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:56,078 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:07:56,587 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:07:56,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:07:57,272 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:07:57,325 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:07:57,926 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:07:57,940 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:07:57,941 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:57,944 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:07:58,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:07:58,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:07:58,145 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:58,147 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:07:58,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:58,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:07:58,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:07:58,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:07:58,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:07:58,223 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:07:58,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:58,233 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:07:58,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:07:58,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:07:58,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:07:58,443 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:07:58,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:58,456 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:07:58,465 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:58,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:07:58,473 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:07:58,473 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:07:58,696 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:07:58,706 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:07:58,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:07:58,709 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:07:58,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:58,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:07:58,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:58,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:07:58,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:07:58,721 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:07:58,725 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:58,726 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:07:58,727 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:58,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:07:58,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:58,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:07:58,731 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:58,734 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:07:58,735 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:58,737 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:07:58,741 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:07:58,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:07:58,741 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:58,750 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:07:58,752 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:07:58,752 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:07:58,758 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:07:58,759 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:07:58,761 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:58,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:07:58,763 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:58,764 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:07:58,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:07:58,767 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:58,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:07:58,795 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:07:58,796 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:07:58,798 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:07:58,798 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:07:58,934 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:07:58,941 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:07:58,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:07:58,975 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:07:58,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:07:58,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:07:58,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:07:58,996 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:07:59,178 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:07:59,181 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:07:59,181 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,188 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:07:59,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:07:59,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:07:59,388 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:07:59,397 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:07:59,399 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:07:59,400 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:07:59,401 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,402 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:07:59,403 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,404 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:07:59,405 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,405 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:07:59,407 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,407 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:07:59,410 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,410 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:07:59,411 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,412 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:07:59,415 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,416 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:07:59,417 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,418 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:07:59,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,420 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:07:59,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:07:59,420 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:07:59,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:07:59,420 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:07:59,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:59,431 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:07:59,432 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:59,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:07:59,435 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:59,435 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:07:59,437 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:59,438 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:07:59,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:59,441 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:07:59,441 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:07:59,443 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:07:59,444 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:00,679 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:08:00,681 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:08:00,773 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:08:00,858 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:08:00,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:08:00,862 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:08:00,862 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:08:00,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:08:00,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:08:00,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:00,866 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:08:00,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:00,868 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:08:00,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:00,872 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:08:00,874 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:08:00,874 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:08:00,876 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:08:00,877 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:08:00,877 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:08:00,877 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:08:00,879 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:00,879 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:08:00,882 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:08:00,882 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:08:00,883 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:00,883 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:08:00,884 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:08:00,884 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:08:00,885 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:08:00,885 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:08:00,886 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:08:00,886 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:08:00,888 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:00,888 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:08:00,892 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:00,893 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:08:00,896 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:00,896 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:08:00,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:08:00,898 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:08:00,977 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:08:01,136 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:01,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:08:01,161 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:08:01,162 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 00:08:01,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:01,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:08:01,217 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:08:01,217 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:08:01,244 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:08:01,244 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:08:01,814 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:01,830 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:08:01,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:01,871 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:08:02,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:02,452 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:08:02,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:02,515 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:08:02,551 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:02,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:08:02,589 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:02,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:08:03,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:03,674 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:08:04,633 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:04,646 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:08:05,731 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:08:05,748 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:08:06,723 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:08:06,755 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:08:06,763 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:06,767 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:08:07,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:08:07,036 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:08:07,073 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:07,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:08:07,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:07,113 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:08:07,157 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:08:07,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:08:07,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:08:07,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:08:07,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:07,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:08:07,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:08:07,213 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:08:07,585 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:08:07,596 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:08:07,613 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:07,621 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:08:07,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:07,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:08:07,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:08:07,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:08:08,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:08:08,019 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:08:08,024 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:08:08,026 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:08:08,030 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:08,033 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:08:08,041 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:08,045 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:08:08,051 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:08:08,051 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:08:08,056 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:08,060 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:08:08,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:08,070 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:08:08,074 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:08:08,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,082 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:08:08,085 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:08,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:08:08,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:08:08,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:08:08,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:08,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:08:08,120 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:08,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:08:08,127 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:08:08,129 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:08:08,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:08,131 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:08:08,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:08,140 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:08:08,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:08,150 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:08:08,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:08:08,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:08:08,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:08:08,178 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:08:08,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:08:08,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,186 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:08:08,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:08:08,205 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:08:08,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:08:08,210 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:08:08,359 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:08:08,369 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:08:08,390 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:08,399 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:08:08,408 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:08:08,409 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:08:08,417 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:08:08,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:08:08,556 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:08:08,559 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:08:08,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,575 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:08:08,769 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:08:08,776 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:08:08,890 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:08:08,898 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:08:08,898 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:08:08,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:08:08,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:08:08,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,915 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:08:08,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,923 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:08:08,924 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,925 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:08:08,927 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:08:08,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,936 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:08:08,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,942 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:08:08,948 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,949 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:08:08,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,954 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:08:08,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:08,962 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:08:08,963 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:08:08,964 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:08:08,967 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:08,969 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:08:08,973 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:08,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:08:08,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:08,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:08:08,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:08,984 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:08:08,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:08,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:08:08,993 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:08,994 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:08:09,000 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:10,906 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:08:43,924 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:08:43,952 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:08:43,960 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:08:43,961 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:08:43,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:08:43,963 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:08:43,965 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:43,966 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:08:43,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:43,970 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:08:43,974 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:43,975 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:08:43,975 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:08:43,975 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:08:43,978 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:08:43,979 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:08:43,980 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:08:43,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:08:43,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:43,982 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:08:43,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:08:43,985 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:08:43,985 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:43,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:08:43,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:08:43,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:08:43,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:08:43,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:08:43,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:08:43,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:08:43,989 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:43,989 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:08:43,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:43,993 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:08:43,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:43,997 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:08:43,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:08:43,998 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:08:44,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:44,189 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:08:44,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:44,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:08:44,257 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:08:44,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:08:44,299 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:08:44,301 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:08:45,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:45,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:08:45,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:45,261 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:08:45,928 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:45,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:08:45,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:46,005 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:08:46,063 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:46,063 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:08:46,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:46,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:08:47,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:47,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:08:47,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:08:48,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:08:48,616 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-26 00:08:48,873 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:08:48,899 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:08:49,464 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:08:49,484 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:08:49,490 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:49,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:08:49,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:08:49,676 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:08:49,709 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:49,714 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:08:49,742 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:49,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:08:49,814 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:08:49,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:08:49,835 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:08:49,838 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:08:49,850 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:49,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:08:49,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:08:49,869 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:08:50,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:08:50,210 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:08:50,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:50,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:08:50,244 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:50,246 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:08:50,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:08:50,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:08:50,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:08:50,545 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:08:50,548 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:08:50,552 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:08:50,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:50,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:08:50,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:50,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:08:50,563 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:08:50,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:08:50,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:50,570 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:08:50,571 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:50,571 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:08:50,575 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:50,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:08:50,579 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:50,581 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:08:50,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:50,590 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:08:50,595 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:08:50,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:08:50,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:50,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:08:50,605 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:08:50,607 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:08:50,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:08:50,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:08:50,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:50,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:08:50,619 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:50,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:08:50,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:08:50,623 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:08:50,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:08:50,635 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:08:50,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:50,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:08:50,642 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:08:50,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:08:50,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:50,648 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:08:50,659 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:08:50,661 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:08:50,663 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:08:50,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:08:50,753 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:08:50,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:08:50,781 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:08:50,786 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:08:50,793 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:08:50,794 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:08:50,801 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:08:50,803 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:08:50,976 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:08:50,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:08:50,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,000 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:08:51,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:08:51,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:08:51,393 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:08:51,400 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:08:51,403 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:08:51,405 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:08:51,413 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,420 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:08:51,435 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,468 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:08:51,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,483 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:08:51,487 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:08:51,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:08:51,496 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,499 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:08:51,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:08:51,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,533 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:08:51,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,545 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:08:51,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:08:51,549 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:08:51,556 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:08:51,559 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:08:51,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:51,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:08:51,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:51,570 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:08:51,585 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:51,587 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:08:51,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:51,611 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:08:51,624 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:51,626 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:08:51,634 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:51,635 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:08:51,639 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:08:55,344 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:08:56,858 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:08:57,890 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "country": ...
2026-01-26 00:08:57,890 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'country': 'UNITED STATES', 'kyc_status': 'PENDING'}
2026-01-26 00:08:58,422 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:08:59,088 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "instrument...
2026-01-26 00:08:59,089 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'instrument_traded': 'BTC/USD'}
2026-01-26 00:08:59,382 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:09:00,259 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "country": ...
2026-01-26 00:09:00,259 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'country': 'DE', 'login_status': 'FAILED'}
2026-01-26 00:09:00,547 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:09:01,304 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_asses...
2026-01-26 00:09:01,305 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_assessment.level': 'HIGH'}
2026-01-26 00:09:01,772 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:09:02,621 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-26 00:09:02,622 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'kyc_status': 'VERIFIED', 'country': 'DE'}
2026-01-26 00:09:02,938 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:09:03,666 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "country": ...
2026-01-26 00:09:03,667 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'country': 'USA'}
2026-01-26 00:09:03,917 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:09:04,730 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "status": "...
2026-01-26 00:09:04,730 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'status': 'COMPLETED'}
2026-01-26 00:11:57,128 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:11:57,204 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:11:57,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:11:57,210 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:11:57,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:11:57,211 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:11:57,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:57,231 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:11:57,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:57,237 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:11:57,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:57,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:11:57,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:11:57,243 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:11:57,247 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:11:57,248 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:11:57,249 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:11:57,249 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:11:57,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:11:57,250 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:11:57,252 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:11:57,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:11:57,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:57,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:11:57,255 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:11:57,256 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:11:57,256 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:11:57,257 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:11:57,257 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:11:57,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:11:57,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:11:57,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:11:57,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:57,261 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:11:57,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:57,263 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:11:57,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:11:57,264 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:11:57,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:11:57,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:11:57,501 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:57,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:11:57,516 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:11:57,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:11:57,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:11:57,526 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:11:57,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:11:57,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:11:57,682 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:57,682 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:11:57,818 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:11:57,824 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:11:57,834 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:11:57,838 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:11:57,849 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:57,849 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:11:57,858 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:57,858 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:11:58,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:11:58,038 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:11:58,490 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:11:58,506 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:11:58,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:11:58,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:11:58,850 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:11:58,853 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:11:58,860 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:11:58,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:11:58,975 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:11:58,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:11:59,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:59,009 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:11:59,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:59,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:11:59,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:11:59,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:11:59,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:11:59,038 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:11:59,042 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,043 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:11:59,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:11:59,045 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:11:59,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:11:59,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:11:59,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,109 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:11:59,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:11:59,114 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:11:59,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:11:59,119 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:11:59,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:11:59,167 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:11:59,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:11:59,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:11:59,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:11:59,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:11:59,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:11:59,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:11:59,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:11:59,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:11:59,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:11:59,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:11:59,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:11:59,184 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:11:59,184 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,184 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:11:59,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,186 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:11:59,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:11:59,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:11:59,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:11:59,190 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:11:59,190 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:11:59,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:11:59,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:11:59,192 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:11:59,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:11:59,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:11:59,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:11:59,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:11:59,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:11:59,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:11:59,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:11:59,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:11:59,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:11:59,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,201 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:11:59,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:11:59,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:11:59,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,204 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:11:59,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:11:59,207 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:11:59,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:11:59,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:11:59,244 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:11:59,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:11:59,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:11:59,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:11:59,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:11:59,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:11:59,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:11:59,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:11:59,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:11:59,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:11:59,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:11:59,335 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:11:59,338 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:11:59,364 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:11:59,367 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:11:59,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:11:59,367 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:11:59,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,367 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:11:59,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,371 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:11:59,373 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,373 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:11:59,374 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,374 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:11:59,375 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,376 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:11:59,377 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,377 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:11:59,379 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,379 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:11:59,380 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,380 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:11:59,382 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,383 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:11:59,383 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:11:59,383 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:11:59,388 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:11:59,388 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:11:59,390 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,390 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:11:59,391 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,391 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:11:59,391 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,393 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:11:59,393 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,393 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:11:59,394 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,394 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:11:59,395 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:11:59,395 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:11:59,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:12:00,032 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:13:22,487 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:13:22,523 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:13:22,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:13:22,526 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:13:22,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:13:22,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:13:22,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:22,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:13:22,548 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:22,549 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:13:22,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:22,556 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:13:22,557 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:13:22,559 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:13:22,561 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:13:22,561 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:13:22,563 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:13:22,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:13:22,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:13:22,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:13:22,570 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:13:22,571 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:13:22,573 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:22,574 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:13:22,574 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:13:22,574 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:13:22,574 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:13:22,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:13:22,579 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:13:22,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:13:22,581 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:13:22,581 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:13:22,585 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:22,586 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:13:22,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:22,590 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:13:22,593 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:13:22,593 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:13:22,838 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:13:22,854 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:13:22,889 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:22,889 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:13:22,918 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:13:22,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:13:22,937 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:13:22,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:13:23,227 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:13:23,227 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:13:23,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:23,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:13:23,538 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:13:23,557 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:13:23,576 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:13:23,576 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:13:23,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:23,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:13:23,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:23,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:13:23,853 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:13:23,862 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:13:24,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:13:24,181 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:13:24,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:13:24,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:13:24,780 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:13:24,794 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:13:24,796 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:13:24,797 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:13:24,923 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:13:24,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:13:24,954 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:24,956 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:13:24,972 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:24,972 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:13:24,996 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:13:24,997 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:13:25,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:13:25,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:13:25,010 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,011 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:13:25,019 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:13:25,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:13:25,156 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:13:25,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:13:25,168 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:13:25,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:13:25,173 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:13:25,185 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:13:25,185 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:13:25,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:13:25,323 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:13:25,326 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:13:25,327 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:13:25,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:13:25,330 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:13:25,332 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:13:25,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:13:25,335 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:13:25,336 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:13:25,337 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:13:25,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:13:25,339 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:13:25,339 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:13:25,339 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,342 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:13:25,342 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,342 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:13:25,346 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:13:25,346 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:13:25,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:13:25,351 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:13:25,354 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:13:25,354 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:13:25,355 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:13:25,356 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:13:25,358 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:13:25,358 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:13:25,359 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,361 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:13:25,362 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:13:25,363 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:13:25,364 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:13:25,365 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:13:25,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:13:25,367 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:13:25,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,367 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:13:25,372 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:13:25,373 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:13:25,374 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,375 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:13:25,380 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:13:25,380 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:13:25,382 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:13:25,382 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:13:25,426 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:13:25,426 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:13:25,446 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:13:25,448 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:13:25,449 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:13:25,449 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:13:25,455 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:13:25,455 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:13:25,520 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:13:25,522 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:13:25,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:13:25,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:13:25,597 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:13:25,628 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:13:25,628 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:13:25,628 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:13:25,628 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:13:25,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:13:25,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:13:25,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,639 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:13:25,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:13:25,641 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:13:25,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,643 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:13:25,645 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:13:25,646 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,646 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:13:25,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:13:25,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:13:25,648 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:13:25,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:13:25,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:13:25,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:13:25,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:13:25,653 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:13:25,653 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:13:25,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:13:25,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:25,657 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:13:25,657 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:13:26,575 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:15:18,288 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:15:18,385 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:15:18,407 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:15:18,408 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:15:18,412 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:15:18,413 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:15:18,423 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:18,425 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:15:18,435 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:18,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:15:18,448 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:18,450 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:15:18,454 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:15:18,454 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:15:18,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:15:18,464 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:15:18,467 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:15:18,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:15:18,475 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:18,476 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:15:18,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:15:18,484 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:15:18,487 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:18,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:15:18,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:15:18,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:15:18,494 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:15:18,495 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:15:18,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:15:18,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:15:18,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:18,502 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:15:18,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:18,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:15:18,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:18,517 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:15:18,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:15:18,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:15:18,882 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:18,893 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:15:18,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:19,000 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:15:19,039 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:15:19,039 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:15:19,060 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:15:19,061 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:15:19,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:19,536 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:15:19,577 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:19,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:15:20,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:20,106 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:15:20,128 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:20,130 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:15:20,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:20,156 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:15:20,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:20,183 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:15:20,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:20,738 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:15:21,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:21,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:15:21,818 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:15:21,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:15:22,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:15:22,288 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:15:22,288 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:22,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:15:22,417 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:15:22,424 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:15:22,444 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:22,447 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:15:22,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:22,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:15:22,532 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:15:22,534 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:15:22,556 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:15:22,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:15:22,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:22,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:15:22,580 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:15:22,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:15:22,754 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:15:22,758 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:15:22,758 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:22,766 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:15:22,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:22,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:15:22,780 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:15:22,780 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:15:22,967 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:15:22,974 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:15:22,977 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:15:22,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:15:22,980 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:22,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:15:22,984 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:22,984 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:15:22,984 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:15:22,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:15:22,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:22,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:15:22,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:22,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:15:22,993 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:22,993 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:15:22,996 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:22,996 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:15:22,996 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:22,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:15:23,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:15:23,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:15:23,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:23,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:15:23,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:23,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:15:23,012 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:15:23,015 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:15:23,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:23,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:15:23,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:23,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:15:23,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:23,023 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:15:23,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:15:23,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:15:23,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:15:23,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:15:23,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:15:23,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:15:23,047 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:15:23,047 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:15:23,053 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:15:23,054 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:15:23,110 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:15:23,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:15:23,136 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:23,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:15:23,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:15:23,145 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:15:23,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:15:23,155 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:15:23,279 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:15:23,281 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:15:23,284 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,286 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:15:23,357 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:15:23,360 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:15:23,430 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:15:23,434 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:15:23,435 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:15:23,435 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:15:23,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:15:23,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,439 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:15:23,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,440 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:15:23,442 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,442 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:15:23,443 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,445 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:15:23,445 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:15:23,447 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,448 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:15:23,449 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,450 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:15:23,450 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,451 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:15:23,452 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:23,452 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:15:23,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:15:23,455 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:15:23,456 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:23,457 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:15:23,459 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:23,460 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:15:23,461 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:23,461 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:15:23,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:23,463 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:15:23,464 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:23,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:15:23,467 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:23,467 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:15:23,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:24,531 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:15:24,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:15:24,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:15:24,657 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:15:24,660 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:15:24,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:15:24,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:24,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:15:24,674 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:24,676 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:15:24,683 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:24,685 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:15:24,686 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:15:24,687 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:15:24,691 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:15:24,693 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:15:24,694 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:15:24,695 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:15:24,697 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:24,698 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:15:24,701 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:15:24,703 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:15:24,704 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:24,704 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:15:24,705 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:15:24,706 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:15:24,709 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:15:24,709 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:15:24,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:15:24,711 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:15:24,713 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:24,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:15:24,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:24,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:15:24,744 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:24,744 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:15:24,748 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:15:24,758 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:15:25,097 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:15:25,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:25,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:15:25,278 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:25,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:15:25,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:15:25,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:15:25,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:15:25,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:15:25,783 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:25,797 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:15:25,824 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:25,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:15:26,448 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:26,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:15:26,487 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:26,490 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:15:26,514 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:26,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:15:26,539 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:26,540 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:15:27,059 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:27,071 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:15:27,514 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:15:27,531 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:15:28,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:15:28,043 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:15:28,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:15:28,451 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:15:28,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:28,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:15:28,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:15:28,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:15:28,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:28,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:15:28,624 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:28,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:15:28,690 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:15:28,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:15:28,700 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:15:28,702 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:15:28,709 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:28,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:15:28,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:15:28,724 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:15:28,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:15:28,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:15:28,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:28,994 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:15:29,010 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:29,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:15:29,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:15:29,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:15:29,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:15:29,215 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:15:29,218 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:15:29,220 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:15:29,223 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:29,227 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:15:29,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:29,231 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:15:29,233 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:15:29,233 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:15:29,237 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:29,239 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:15:29,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:29,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:15:29,246 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,247 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:15:29,251 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,252 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:15:29,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:29,255 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:15:29,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:15:29,265 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:15:29,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:29,268 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:15:29,270 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:15:29,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:15:29,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:15:29,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:15:29,279 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:29,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:15:29,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:29,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:15:29,285 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:15:29,286 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:15:29,293 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:15:29,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:15:29,295 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:15:29,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:15:29,300 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:15:29,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:15:29,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:15:29,309 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:15:29,310 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:15:29,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:15:29,375 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:15:29,377 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:15:29,392 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:15:29,395 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:15:29,398 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:15:29,400 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:15:29,404 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:15:29,404 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:15:29,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:15:29,491 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:15:29,491 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,491 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:15:29,591 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:15:29,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:15:29,674 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:15:29,684 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:15:29,684 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:15:29,684 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:15:29,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,689 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:15:29,691 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,691 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:15:29,694 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,694 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:15:29,696 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,696 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:15:29,698 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,699 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:15:29,699 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,699 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:15:29,703 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,703 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:15:29,706 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,707 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:15:29,709 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,709 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:15:29,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:15:29,712 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:15:29,715 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:15:29,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:15:29,717 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:29,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:15:29,719 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:29,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:15:29,724 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:29,725 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:15:29,726 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:29,728 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:15:29,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:29,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:15:29,732 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:29,732 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:15:29,732 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:15:30,114 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:17:03,236 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:17:03,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:17:03,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:17:03,282 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:17:03,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:17:03,284 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:17:03,286 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:03,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:17:03,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:03,291 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:17:03,293 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:03,293 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:17:03,295 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:17:03,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:17:03,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:17:03,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:17:03,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:17:03,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:17:03,298 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:03,298 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:17:03,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:17:03,301 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:17:03,302 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:03,303 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:17:03,303 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:17:03,303 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:17:03,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:17:03,304 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:17:03,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:17:03,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:17:03,306 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:03,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:17:03,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:03,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:17:03,310 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:03,310 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:17:03,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:17:03,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:17:03,408 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:17:03,420 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:17:03,445 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:03,448 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:17:03,466 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:17:03,467 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:17:03,484 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:17:03,484 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:17:03,683 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:17:03,687 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:17:03,699 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:03,703 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:17:03,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:17:03,856 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:17:03,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:03,872 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:17:03,889 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:03,890 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:17:03,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:03,908 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:17:04,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:17:04,105 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:17:04,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:17:04,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:17:04,583 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:17:04,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:17:04,810 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:17:04,822 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:17:04,825 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:17:04,825 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:17:04,889 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:17:04,893 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:17:04,916 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:04,918 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:17:04,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:04,939 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:17:04,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:17:04,968 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:17:04,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:17:04,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:17:04,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:04,993 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:17:05,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:17:05,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:17:05,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:17:05,122 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:17:05,127 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,130 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:17:05,136 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:05,136 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:17:05,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:17:05,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:17:05,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:17:05,233 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:17:05,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:17:05,234 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:17:05,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:17:05,237 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:17:05,237 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:17:05,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:17:05,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:17:05,241 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:17:05,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:17:05,244 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:17:05,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:05,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:17:05,247 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,249 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:17:05,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,250 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:17:05,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:17:05,251 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:17:05,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:17:05,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:17:05,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:17:05,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:17:05,255 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:17:05,255 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:17:05,257 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:17:05,257 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:17:05,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:05,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:17:05,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:05,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:17:05,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:05,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:17:05,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:17:05,263 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:17:05,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,263 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:17:05,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:17:05,264 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:17:05,265 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:17:05,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:17:05,268 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:17:05,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:17:05,268 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:17:05,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:17:05,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:17:05,295 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:05,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:17:05,306 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:17:05,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:17:05,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:17:05,309 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:17:05,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:17:05,346 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:17:05,348 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,349 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:17:05,371 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:17:05,371 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:17:05,410 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:17:05,410 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:17:05,417 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:17:05,417 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:17:05,424 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,425 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:17:05,425 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,425 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:17:05,427 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,427 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:17:05,428 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,428 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:17:05,430 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,430 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:17:05,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,431 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:17:05,432 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:17:05,433 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:17:05,434 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,434 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:17:05,435 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:17:05,435 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:17:05,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:17:05,436 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:17:05,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:05,436 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:17:05,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:05,438 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:17:05,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:05,439 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:17:05,439 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:05,439 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:17:05,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:05,440 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:17:05,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:05,441 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:17:05,441 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:06,484 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:17:59,480 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:17:59,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:17:59,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:17:59,573 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:17:59,574 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:17:59,574 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:17:59,577 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:59,578 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:17:59,581 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:59,582 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:17:59,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:59,590 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:17:59,591 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:17:59,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:17:59,595 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:17:59,596 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:17:59,597 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:17:59,597 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:17:59,598 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:59,598 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:17:59,601 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:17:59,601 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:17:59,601 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:17:59,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:17:59,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:17:59,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:17:59,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:17:59,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:17:59,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:17:59,610 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:17:59,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:17:59,611 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:17:59,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:59,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:17:59,619 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:59,623 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:17:59,624 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:17:59,624 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:17:59,744 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:17:59,744 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:17:59,767 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:17:59,767 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:17:59,789 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:17:59,790 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:17:59,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:17:59,806 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:18:00,042 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:00,051 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:18:00,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:00,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:18:00,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:00,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:18:00,310 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:00,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:18:00,325 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:00,325 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:18:00,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:00,341 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:18:00,556 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:00,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:18:01,091 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:01,105 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:18:01,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:18:01,327 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:18:01,461 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:18:01,468 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:18:01,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:01,468 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:18:01,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:18:01,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:18:01,527 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:01,527 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:18:01,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:01,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:18:01,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:18:01,546 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:18:01,557 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:18:01,557 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:18:01,561 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:01,561 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:18:01,565 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:01,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:18:01,623 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:18:01,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:18:01,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:01,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:18:01,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:01,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:18:01,681 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:01,683 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:18:01,828 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:18:01,833 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:18:01,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:01,837 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:18:01,839 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:01,840 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:18:01,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:01,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:18:01,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:01,842 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:18:01,843 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:01,843 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:18:01,844 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:01,844 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:18:01,844 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:01,844 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:18:01,845 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:01,845 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:18:01,846 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:01,846 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:18:01,849 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:18:01,849 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:18:01,850 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:01,851 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:18:01,852 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:01,852 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:18:01,854 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:18:01,854 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:18:01,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:01,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:18:01,857 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:01,857 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:18:01,858 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:01,858 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:18:01,860 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:18:01,860 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:18:01,861 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:01,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:18:01,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:18:01,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:18:01,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:01,865 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:18:01,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:18:01,866 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:18:01,867 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:18:01,867 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:18:01,887 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:01,887 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:18:01,900 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:01,902 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:18:01,904 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:18:01,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:18:01,906 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:18:01,907 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:18:01,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:01,938 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:18:01,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:01,938 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:18:01,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:01,975 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:18:02,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:18:02,003 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:18:02,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:18:02,003 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:18:02,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:18:02,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,011 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:18:02,012 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,013 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:18:02,013 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,014 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:18:02,014 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,014 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:18:02,015 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,015 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:18:02,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:18:02,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:18:02,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:18:02,019 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:02,019 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:18:02,019 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:02,020 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:18:02,020 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:02,020 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:18:02,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:02,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:18:02,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:03,044 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:18:08,550 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:18:08,624 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:18:08,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:18:08,633 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:18:08,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:18:08,635 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:18:08,639 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:08,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:18:08,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:08,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:18:08,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:08,677 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:18:08,682 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:18:08,682 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:18:08,686 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:18:08,686 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:18:08,687 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:18:08,688 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:18:08,689 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:08,689 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:18:08,691 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:18:08,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:18:08,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:08,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:18:08,693 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:08,694 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:18:08,695 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:18:08,697 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:18:08,698 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:18:08,699 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:18:08,700 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:08,700 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:18:08,704 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:08,704 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:18:08,707 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:08,708 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:18:08,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:18:08,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:18:08,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:08,850 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:18:08,876 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:08,879 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:18:08,893 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:18:08,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:18:08,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:18:08,907 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:18:09,092 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:09,096 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:18:09,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:09,111 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:18:09,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:09,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:18:09,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:09,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:18:09,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:09,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:18:09,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:09,304 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:18:09,487 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:09,493 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:18:09,668 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:09,684 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:18:09,900 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:18:09,908 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:18:10,054 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:18:10,058 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:18:10,058 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:10,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:18:10,107 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:18:10,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:18:10,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:10,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:18:10,128 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:10,128 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:18:10,143 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:18:10,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:18:10,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:18:10,148 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:18:10,156 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:18:10,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:10,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:18:10,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:18:10,246 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:18:10,248 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,248 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:18:10,257 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:10,257 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:18:10,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:10,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:10,318 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:18:10,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:10,329 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:18:10,329 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:10,331 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:18:10,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:10,332 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:18:10,333 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,335 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:18:10,335 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,335 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:18:10,336 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:10,336 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:18:10,338 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:18:10,339 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:18:10,339 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:10,339 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:18:10,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:10,341 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:18:10,342 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:18:10,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:18:10,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:18:10,344 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:10,344 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:18:10,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:10,345 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:18:10,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:18:10,345 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:18:10,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,345 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:18:10,350 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:18:10,350 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:18:10,352 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,354 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:18:10,369 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:18:10,369 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:18:10,382 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:18:10,383 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:18:10,459 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:10,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:18:10,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:10,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:18:10,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:18:10,482 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:18:10,485 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:18:10,485 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:18:10,532 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:10,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:18:10,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:18:10,575 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:10,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:18:10,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:18:10,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,615 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:18:10,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:18:10,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:18:10,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:18:10,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,618 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:18:10,619 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,619 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:18:10,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,625 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:18:10,625 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,625 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:18:10,625 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:10,625 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:18:10,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:11,246 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:18:49,107 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:18:49,130 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:18:49,133 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:18:49,133 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:18:49,136 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:18:49,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:18:49,141 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:49,141 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:18:49,145 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:49,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:18:49,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:49,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:18:49,157 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:18:49,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:18:49,159 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:18:49,161 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:18:49,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:18:49,166 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:18:49,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:49,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:18:49,175 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:18:49,176 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:18:49,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:49,185 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:18:49,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:49,189 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:18:49,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:18:49,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:18:49,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:18:49,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:18:49,193 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:49,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:18:49,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:49,200 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:18:49,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:49,205 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:18:49,207 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:18:49,207 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:18:49,373 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:49,384 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:18:49,416 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:49,423 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:18:49,445 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:18:49,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:18:49,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:18:49,462 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:18:49,659 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:49,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:18:49,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:49,681 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:18:49,889 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:49,897 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:18:49,916 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:49,919 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:18:49,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:49,934 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:18:49,951 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:49,952 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:18:50,373 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:50,391 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:18:50,631 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:18:50,641 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:18:50,846 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:18:50,857 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:18:51,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:18:51,027 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:18:51,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:51,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:18:51,074 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:18:51,074 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:18:51,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:51,090 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:18:51,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:51,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:18:51,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:18:51,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:18:51,121 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:18:51,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:18:51,121 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:18:51,127 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:51,127 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:18:51,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:18:51,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:18:51,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,216 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:18:51,218 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:51,218 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:18:51,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:18:51,230 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:18:51,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:18:51,335 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:18:51,336 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:51,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:18:51,337 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:51,338 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:18:51,340 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:51,340 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:18:51,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:51,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:18:51,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:51,345 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:18:51,346 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:51,346 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:18:51,347 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,347 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:18:51,348 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,348 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:18:51,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:51,349 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:18:51,351 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:18:51,351 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:18:51,352 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:51,352 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:18:51,353 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:18:51,353 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:18:51,356 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:18:51,356 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:18:51,357 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,357 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:18:51,358 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:51,358 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:18:51,358 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:18:51,361 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:18:51,364 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:18:51,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:18:51,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:18:51,368 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:18:51,369 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:18:51,370 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,370 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:18:51,374 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:18:51,376 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:18:51,378 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:18:51,378 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:18:51,420 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:51,423 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:18:51,429 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:18:51,429 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:18:51,432 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:18:51,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:18:51,440 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:18:51,440 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:18:51,486 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:51,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:18:51,490 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,495 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:18:51,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:18:51,536 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:18:51,574 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:18:51,579 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:18:51,579 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:18:51,579 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:18:51,581 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,583 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:18:51,586 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,586 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:18:51,586 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,587 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:18:51,587 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,587 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:18:51,589 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,590 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:18:51,592 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:18:51,597 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,597 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:18:51,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,602 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:18:51,604 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:18:51,604 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:18:51,604 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:18:51,605 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:18:51,606 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:18:51,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,610 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:18:51,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:18:51,613 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,613 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:18:51,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:18:51,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:18:51,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:51,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:18:51,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:18:52,504 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:21:55,456 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:21:55,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:21:55,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:21:55,469 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:21:55,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:21:55,477 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:21:55,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:55,485 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:21:55,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:55,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:21:55,501 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:55,501 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:21:55,501 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:21:55,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:21:55,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:21:55,512 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:21:55,512 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:21:55,514 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:21:55,514 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:21:55,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:21:55,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:21:55,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:21:55,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:21:55,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:21:55,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:21:55,527 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:21:55,527 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:21:55,527 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:21:55,527 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:21:55,532 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:21:55,532 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:21:55,532 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:21:55,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:55,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:21:55,550 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:55,551 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:21:55,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:21:55,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:21:55,876 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:21:55,892 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:21:55,944 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:55,948 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:21:55,976 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:21:55,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:21:56,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:21:56,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:21:56,577 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:21:56,593 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:21:56,628 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:21:56,633 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:21:57,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:21:57,130 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:21:57,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:21:57,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:21:57,239 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:21:57,240 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:21:57,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:21:57,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:21:57,856 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:21:57,871 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:21:58,400 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:21:58,408 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:21:58,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:21:58,970 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:21:59,378 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:21:59,396 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:21:59,398 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:21:59,399 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:21:59,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:21:59,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:21:59,587 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:59,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:21:59,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:21:59,618 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:21:59,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:21:59,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:21:59,668 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:21:59,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:21:59,676 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:21:59,676 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:21:59,690 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:21:59,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:21:59,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:21:59,896 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:21:59,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:21:59,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:21:59,921 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:21:59,923 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:21:59,932 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:21:59,932 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:22:00,136 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:22:00,144 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:22:00,146 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:22:00,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:22:00,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:22:00,151 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:22:00,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:22:00,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:22:00,155 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:22:00,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:22:00,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:22:00,160 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:22:00,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:22:00,164 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:22:00,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,166 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:22:00,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,168 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:22:00,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:22:00,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:22:00,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:22:00,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:22:00,181 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:22:00,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:22:00,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:22:00,184 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:22:00,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:22:00,189 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:22:00,190 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:00,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:22:00,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:22:00,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:22:00,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:22:00,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:22:00,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:22:00,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:22:00,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,204 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:22:00,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:22:00,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:22:00,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,211 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:22:00,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:22:00,216 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:22:00,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:22:00,220 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:22:00,286 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:22:00,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:22:00,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:22:00,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:22:00,310 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:22:00,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:22:00,314 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:22:00,316 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:22:00,387 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:22:00,387 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:22:00,401 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,403 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:22:00,505 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:22:00,509 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:22:00,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:22:00,622 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:22:00,624 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:22:00,626 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:22:00,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,628 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:22:00,629 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:22:00,633 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,634 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:22:00,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:22:00,639 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:22:00,641 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,641 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:22:00,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,643 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:22:00,645 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:22:00,646 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:22:00,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:22:00,650 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:22:00,651 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:22:00,651 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:22:00,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:00,654 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:22:00,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:00,657 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:22:00,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:00,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:22:00,660 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:00,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:22:00,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:00,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:22:00,664 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:00,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:22:00,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:22:02,323 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:23:26,226 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:23:26,241 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:23:26,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:23:26,243 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:23:26,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:23:26,243 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:23:26,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:26,255 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:23:26,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:26,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:23:26,270 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:26,274 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:23:26,274 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:23:26,274 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:23:26,284 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:23:26,284 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:23:26,284 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:23:26,284 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:23:26,288 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:23:26,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:23:26,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:23:26,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:23:26,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:26,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:23:26,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:23:26,303 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:23:26,303 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:23:26,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:23:26,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:23:26,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:23:26,310 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:23:26,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:23:26,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:26,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:23:26,323 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:26,323 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:23:26,323 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:23:26,323 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:23:26,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:23:26,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:23:26,787 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:26,787 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:23:26,812 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:23:26,814 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:23:26,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:23:26,837 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:23:27,337 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:23:27,369 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:23:27,388 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:27,403 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:23:27,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:23:27,969 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:23:28,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:23:28,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:23:28,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:28,023 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:23:28,066 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:28,066 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:23:28,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:23:28,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:23:29,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:23:29,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:23:30,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:23:30,227 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:23:30,628 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:23:30,642 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:23:30,642 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:23:30,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:23:30,769 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:23:30,769 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:23:30,801 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:30,803 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:23:30,832 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:30,832 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:23:30,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:23:30,864 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:23:30,882 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:23:30,883 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:23:30,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:30,892 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:23:30,904 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:23:30,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:23:31,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:23:31,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:23:31,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:31,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:23:31,181 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:23:31,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:23:31,193 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:23:31,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:23:31,479 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:23:31,488 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:23:31,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:23:31,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:23:31,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:23:31,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:23:31,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:23:31,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:23:31,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:23:31,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:23:31,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:23:31,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:23:31,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:23:31,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:23:31,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:31,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:23:31,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:31,508 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:23:31,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:23:31,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:23:31,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:23:31,519 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:23:31,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:23:31,521 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:23:31,523 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:23:31,523 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:23:31,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:23:31,531 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:23:31,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:31,531 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:23:31,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:23:31,531 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:23:31,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:23:31,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:23:31,549 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:23:31,549 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:23:31,551 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:31,551 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:23:31,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:23:31,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:23:31,561 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:31,561 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:23:31,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:23:31,567 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:23:31,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:23:31,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:23:31,685 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:23:31,687 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:23:31,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:23:31,708 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:23:31,717 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:23:31,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:23:31,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:23:31,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:23:31,859 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:23:31,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:23:31,867 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:31,870 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:23:31,985 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:23:31,989 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:23:32,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:23:32,117 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:23:32,126 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:23:32,127 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:23:32,129 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,130 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:23:32,132 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,133 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:23:32,134 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,135 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:23:32,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:23:32,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,139 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:23:32,140 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,141 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:23:32,142 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,143 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:23:32,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:23:32,145 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:23:32,147 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:23:32,148 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:23:32,149 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:23:32,150 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:23:32,151 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:32,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:23:32,153 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:32,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:23:32,155 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:32,156 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:23:32,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:32,159 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:23:32,160 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:32,161 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:23:32,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:32,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:23:32,164 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:23:33,937 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:25:24,837 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:25:24,853 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:25:24,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:25:24,856 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:25:24,858 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:25:24,859 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:25:24,865 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:24,866 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:25:24,873 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:24,874 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:25:24,881 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:24,882 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:25:24,884 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:25:24,885 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:25:24,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:25:24,893 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:25:24,894 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:25:24,895 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:25:24,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:25:24,899 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:25:24,904 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:25:24,904 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:25:24,906 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:24,907 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:25:24,908 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:25:24,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:25:24,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:25:24,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:25:24,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:25:24,916 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:25:24,917 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:25:24,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:25:24,923 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:24,923 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:25:24,923 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:24,938 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:25:24,939 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:25:24,940 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:25:25,399 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:25:25,408 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:25:25,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:25,479 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:25:25,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:25:25,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:25:25,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:25:25,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:25:26,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:25:26,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:25:26,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:26,235 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:25:26,288 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:25:26,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:25:27,000 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:25:27,122 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:25:27,129 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:25:27,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:27,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:25:27,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:27,279 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:25:28,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:25:28,127 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:25:28,879 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:25:28,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:25:29,628 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:25:29,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:25:30,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:25:30,228 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:25:30,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:25:30,231 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:25:30,455 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:25:30,464 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:25:30,496 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:30,501 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:25:30,528 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:30,530 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:25:30,575 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:25:30,578 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:25:30,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:25:30,596 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:25:30,606 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:30,606 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:25:30,625 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:25:30,627 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:25:30,922 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:25:30,929 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:25:30,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:30,944 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:25:30,954 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:25:30,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:25:30,967 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:25:30,968 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:25:31,239 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:25:31,249 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:25:31,251 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:25:31,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:25:31,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:25:31,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:25:31,266 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:25:31,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:25:31,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:25:31,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:25:31,275 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:25:31,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:25:31,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:25:31,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:25:31,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:31,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:25:31,284 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:31,285 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:25:31,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:25:31,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:25:31,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:25:31,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:25:31,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:25:31,299 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:25:31,303 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:25:31,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:25:31,312 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:25:31,314 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:25:31,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:31,317 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:25:31,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:25:31,321 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:25:31,326 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:25:31,327 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:25:31,344 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:25:31,346 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:25:31,348 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:31,348 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:25:31,358 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:25:31,359 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:25:31,361 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:31,361 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:25:31,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:25:31,367 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:25:31,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:25:31,369 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:25:31,496 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:25:31,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:25:31,516 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:25:31,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:25:31,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:25:31,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:25:31,533 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:25:31,535 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:25:31,699 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:25:31,705 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:25:31,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:31,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:25:31,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:25:31,867 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:25:31,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:25:31,995 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:25:31,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:25:31,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:25:32,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:25:32,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,009 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:25:32,010 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,014 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:25:32,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:25:32,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:25:32,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:25:32,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,030 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:25:32,032 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:25:32,034 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:25:32,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:25:32,037 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:25:32,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:25:32,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:25:32,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:32,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:25:32,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:32,045 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:25:32,047 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:32,050 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:25:32,050 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:32,053 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:25:32,053 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:32,053 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:25:32,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:32,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:25:32,060 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:25:34,258 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:27:05,893 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:27:05,912 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:27:05,912 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:27:05,912 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:27:05,916 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:27:05,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:27:05,917 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:05,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:27:05,928 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:05,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:27:05,937 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:05,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:27:05,942 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:27:05,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:27:05,950 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:27:05,951 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:27:05,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:27:05,953 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:27:05,956 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:05,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:27:05,961 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:27:05,962 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:27:05,963 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:05,964 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:27:05,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:27:05,968 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:27:05,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:27:05,970 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:27:05,972 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:27:05,974 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:27:05,976 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:05,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:27:05,984 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:05,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:27:05,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:05,996 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:27:05,999 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:27:06,000 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:27:06,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:06,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:27:06,578 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:06,578 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:27:06,625 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:27:06,625 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:27:06,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:27:06,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:27:07,278 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:07,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:27:07,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:07,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:27:07,939 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:07,956 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:27:07,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:08,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:27:08,039 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:08,039 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:27:08,085 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:08,086 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:27:08,767 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:08,787 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:27:09,437 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:09,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:27:10,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:27:10,201 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:27:10,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:27:10,742 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:27:10,750 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:27:10,754 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:27:11,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:27:11,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:27:11,140 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:11,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:27:11,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:11,174 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:27:11,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:27:11,236 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:27:11,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:27:11,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:27:11,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:11,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:27:11,274 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:27:11,274 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:27:11,577 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:27:11,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:27:11,596 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:11,598 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:27:11,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:11,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:27:11,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:27:11,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:27:11,917 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:27:11,925 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:27:11,925 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:27:11,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:27:11,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:27:11,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:27:11,945 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:27:11,947 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:27:11,949 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:27:11,950 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:27:11,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:27:11,954 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:27:11,956 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:11,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:27:11,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:11,961 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:27:11,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:11,962 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:27:11,964 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:27:11,965 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:27:11,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:27:11,972 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:27:11,974 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:27:11,975 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:27:11,978 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:27:11,978 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:27:11,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:27:11,984 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:27:11,985 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:11,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:27:11,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:11,989 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:27:11,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:11,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:27:12,000 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:27:12,003 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:27:12,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:27:12,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:27:12,009 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:27:12,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:27:12,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:27:12,017 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:27:12,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:27:12,033 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:27:12,133 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:27:12,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:27:12,156 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:12,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:27:12,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:27:12,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:27:12,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:27:12,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:27:12,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:27:12,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:27:12,306 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:27:12,433 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:27:12,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:27:12,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:27:12,600 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:27:12,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:27:12,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:27:12,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:27:12,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:27:12,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:27:12,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:27:12,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:27:12,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:27:12,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:12,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:27:12,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:12,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:27:12,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:12,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:27:12,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:12,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:27:12,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:14,640 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:27:57,218 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:27:57,233 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:27:57,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:27:57,235 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:27:57,237 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:27:57,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:27:57,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:57,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:27:57,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:57,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:27:57,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:57,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:27:57,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:27:57,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:27:57,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:27:57,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:27:57,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:27:57,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:27:57,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:57,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:27:57,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:27:57,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:27:57,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:27:57,289 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:27:57,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:27:57,291 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:27:57,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:27:57,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:27:57,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:27:57,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:27:57,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:57,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:27:57,309 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:57,309 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:27:57,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:57,318 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:27:57,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:27:57,323 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:27:57,830 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:57,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:27:57,911 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:27:57,916 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:27:57,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:27:57,953 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:27:57,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:27:57,989 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:27:58,723 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:58,743 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:27:58,791 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:58,798 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:27:59,467 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:27:59,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:27:59,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:27:59,526 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:27:59,558 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:59,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:27:59,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:27:59,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:28:00,571 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:00,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:28:01,410 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:01,434 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:28:02,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:28:02,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:28:02,759 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:28:02,775 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:28:02,787 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:02,787 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:28:02,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:28:02,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:28:03,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:03,018 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:28:03,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:03,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:28:03,132 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:28:03,133 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:28:03,146 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:28:03,147 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:28:03,157 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:03,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:28:03,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:03,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:28:03,481 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:28:03,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:28:03,513 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:03,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:28:03,528 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:03,528 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:28:03,538 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:03,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:28:03,857 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:28:03,862 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:28:03,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:03,865 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:28:03,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:03,868 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:28:03,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:03,870 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:28:03,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:03,872 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:28:03,874 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:03,875 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:28:03,876 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:03,877 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:28:03,878 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:03,879 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:28:03,880 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:03,880 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:28:03,882 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:03,884 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:28:03,892 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:28:03,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:28:03,895 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:03,896 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:28:03,898 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:03,900 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:28:03,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:28:03,907 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:28:03,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:03,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:28:03,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:03,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:28:03,916 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:03,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:28:03,923 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:28:03,923 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:28:03,923 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:03,923 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:28:03,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:28:03,940 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:28:03,941 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:03,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:28:03,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:28:03,954 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:28:03,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:28:03,958 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:28:04,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:04,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:28:04,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:04,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:28:04,068 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:28:04,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:28:04,068 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:28:04,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:28:04,227 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:04,233 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:28:04,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,239 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:28:04,358 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:04,367 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:28:04,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:28:04,509 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:28:04,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:28:04,510 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:28:04,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,510 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:28:04,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:28:04,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:28:04,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:28:04,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,526 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:28:04,527 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,527 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:28:04,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,531 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:28:04,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,531 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:28:04,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,531 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:28:04,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:04,537 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:28:04,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:04,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:28:04,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:04,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:28:04,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:04,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:28:04,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:04,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:28:04,548 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:04,548 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:28:04,551 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:04,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:28:04,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:04,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:28:04,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:06,623 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:28:08,925 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:28:08,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:28:08,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:28:08,941 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:28:08,943 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:28:08,945 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:28:08,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:08,953 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:28:08,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:08,960 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:28:08,968 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:08,969 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:28:08,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:28:08,972 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:28:08,977 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:28:08,979 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:28:08,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:28:08,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:28:08,984 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:08,985 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:28:08,989 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:28:08,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:28:08,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:08,993 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:28:08,993 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:08,994 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:28:08,996 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:28:08,997 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:28:08,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:28:08,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:28:09,000 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:09,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:28:09,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:09,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:28:09,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:09,017 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:28:09,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:28:09,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:28:09,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:09,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:28:09,558 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:09,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:28:09,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:28:09,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:28:09,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:28:09,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:28:10,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:10,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:28:10,381 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:10,387 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:28:11,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:11,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:28:11,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:11,119 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:28:11,150 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:11,151 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:28:11,189 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:11,190 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:28:11,927 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:11,956 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:28:12,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:12,654 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:28:13,362 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:28:13,386 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:28:13,900 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:28:13,917 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:28:13,917 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:13,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:28:14,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:28:14,135 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:28:14,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:14,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:28:14,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:14,201 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:28:14,239 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:28:14,240 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:28:14,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:28:14,255 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:28:14,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:14,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:28:14,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:14,289 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:28:14,793 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:28:14,793 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:28:14,803 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:14,809 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:28:14,824 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:14,824 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:28:14,840 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:14,840 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:28:15,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:28:15,133 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:28:15,135 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:15,136 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:28:15,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:15,140 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:28:15,142 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:15,143 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:28:15,145 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:15,147 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:28:15,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:15,149 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:28:15,151 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:15,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:28:15,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:28:15,155 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,155 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:28:15,157 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:15,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:28:15,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:28:15,164 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:28:15,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:15,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:28:15,168 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:15,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:28:15,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:28:15,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:28:15,176 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:15,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:28:15,178 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:15,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:28:15,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:15,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:28:15,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:28:15,189 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:28:15,190 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:28:15,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:28:15,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:28:15,198 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,198 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:28:15,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:28:15,205 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:28:15,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:28:15,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:28:15,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:15,316 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:28:15,327 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:15,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:28:15,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:28:15,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:28:15,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:28:15,349 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:28:15,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:15,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:28:15,469 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:28:15,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:15,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:28:15,749 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:28:15,754 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:28:15,756 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:28:15,756 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:28:15,758 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,758 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:28:15,758 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,758 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:28:15,758 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,758 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:28:15,765 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,766 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:28:15,767 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,769 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:28:15,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,771 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:28:15,772 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,772 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:15,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:28:15,783 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:15,785 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:28:15,786 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:15,786 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:28:15,788 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:17,260 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:28:52,388 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:28:52,408 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:28:52,408 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:28:52,408 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:28:52,414 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:28:52,414 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:28:52,421 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:52,421 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:28:52,430 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:52,430 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:28:52,443 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:52,445 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:28:52,446 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:28:52,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:28:52,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:28:52,456 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:28:52,456 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:28:52,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:28:52,458 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:52,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:28:52,466 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:28:52,468 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:28:52,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:52,468 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:28:52,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:52,468 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:28:52,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:28:52,477 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:28:52,480 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:28:52,481 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:28:52,481 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:52,481 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:28:52,493 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:52,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:28:52,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:52,506 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:28:52,506 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:28:52,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:28:52,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:52,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:28:53,025 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:53,031 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:28:53,070 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:28:53,070 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:28:53,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:28:53,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:28:53,803 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:53,818 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:28:53,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:53,869 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:28:54,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:54,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:28:54,527 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:54,532 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:28:54,558 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:54,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:28:54,595 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:54,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:28:55,312 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:55,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:28:55,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:28:56,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:28:56,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:28:56,703 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:28:57,417 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:28:57,435 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:28:57,437 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:57,437 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:28:57,683 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:28:57,697 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:28:57,717 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:57,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:28:57,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:57,763 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:28:57,810 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:28:57,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:28:57,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:28:57,839 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:28:57,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:57,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:28:57,866 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:57,866 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:28:58,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:28:58,157 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:28:58,173 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:58,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:28:58,190 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:58,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:28:58,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:28:58,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:28:58,481 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:28:58,487 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:28:58,487 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:58,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:28:58,487 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:58,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:28:58,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:58,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:28:58,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:58,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:28:58,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:58,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:28:58,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:58,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:28:58,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:58,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:28:58,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:58,508 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:28:58,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:58,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:28:58,516 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:28:58,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:28:58,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:58,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:28:58,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:28:58,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:28:58,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:28:58,529 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:28:58,533 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:58,533 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:28:58,533 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:58,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:28:58,538 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:28:58,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:28:58,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:28:58,553 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:28:58,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:58,553 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:28:58,561 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:28:58,561 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:28:58,561 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:58,561 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:28:58,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:28:58,567 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:28:58,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:28:58,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:28:58,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:58,704 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:28:58,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:28:58,717 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:28:58,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:28:58,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:28:58,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:28:58,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:28:58,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:58,867 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:28:58,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:58,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:28:59,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:28:59,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:28:59,150 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:28:59,154 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:28:59,156 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:28:59,156 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:28:59,157 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:28:59,161 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,161 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:28:59,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,164 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:28:59,164 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,164 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:28:59,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:28:59,168 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:28:59,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:28:59,174 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:28:59,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:28:59,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:28:59,181 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:28:59,183 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:28:59,183 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:28:59,185 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:59,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:28:59,189 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:59,190 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:28:59,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:59,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:28:59,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:59,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:28:59,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:59,198 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:28:59,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:28:59,200 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:28:59,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:29:01,070 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:31:57,179 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:33:32,291 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:33:32,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:33:32,307 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:33:32,308 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:33:32,310 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:33:32,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:33:32,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:32,317 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:33:32,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:32,322 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:33:32,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:32,368 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:33:32,370 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:33:32,370 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:33:32,376 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:33:32,378 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:33:32,378 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:33:32,379 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:33:32,379 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:33:32,380 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:33:32,385 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:33:32,386 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:33:32,387 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:32,387 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:33:32,389 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:33:32,389 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:33:32,391 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:33:32,391 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:33:32,393 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:33:32,393 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:33:32,394 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:33:32,396 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:33:32,400 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:32,400 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:33:32,405 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:32,406 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:33:32,407 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:33:32,407 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:33:32,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:33:32,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:33:32,700 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:32,702 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:33:32,723 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:33:32,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:33:32,748 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:33:32,748 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:33:33,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:33:33,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:33:33,126 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:33,129 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:33:33,509 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:33:33,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:33:33,549 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:33:33,551 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:33:33,575 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:33,576 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:33:33,598 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:33,598 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:33:34,052 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:33:34,062 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:33:34,485 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:33:34,496 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:33:34,913 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:33:34,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:33:35,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:33:35,260 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:33:35,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:33:35,264 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:33:35,380 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:33:35,387 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:33:35,402 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:35,405 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:33:35,418 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:35,420 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:33:35,450 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:33:35,452 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:33:35,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:33:35,464 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:33:35,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:35,472 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:33:35,485 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:33:35,486 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:33:35,624 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:33:35,628 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:33:35,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:35,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:33:35,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:33:35,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:33:35,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:33:35,657 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:33:35,795 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:33:35,800 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:33:35,801 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:33:35,802 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:33:35,802 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:33:35,805 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:33:35,807 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:33:35,807 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:33:35,810 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:33:35,810 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:33:35,812 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:33:35,812 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:33:35,813 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:33:35,814 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:33:35,815 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:35,815 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:33:35,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:35,817 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:33:35,818 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:33:35,818 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:33:35,822 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:33:35,822 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:33:35,825 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:33:35,826 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:33:35,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:33:35,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:33:35,830 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:33:35,831 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:33:35,832 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:35,832 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:33:35,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:33:35,833 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:33:35,835 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:33:35,836 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:33:35,840 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:33:35,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:33:35,842 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:35,843 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:33:35,845 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:33:35,846 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:33:35,847 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:35,847 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:33:35,852 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:33:35,852 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:33:35,854 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:33:35,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:33:35,915 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:33:35,919 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:33:35,927 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:33:35,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:33:35,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:33:35,934 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:33:35,936 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:33:35,936 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:33:36,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:33:36,013 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:33:36,015 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:33:36,106 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:33:36,109 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:33:36,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:33:36,190 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:33:36,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:33:36,192 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:33:36,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:33:36,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:33:36,198 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,200 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:33:36,201 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:33:36,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,204 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:33:36,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:33:36,207 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,207 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:33:36,209 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:33:36,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,213 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:33:36,214 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:33:36,214 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:33:36,215 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:33:36,215 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:33:36,217 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:36,217 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:33:36,218 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:36,220 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:33:36,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:36,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:33:36,223 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:36,223 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:33:36,224 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:36,225 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:33:36,226 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:36,227 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:33:36,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:33:37,480 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:35:29,576 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:35:29,590 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:35:29,592 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:35:29,593 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:35:29,595 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:35:29,596 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:35:29,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:29,601 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:35:29,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:29,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:35:29,614 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:29,615 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:35:29,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:35:29,618 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:35:29,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:35:29,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:35:29,625 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:35:29,626 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:35:29,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:35:29,627 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:35:29,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:35:29,631 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:35:29,633 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:29,633 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:35:29,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:35:29,635 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:35:29,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:35:29,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:35:29,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:35:29,638 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:35:29,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:35:29,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:35:29,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:29,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:35:29,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:29,649 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:35:29,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:35:29,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:35:29,900 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:35:29,910 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:35:29,951 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:29,954 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:35:29,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:35:29,984 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:35:30,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:35:30,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:35:30,352 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:35:30,364 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:35:30,382 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:30,386 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:35:30,722 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:35:30,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:35:30,754 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:35:30,757 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:35:30,775 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:30,776 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:35:30,795 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:30,796 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:35:31,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:35:31,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:35:31,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:35:31,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:35:32,020 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:35:32,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:35:32,322 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:35:32,332 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:35:32,333 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:35:32,334 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:35:32,447 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:35:32,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:35:32,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:32,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:35:32,485 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:32,486 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:35:32,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:35:32,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:35:32,520 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:35:32,521 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:35:32,525 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:32,526 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:35:32,535 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:35:32,535 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:35:32,681 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:35:32,685 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:35:32,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:32,694 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:35:32,705 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:35:32,706 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:35:32,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:35:32,713 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:35:32,857 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:35:32,862 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:35:32,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:35:32,864 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:35:32,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:35:32,867 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:35:32,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:35:32,869 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:35:32,871 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:35:32,872 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:35:32,873 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:35:32,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:35:32,874 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:35:32,875 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:35:32,875 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:32,876 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:35:32,877 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:32,878 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:35:32,879 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:35:32,880 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:35:32,884 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:35:32,885 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:35:32,886 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:35:32,886 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:35:32,888 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:35:32,888 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:35:32,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:35:32,892 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:35:32,894 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:32,895 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:35:32,896 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:35:32,897 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:35:32,898 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:35:32,899 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:35:32,903 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:35:32,904 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:35:32,905 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:32,906 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:35:32,908 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:35:32,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:35:32,910 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:32,910 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:35:32,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:35:32,915 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:35:32,916 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:35:32,916 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:35:32,973 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:35:32,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:35:32,986 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:35:32,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:35:32,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:35:32,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:35:32,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:35:32,994 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:35:33,072 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:35:33,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:35:33,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,078 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:35:33,146 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:35:33,149 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:35:33,224 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:35:33,228 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:35:33,229 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:35:33,230 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:35:33,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:35:33,233 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,234 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:35:33,235 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,236 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:35:33,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,239 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:35:33,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,240 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:35:33,241 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:35:33,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,243 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:35:33,244 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:35:33,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,246 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:35:33,246 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:35:33,247 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:35:33,248 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:35:33,248 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:35:33,249 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:33,250 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:35:33,251 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:33,251 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:35:33,252 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:33,252 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:35:33,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:33,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:35:33,255 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:33,255 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:35:33,256 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:33,257 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:35:33,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:35:34,535 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:37:09,253 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:37:09,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:37:09,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:37:09,264 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:37:09,266 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:37:09,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:37:09,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:09,272 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:37:09,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:09,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:37:09,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:09,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:37:09,284 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:37:09,285 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:37:09,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:37:09,289 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:37:09,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:37:09,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:37:09,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:37:09,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:37:09,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:37:09,299 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:37:09,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:09,301 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:37:09,302 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:37:09,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:37:09,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:37:09,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:37:09,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:37:09,307 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:37:09,307 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:37:09,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:37:09,312 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:09,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:37:09,327 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:09,329 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:37:09,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:37:09,331 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:37:09,648 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:37:09,662 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:37:09,704 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:09,706 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:37:09,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:37:09,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:37:09,756 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:37:09,757 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:37:10,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:37:10,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:37:10,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:10,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:37:10,888 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:37:10,901 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:37:10,927 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:37:10,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:37:10,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:10,952 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:37:10,974 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:10,974 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:37:11,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:37:11,449 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:37:11,842 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:37:11,854 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:37:12,257 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:37:12,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:37:12,597 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:37:12,611 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:37:12,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:37:12,613 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:37:12,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:37:12,738 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:37:12,755 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:12,756 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:37:12,773 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:12,774 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:37:12,800 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:37:12,801 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:37:12,811 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:37:12,812 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:37:12,818 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:12,818 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:37:12,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:37:12,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:37:12,984 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:37:12,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:37:12,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:12,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:37:13,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:37:13,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:37:13,017 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:37:13,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:37:13,189 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:37:13,195 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:37:13,198 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:37:13,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:37:13,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:37:13,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:37:13,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:37:13,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:37:13,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:37:13,207 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:37:13,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:37:13,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:37:13,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:37:13,211 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:37:13,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:37:13,213 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,214 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:37:13,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:37:13,216 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:37:13,220 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:37:13,220 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:37:13,222 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:37:13,223 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:37:13,224 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:37:13,225 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:37:13,229 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:37:13,230 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:37:13,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:13,233 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:37:13,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:37:13,234 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:37:13,236 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:37:13,236 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:37:13,241 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:37:13,241 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:37:13,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,243 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:37:13,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:37:13,246 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:37:13,248 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,248 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:37:13,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:37:13,255 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:37:13,256 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:37:13,256 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:37:13,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:37:13,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:37:13,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:37:13,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:37:13,336 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:37:13,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:37:13,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:37:13,342 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:37:13,432 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:37:13,435 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:37:13,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,439 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:37:13,523 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:37:13,526 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:37:13,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:37:13,606 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:37:13,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:37:13,607 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:37:13,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:37:13,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,611 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:37:13,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:37:13,614 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:37:13,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:37:13,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:37:13,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,619 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:37:13,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:37:13,623 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,623 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:37:13,624 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:37:13,624 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:37:13,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:37:13,626 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:37:13,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:13,627 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:37:13,628 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:13,629 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:37:13,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:13,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:37:13,631 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:13,631 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:37:13,634 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:13,634 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:37:13,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:13,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:37:13,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:37:15,053 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:38:04,924 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:38:14,884 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:38:14,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:38:14,896 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:38:14,897 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:38:14,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:38:14,898 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:38:14,903 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:14,904 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:38:14,908 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:14,909 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:38:14,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:14,914 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:38:14,917 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:38:14,917 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:38:14,920 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:38:14,921 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:38:14,923 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:38:14,923 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:38:14,924 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:14,925 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:38:14,928 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:38:14,929 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:38:14,930 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:14,931 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:38:14,932 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:38:14,933 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:38:14,934 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:38:14,935 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:38:14,936 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:38:14,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:38:14,939 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:14,940 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:38:14,945 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:14,946 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:38:14,952 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:14,953 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:38:14,954 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:38:14,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:38:15,571 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:15,579 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:38:15,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:15,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:38:15,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:38:15,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:38:15,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:38:15,658 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:38:16,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:16,030 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:38:16,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:16,057 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:38:16,419 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:16,430 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:38:16,454 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:16,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:38:16,479 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:16,479 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:38:16,501 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:16,502 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:38:16,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:16,945 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:38:17,315 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:17,327 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:38:17,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:38:17,750 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:38:18,069 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:38:18,080 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:38:18,082 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:38:18,082 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:38:18,193 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:38:18,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:38:18,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:18,214 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:38:18,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:18,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:38:18,252 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:38:18,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:38:18,260 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:38:18,261 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:38:18,270 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:18,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:38:18,279 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:38:18,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:38:18,428 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:38:18,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:38:18,444 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:38:18,452 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:18,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:38:18,458 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:38:18,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:38:18,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:38:18,598 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:38:18,598 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:38:18,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:38:18,601 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:38:18,602 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:38:18,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:38:18,604 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:38:18,605 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:38:18,607 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:38:18,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:38:18,608 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:38:18,610 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:18,610 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:38:18,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:38:18,613 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,613 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:38:18,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:38:18,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:38:18,619 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:38:18,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:38:18,621 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:38:18,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:38:18,623 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:38:18,623 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:38:18,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:38:18,628 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:38:18,629 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:18,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:38:18,631 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:18,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:38:18,633 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:18,634 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:38:18,639 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:38:18,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:38:18,642 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,643 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:38:18,645 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:38:18,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:38:18,646 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:38:18,651 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:38:18,652 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:38:18,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:38:18,654 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:38:18,709 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:38:18,713 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:38:18,725 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:18,727 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:38:18,730 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:38:18,730 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:38:18,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:38:18,735 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:38:18,809 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:38:18,812 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:38:18,815 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:38:18,891 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:38:18,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:38:18,960 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:38:18,964 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:38:18,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:38:18,967 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:38:18,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:38:18,972 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,975 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:38:18,976 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:38:18,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:38:18,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,982 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:38:18,985 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,985 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:38:18,986 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:38:18,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,989 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:38:18,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:38:18,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:18,993 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:38:18,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:38:18,996 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:38:18,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:18,997 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:38:18,998 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:18,998 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:38:19,000 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:19,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:38:19,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:19,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:38:19,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:19,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:38:19,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:19,006 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:38:19,006 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:19,936 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:38:57,433 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:38:57,446 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:38:57,447 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:38:57,448 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:38:57,451 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:38:57,452 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:38:57,457 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:57,458 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:38:57,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:57,463 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:38:57,468 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:57,470 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:38:57,472 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:38:57,473 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:38:57,477 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:38:57,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:38:57,479 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:38:57,482 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:38:57,483 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:57,483 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:38:57,486 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:38:57,486 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:38:57,489 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:38:57,490 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:38:57,491 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:38:57,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:38:57,494 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:38:57,495 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:38:57,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:38:57,498 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:38:57,499 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:57,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:38:57,506 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:57,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:38:57,522 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:57,523 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:38:57,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:38:57,525 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:38:57,802 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:57,813 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:38:57,856 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:38:57,859 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:38:57,884 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:38:57,885 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:38:57,906 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:38:57,906 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:38:58,276 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:58,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:38:58,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:58,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:38:58,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:58,689 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:38:58,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:38:58,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:38:58,743 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:58,743 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:38:58,764 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:38:58,764 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:38:59,222 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:59,236 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:38:59,668 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:38:59,679 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:39:00,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:39:00,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:39:00,389 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:39:00,398 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:39:00,399 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:39:00,399 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:39:00,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:39:00,514 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:39:00,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:39:00,532 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:39:00,547 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:39:00,548 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:39:00,568 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:39:00,570 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:39:00,578 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:39:00,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:39:00,585 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:00,585 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:39:00,593 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:39:00,593 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:39:00,738 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:39:00,744 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:39:00,753 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:00,755 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:39:00,763 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:39:00,763 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:39:00,769 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:39:00,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:39:00,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:39:00,923 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:39:00,924 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:39:00,925 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:39:00,926 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:39:00,927 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:39:00,929 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:39:00,929 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:39:00,931 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:39:00,932 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:39:00,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:39:00,933 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:39:00,934 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:39:00,934 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:39:00,936 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:00,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:39:00,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:00,939 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:39:00,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:39:00,940 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:39:00,944 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:39:00,947 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:39:00,948 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:39:00,949 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:39:00,950 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:39:00,950 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:39:00,954 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:39:00,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:39:00,956 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:00,958 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:39:00,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:39:00,960 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:39:00,961 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:39:00,961 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:39:00,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:39:00,967 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:39:00,969 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:00,970 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:39:00,972 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:39:00,973 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:39:00,974 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:00,975 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:39:00,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:39:00,980 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:39:00,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:39:00,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:39:01,029 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:39:01,032 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:39:01,042 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:39:01,043 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:39:01,046 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:39:01,046 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:39:01,049 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:39:01,049 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:39:01,122 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:39:01,127 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:39:01,129 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,131 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:39:01,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:39:01,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:39:01,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:39:01,266 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:39:01,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:39:01,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:39:01,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:39:01,272 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:39:01,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,274 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:39:01,275 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,275 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:39:01,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:39:01,278 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:39:01,279 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:39:01,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,281 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:39:01,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:39:01,284 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:39:01,284 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:39:01,285 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:39:01,286 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:39:01,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:01,289 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:39:01,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:01,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:39:01,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:01,291 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:39:01,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:01,293 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:39:01,295 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:01,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:39:01,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:01,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:39:01,299 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:39:02,938 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:43:27,853 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:45:34,482 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:45:34,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:45:34,499 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:45:34,499 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:45:34,499 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:45:34,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:45:34,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:34,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:45:34,516 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:34,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:45:34,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:34,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:45:34,528 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:45:34,529 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:45:34,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:45:34,536 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:45:34,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:45:34,539 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:45:34,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:45:34,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:45:34,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:45:34,548 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:45:34,550 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:34,551 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:45:34,552 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:45:34,553 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:45:34,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:45:34,557 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:45:34,557 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:45:34,559 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:45:34,560 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:45:34,561 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:45:34,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:34,568 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:45:34,575 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:34,576 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:45:34,577 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:45:34,579 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:45:34,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:45:34,999 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:45:35,058 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:35,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:45:35,110 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:45:35,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:45:35,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:45:35,148 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:45:35,705 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:45:35,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:45:35,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:35,751 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:45:36,224 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:45:36,241 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:45:36,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:45:36,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:45:36,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:36,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:45:36,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:36,346 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:45:37,133 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:45:37,156 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:45:37,753 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:45:37,767 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:45:38,448 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:45:38,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:45:38,851 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:45:38,867 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:45:38,871 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:45:38,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:45:39,050 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:45:39,063 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:45:39,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:39,090 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:45:39,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:39,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:45:39,153 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:45:39,160 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:45:39,174 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:45:39,174 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:45:39,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:39,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:45:39,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:45:39,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:45:39,512 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:45:39,523 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:45:39,547 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:39,549 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:45:39,563 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:45:39,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:45:39,579 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:45:39,579 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:45:39,965 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:45:39,979 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:45:39,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:45:39,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:45:39,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:45:40,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:45:40,012 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:45:40,014 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:45:40,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:45:40,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:45:40,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:45:40,026 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:45:40,038 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:45:40,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:45:40,048 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:40,048 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:45:40,050 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:40,054 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:45:40,061 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:45:40,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:45:40,080 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:45:40,080 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:45:40,089 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:45:40,089 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:45:40,096 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:45:40,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:45:40,126 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:45:40,133 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:45:40,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:40,164 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:45:40,165 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:45:40,174 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:45:40,189 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:45:40,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:45:40,247 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:45:40,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:45:40,265 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:40,276 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:45:40,298 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:45:40,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:45:40,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:40,323 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:45:40,378 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:45:40,391 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:45:40,403 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:45:40,416 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:45:40,732 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:45:40,740 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:45:40,805 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:45:40,829 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:45:40,846 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:45:40,850 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:45:40,861 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:45:40,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:45:41,025 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:45:41,028 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:45:41,044 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,057 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:45:41,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:45:41,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:45:41,393 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:45:41,403 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:45:41,405 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:45:41,410 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:45:41,411 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,414 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:45:41,417 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:45:41,425 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,427 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:45:41,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,436 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:45:41,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,438 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:45:41,447 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,450 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:45:41,454 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,455 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:45:41,460 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,461 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:45:41,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,463 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:45:41,463 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:45:41,466 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:45:41,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:45:41,475 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:45:41,479 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:41,484 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:45:41,487 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:41,487 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:45:41,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:41,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:45:41,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:41,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:45:41,498 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:41,499 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:45:41,503 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:41,503 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:45:41,509 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:45:45,393 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:45:53,759 - nl2sql - INFO - endpoints.py:14 - Incoming query: Hi | Domain: compliance
2026-01-26 00:45:53,888 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 00:45:53,900 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Hi
2026-01-26 00:45:54,309 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 00:45:55,907 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "OFF_TOPIC",
  "confidence":...
2026-01-26 00:45:55,910 - nl2sql - INFO - intent_classification.py:82 - Classification Result: OFF_TOPIC (conf: 1.0) | Needs Clarification: False
2026-01-26 00:45:55,926 - nl2sql - INFO - workflow.py:24 - Intent classified: OFF_TOPIC (conf: 1.0) | Needs Clarification: False
2026-01-26 00:45:56,473 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:45:57,520 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 00:45:57,522 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 00:45:57,834 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a helpful database assistant.
   ...
2026-01-26 00:45:58,662 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Hi there! I'm a database assistant focused on comp...
2026-01-26 00:45:58,662 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: Hi
2026-01-26 00:46:35,937 - nl2sql - INFO - endpoints.py:14 - Incoming query: give all the details about user complaince statuses | Domain: compliance
2026-01-26 00:46:35,941 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 00:46:35,948 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give all the details about user complaince statuses
2026-01-26 00:46:36,268 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 00:46:37,083 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 00:46:37,087 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 00:46:37,113 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 00:46:37,684 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:46:38,494 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "account_st...
2026-01-26 00:46:38,494 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'account_status': 'COMPLIANCE'}
2026-01-26 00:46:38,660 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 00:46:38,669 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: give all the details about user complaince statuses
2026-01-26 00:46:39,569 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 00:46:40,348 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, kyc_status, risk_level, account_st...
2026-01-26 00:46:40,348 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT user_id, kyc_status, risk_level, account_st...
2026-01-26 00:46:40,367 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT user_id, kyc_status, risk_level, account_st...
2026-01-26 00:46:40,374 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 00:46:40,404 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 00:46:40,406 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, kyc_status, risk_level, account_status FROM users
2026-01-26 00:46:40,436 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:46:40,441 - nl2sql - INFO - workflow.py:92 - Query execution returned 493 rows.
2026-01-26 00:46:40,448 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 00:46:41,639 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Use...
2026-01-26 00:46:41,644 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give all the details about user complaince statuses
2026-01-26 00:46:41,646 - nl2sql - INFO - endpoints.py:48 - Query success! 493 rows returned.
2026-01-26 00:47:07,881 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:47:07,922 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:47:07,922 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:47:07,932 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:47:07,935 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:47:07,938 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:47:07,943 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:07,948 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:47:07,960 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:07,965 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:47:07,973 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:07,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:47:07,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:47:07,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:47:08,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:47:08,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:47:08,015 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:47:08,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:47:08,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:47:08,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:47:08,036 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:47:08,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:47:08,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:08,051 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:47:08,054 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:47:08,057 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:47:08,066 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:47:08,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:47:08,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:47:08,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:47:08,072 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:47:08,074 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:47:08,080 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:08,080 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:47:08,102 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:08,107 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:47:08,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:47:08,113 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:47:08,706 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:47:08,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:47:08,830 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:08,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:47:08,905 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:47:08,911 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:47:08,975 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:47:08,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:47:09,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:47:09,827 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:47:09,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:09,877 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:47:10,686 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:47:10,704 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:47:10,754 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:47:10,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:47:10,793 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:10,795 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:47:10,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:10,837 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:47:11,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:47:11,735 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:47:12,391 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:47:12,418 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:47:13,157 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:47:13,186 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:47:13,763 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:47:13,780 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:47:13,787 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:47:13,794 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:47:14,069 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:47:14,099 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:47:14,149 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:14,156 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:47:14,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:14,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:47:14,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:47:14,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:47:14,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:47:14,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:47:14,331 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:14,334 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:47:14,354 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:47:14,360 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:47:15,354 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:47:15,368 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:47:15,388 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:15,399 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:47:15,427 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:47:15,431 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:47:15,451 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:47:15,457 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:47:15,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:47:15,972 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:47:15,978 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:47:15,985 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:47:15,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:47:16,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:47:16,035 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:47:16,047 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:47:16,063 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:47:16,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:47:16,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:47:16,085 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:47:16,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:47:16,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:47:16,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:16,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:47:16,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:16,119 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:47:16,121 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:47:16,125 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:47:16,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:47:16,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:47:16,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:47:16,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:47:16,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:47:16,185 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:47:16,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:47:16,222 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:47:16,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:16,243 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:47:16,261 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:47:16,264 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:47:16,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:47:16,275 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:47:16,294 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:47:16,301 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:47:16,307 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:16,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:47:16,329 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:47:16,334 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:47:16,338 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:16,344 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:47:16,362 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:47:16,367 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:47:16,372 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:47:16,377 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:47:16,509 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:47:16,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:47:16,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:47:16,582 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:47:16,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:47:16,621 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:47:16,646 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:47:16,648 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:47:17,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:47:17,076 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:47:17,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,095 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:47:17,290 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:47:17,303 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:47:17,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:47:17,531 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:47:17,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:47:17,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:47:17,549 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:47:17,559 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:47:17,568 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,573 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:47:17,577 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:47:17,584 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,584 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:47:17,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,590 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:47:17,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,598 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:47:17,601 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,606 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:47:17,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,611 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:47:17,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:47:17,621 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:47:17,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:47:17,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:47:17,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:17,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:47:17,634 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:17,634 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:47:17,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:17,643 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:47:17,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:17,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:47:17,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:17,657 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:47:17,663 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:17,667 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:47:17,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:47:22,715 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:48:03,756 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are the different kyc status ? | Domain: compliance
2026-01-26 00:48:03,766 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 00:48:03,772 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what are the different kyc status ?
2026-01-26 00:48:04,074 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 00:48:04,661 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 00:48:04,664 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 00:48:04,684 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 00:48:05,244 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:48:06,040 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 00:48:06,049 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 00:48:06,200 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 00:48:06,208 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: what are the different kyc status ?
2026-01-26 00:48:07,451 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 00:48:08,117 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT kyc_status FROM users...
2026-01-26 00:48:08,117 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT DISTINCT kyc_status FROM users...
2026-01-26 00:48:08,137 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT DISTINCT kyc_status FROM users...
2026-01-26 00:48:08,142 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 00:48:08,150 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 00:48:08,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users
2026-01-26 00:48:08,159 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:08,161 - nl2sql - INFO - workflow.py:92 - Query execution returned 4 rows.
2026-01-26 00:48:08,162 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 00:48:09,109 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Count...
2026-01-26 00:48:09,117 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: what are the different kyc status ?
2026-01-26 00:48:09,117 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-26 00:48:15,129 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:48:15,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 00:48:15,178 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:48:15,179 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 00:48:15,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 00:48:15,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 00:48:15,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:15,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 00:48:15,207 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:15,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 00:48:15,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:15,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 00:48:15,230 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:48:15,230 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 00:48:15,249 - nl2sql - INFO - database.py:60 - Execution complete. Returned 486 rows.
2026-01-26 00:48:15,249 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 00:48:15,257 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:48:15,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 00:48:15,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:15,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 00:48:15,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 370 rows.
2026-01-26 00:48:15,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 00:48:15,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:15,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 00:48:15,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:48:15,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 00:48:15,301 - nl2sql - INFO - database.py:60 - Execution complete. Returned 62 rows.
2026-01-26 00:48:15,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 00:48:15,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 00:48:15,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 00:48:15,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:15,321 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 00:48:15,338 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:15,338 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 00:48:15,359 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:15,363 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 00:48:15,367 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 00:48:15,369 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 00:48:16,058 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:48:16,078 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 00:48:16,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:16,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 00:48:16,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:48:16,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 00:48:16,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:48:16,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 00:48:17,425 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:48:17,450 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 00:48:17,494 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:17,506 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 00:48:18,414 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:48:18,447 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 00:48:18,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:18,540 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 00:48:18,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:18,619 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 00:48:18,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:18,697 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 00:48:19,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:48:20,004 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 00:48:21,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-26 00:48:21,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 00:48:22,358 - nl2sql - INFO - database.py:60 - Execution complete. Returned 49941 rows.
2026-01-26 00:48:22,383 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 00:48:23,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 39091 rows.
2026-01-26 00:48:23,210 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 00:48:23,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:48:23,214 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 00:48:23,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:48:23,525 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 00:48:23,584 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:23,593 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 00:48:23,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:23,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 00:48:23,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1924 rows.
2026-01-26 00:48:23,775 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 00:48:23,795 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:48:23,795 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 00:48:23,818 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:23,818 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 00:48:23,838 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:48:23,845 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 00:48:24,209 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 00:48:24,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 00:48:24,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:24,274 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 00:48:24,317 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:24,320 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 00:48:24,353 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 00:48:24,354 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 00:48:24,775 - nl2sql - INFO - database.py:60 - Execution complete. Returned 19987 rows.
2026-01-26 00:48:24,792 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 00:48:24,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:48:24,801 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 00:48:24,807 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:48:24,813 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 00:48:24,820 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:48:24,822 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 00:48:24,824 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:48:24,828 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 00:48:24,834 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:48:24,837 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 00:48:24,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:24,837 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 00:48:24,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:24,852 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 00:48:24,857 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:24,861 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 00:48:24,869 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:48:24,875 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 00:48:24,892 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:48:24,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 00:48:24,896 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:48:24,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 00:48:24,912 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 00:48:24,912 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 00:48:24,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 309 rows.
2026-01-26 00:48:24,919 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 00:48:24,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:24,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 00:48:24,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:24,937 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 00:48:24,938 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 00:48:24,938 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 00:48:24,959 - nl2sql - INFO - database.py:60 - Execution complete. Returned 473 rows.
2026-01-26 00:48:24,959 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 00:48:24,967 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:24,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 00:48:24,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 231 rows.
2026-01-26 00:48:24,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 00:48:24,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:24,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 00:48:25,012 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 00:48:25,012 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 00:48:25,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 00:48:25,018 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 00:48:25,189 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:48:25,215 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 00:48:25,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 493 rows.
2026-01-26 00:48:25,246 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 00:48:25,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 00:48:25,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 00:48:25,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 00:48:25,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 00:48:25,460 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:48:25,473 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 00:48:25,478 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:25,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 00:48:26,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10000 rows.
2026-01-26 00:48:26,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 00:48:26,334 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9999 rows.
2026-01-26 00:48:26,342 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 00:48:26,342 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 00:48:26,350 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 00:48:26,353 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,354 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 00:48:26,359 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,359 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 00:48:26,368 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,371 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 00:48:26,376 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,376 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 00:48:26,384 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,384 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 00:48:26,392 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,393 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 00:48:26,398 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,401 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 00:48:26,403 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,406 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 00:48:26,408 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,408 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 00:48:26,416 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 00:48:26,419 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 00:48:26,419 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 00:48:26,419 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT history_id FROM query_history WHERE history_id IS NOT NULL
2026-01-26 00:48:26,419 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:26,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 00:48:26,438 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:26,438 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT natural_query FROM query_history WHERE natural_query IS NOT NULL
2026-01-26 00:48:26,443 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:26,445 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT sql_query FROM query_history WHERE sql_query IS NOT NULL
2026-01-26 00:48:26,451 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:26,451 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT execution_time_ms FROM query_history WHERE execution_time_ms IS NOT NULL
2026-01-26 00:48:26,454 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:26,459 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM query_history WHERE status IS NOT NULL
2026-01-26 00:48:26,466 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:26,468 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 00:48:26,474 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 00:48:30,128 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 00:48:35,667 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the split of VERFIED kyc status split by countires | Domain: compliance
2026-01-26 00:48:35,678 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 00:48:35,681 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the split of VERFIED kyc status split by countires
2026-01-26 00:48:36,009 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 00:48:36,723 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 00:48:36,725 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 00:48:36,754 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 00:48:37,447 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 00:48:38,109 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-26 00:48:38,109 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'kyc_status': 'VERIFIED'}
2026-01-26 00:48:38,141 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 00:48:38,147 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: give me the split of VERFIED kyc status split by countires
2026-01-26 00:48:38,729 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 00:48:39,395 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT country, COUNT(*) FROM users WHERE kyc_stat...
2026-01-26 00:48:39,395 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT country, COUNT(*) FROM users WHERE kyc_stat...
2026-01-26 00:48:39,435 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT country, COUNT(*) FROM users WHERE kyc_stat...
2026-01-26 00:48:39,450 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 00:48:39,499 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 00:48:39,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT country, COUNT(*) FROM users WHERE kyc_status = 'VERIFIED' GROUP BY country
2026-01-26 00:48:39,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 16 rows.
2026-01-26 00:48:39,542 - nl2sql - INFO - workflow.py:92 - Query execution returned 16 rows.
2026-01-26 00:48:39,549 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 00:48:40,598 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Verif...
2026-01-26 00:48:40,604 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the split of VERFIED kyc status split by countires
2026-01-26 00:48:40,604 - nl2sql - INFO - endpoints.py:48 - Query success! 16 rows returned.
2026-01-26 00:49:01,909 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:55:39,653 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:57:17,324 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 00:58:28,586 - nl2sql - ERROR - llm.py:66 - LLM Error: Timeout of 600.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNAVAILABLE: ipv4:127.0.0.1:9: ConnectEx: Connection refused (No connection could be made because the target machine actively refused it.
 -- 10061)
2026-01-26 01:13:14,073 - nl2sql - INFO - endpoints.py:14 - Incoming query: How can you help me ? | Domain: risk
2026-01-26 01:13:14,105 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:13:14,109 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: How can you help me ?
2026-01-26 01:13:14,384 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:13:15,572 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-26 01:13:15,575 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-26 01:13:15,592 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-26 01:13:16,057 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:13:16,682 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 01:13:16,682 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 01:13:17,025 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-26 01:13:22,821 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As your Database Expert, I can help you understand...
2026-01-26 01:13:22,827 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: How can you help me ?
2026-01-26 01:14:00,208 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me distribution of users by KYC status | Domain: risk
2026-01-26 01:14:00,213 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:14:00,215 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: give me distribution of users by KYC status
2026-01-26 01:14:00,463 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:14:01,116 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 01:14:01,117 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:14:01,138 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:14:01,652 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:14:02,390 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-26 01:14:02,390 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'kyc_status': ['VERIFIED', 'UNVERIFIED', 'PENDING', 'EXPIRED']}
2026-01-26 01:14:02,417 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 01:14:02,417 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: give me distribution of users by KYC status
2026-01-26 01:14:02,854 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-26 01:14:03,434 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT kyc_status, COUNT(*) AS user_count
FROM use...
2026-01-26 01:14:03,434 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT kyc_status, COUNT(*) AS user_count
FROM use...
2026-01-26 01:14:03,456 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT kyc_status, COUNT(*) AS user_count
FROM use...
2026-01-26 01:14:03,459 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:14:03,496 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 01:14:03,498 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT kyc_status, COUNT(*) AS user_count
FROM users
GROUP BY kyc_status;
2026-01-26 01:14:03,513 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:14:03,518 - nl2sql - INFO - workflow.py:92 - Query execution returned 4 rows.
2026-01-26 01:14:03,527 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 01:14:04,436 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Distr...
2026-01-26 01:14:04,438 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me distribution of users by KYC status
2026-01-26 01:14:04,446 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-26 01:14:18,140 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the login patterns for our users? | Domain: risk
2026-01-26 01:14:18,154 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:14:18,163 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: What are the login patterns for our users?
2026-01-26 01:14:18,528 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:14:19,264 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 01:14:19,266 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:14:19,288 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:14:19,972 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:14:20,866 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 01:14:20,869 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 01:14:20,917 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 01:14:20,923 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: What are the login patterns for our users?
2026-01-26 01:14:21,640 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-26 01:14:22,336 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT ip_address, country, city, device_type, use...
2026-01-26 01:14:22,337 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT ip_address, country, city, device_type, use...
2026-01-26 01:14:22,346 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT ip_address, country, city, device_type, use...
2026-01-26 01:14:22,356 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:14:22,366 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 01:14:22,367 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT ip_address, country, city, device_type, user_agent, status, failure_reason, created_at FROM login_events
2026-01-26 01:14:22,782 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20000 rows.
2026-01-26 01:14:22,784 - nl2sql - INFO - workflow.py:92 - Query execution returned 20000 rows.
2026-01-26 01:14:22,788 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 01:14:23,645 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Login...
2026-01-26 01:14:23,652 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the login patterns for our users?
2026-01-26 01:14:23,655 - nl2sql - INFO - endpoints.py:48 - Query success! 20000 rows returned.
2026-01-26 01:15:40,496 - nl2sql - INFO - endpoints.py:14 - Incoming query: what is your speciality | Domain: compliance
2026-01-26 01:15:40,503 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:15:40,506 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what is your speciality
2026-01-26 01:15:40,830 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:15:41,919 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-26 01:15:41,922 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-26 01:15:41,950 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-26 01:15:42,577 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:15:43,145 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-01-26 01:15:43,145 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 01:15:43,488 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-26 01:15:47,837 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As a Database Expert specializing in compliance an...
2026-01-26 01:15:47,842 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what is your speciality
2026-01-26 01:16:27,057 - nl2sql - INFO - endpoints.py:14 - Incoming query: How many users have a HIGH-risk level, and what are their associated account statuses? | Domain: compliance
2026-01-26 01:16:27,067 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:16:27,071 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How many users have a HIGH-risk level, and what are their associated account statuses?
2026-01-26 01:16:27,317 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:16:28,059 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 01:16:28,064 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:16:28,082 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:16:28,638 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:16:29,440 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_level...
2026-01-26 01:16:29,442 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': 'HIGH'}
2026-01-26 01:16:29,483 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 01:16:29,484 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: How many users have a HIGH-risk level, and what are their associated account statuses?
2026-01-26 01:16:30,038 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 01:16:30,652 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT count(*), account_status FROM users WHERE r...
2026-01-26 01:16:30,654 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT count(*), account_status FROM users WHERE r...
2026-01-26 01:16:30,671 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT count(*), account_status FROM users WHERE r...
2026-01-26 01:16:30,711 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:16:30,729 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 01:16:30,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT count(*), account_status FROM users WHERE risk_level = 'HIGH' GROUP BY account_status
2026-01-26 01:16:30,755 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:16:30,757 - nl2sql - INFO - workflow.py:92 - Query execution returned 3 rows.
2026-01-26 01:16:30,760 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 01:16:31,781 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "User ...
2026-01-26 01:16:31,791 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How many users have a HIGH-risk level, and what are their associated account statuses?
2026-01-26 01:16:31,797 - nl2sql - INFO - endpoints.py:48 - Query success! 3 rows returned.
2026-01-26 01:16:50,970 - nl2sql - INFO - endpoints.py:14 - Incoming query: Summarize key compliance metrics (e.g., number of verified users, total compliant transactions). | Domain: compliance
2026-01-26 01:16:50,976 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:16:50,984 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Summarize key compliance metrics (e.g., number of verified users, total compliant transactions).
2026-01-26 01:16:51,259 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:16:51,998 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 01:16:52,000 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 01:16:52,018 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 01:16:52,649 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:16:53,292 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 01:16:53,295 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 01:16:53,322 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 01:16:53,322 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Summarize key compliance metrics (e.g., number of verified users, total compliant transactions).
2026-01-26 01:16:53,995 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 01:16:55,079 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT
  (SELECT COUNT(*) FROM users WHERE kyc_sta...
2026-01-26 01:16:55,081 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT
  (SELECT COUNT(*) FROM users WHERE kyc_sta...
2026-01-26 01:16:55,094 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT
  (SELECT COUNT(*) FROM users WHERE kyc_sta...
2026-01-26 01:16:55,104 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:16:55,134 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 01:16:55,139 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT
  (SELECT COUNT(*) FROM users WHERE kyc_status = 'VERIFIED') AS verified_users_count,
  (SELECT COUNT(*) FROM transactions WHERE status = 'COMPLETED') AS compliant_transactions_count,
  (SELECT COUNT(*) FROM users WHERE risk_level = 'HIGH') AS high_risk_users_count,
  (SELECT COUNT(*) FROM alerts WHERE status = 'OPEN') AS open_alerts_count;
2026-01-26 01:16:55,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:16:55,284 - nl2sql - INFO - workflow.py:92 - Query execution returned 1 rows.
2026-01-26 01:16:55,288 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 01:16:56,128 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Key C...
2026-01-26 01:16:56,133 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Summarize key compliance metrics (e.g., number of verified users, total compliant transactions).
2026-01-26 01:16:56,142 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 01:18:08,770 - nl2sql - INFO - endpoints.py:14 - Incoming query: Can we track all system actions related to a particular user? user_id 1 | Domain: compliance
2026-01-26 01:18:08,781 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:18:08,785 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Can we track all system actions related to a particular user? user_id 1
2026-01-26 01:18:09,062 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:18:10,004 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 01:18:10,008 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 01:18:10,034 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 01:18:10,689 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:18:11,739 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "actor_id":...
2026-01-26 01:18:11,747 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'actor_id': '1'}
2026-01-26 01:18:11,792 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 01:18:11,795 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Can we track all system actions related to a particular user? user_id 1
2026-01-26 01:18:12,497 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 01:18:13,048 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM audit_logs WHERE actor_id = 1...
2026-01-26 01:18:13,055 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT * FROM audit_logs WHERE actor_id = 1...
2026-01-26 01:18:13,135 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM audit_logs WHERE actor_id = 1...
2026-01-26 01:18:13,161 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:18:13,236 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 01:18:13,249 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM audit_logs WHERE actor_id = 1
2026-01-26 01:18:13,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:18:13,378 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-26 01:18:13,430 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Can we track all system actions related to a particular user? user_id 1
2026-01-26 01:18:13,445 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 01:19:04,109 - nl2sql - INFO - endpoints.py:14 - Incoming query: How do alert severities correlate with user risk levels? | Domain: compliance
2026-01-26 01:19:04,113 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:19:04,119 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How do alert severities correlate with user risk levels?
2026-01-26 01:19:04,413 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:19:04,993 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 01:19:05,003 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 01:19:05,021 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 01:19:05,588 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:19:06,243 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 01:19:06,244 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 01:19:06,280 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 01:19:06,285 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: How do alert severities correlate with user risk levels?
2026-01-26 01:19:06,809 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 01:19:07,723 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT
  ar.severity,
  u.risk_level,
  COUNT(a.al...
2026-01-26 01:19:07,728 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT
  ar.severity,
  u.risk_level,
  COUNT(a.al...
2026-01-26 01:19:07,751 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT
  ar.severity,
  u.risk_level,
  COUNT(a.al...
2026-01-26 01:19:07,759 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:19:07,803 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 01:19:07,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT
  ar.severity,
  u.risk_level,
  COUNT(a.alert_id) AS alert_count
FROM alerts AS a
JOIN alert_rules AS ar
  ON a.rule_id = ar.rule_id
JOIN users AS u
  ON a.user_id = u.user_id
GROUP BY
  ar.severity,
  u.risk_level
ORDER BY
  ar.severity,
  u.risk_level;
2026-01-26 01:19:07,839 - nl2sql - INFO - database.py:60 - Execution complete. Returned 11 rows.
2026-01-26 01:19:07,843 - nl2sql - INFO - workflow.py:92 - Query execution returned 11 rows.
2026-01-26 01:19:07,849 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 01:19:08,738 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Alert...
2026-01-26 01:19:08,741 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How do alert severities correlate with user risk levels?
2026-01-26 01:19:08,742 - nl2sql - INFO - endpoints.py:48 - Query success! 11 rows returned.
2026-01-26 01:19:36,577 - nl2sql - INFO - endpoints.py:14 - Incoming query: What is the trend of user account statuses over time? | Domain: compliance
2026-01-26 01:19:36,584 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:19:36,590 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What is the trend of user account statuses over time?
2026-01-26 01:19:36,920 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:19:37,313 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {"intent": "SELECT", "confidence": 1.0, "complexit...
2026-01-26 01:19:37,314 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:19:37,338 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:19:37,977 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:19:38,758 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 01:19:38,759 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 01:19:38,801 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-26 01:19:38,805 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What is the trend of user account statuses over time?
2026-01-26 01:19:39,478 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 01:19:40,417 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The provided schema does not contain inform...
2026-01-26 01:19:40,423 - nl2sql - WARNING - sql_generation.py:87 - SQL Generation guidance response for query: What is the trend of user account statuses over time? | Msg: Error: The provided schema does not contain inform...
2026-01-26 01:19:40,450 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The provided schema does not contain inform...
2026-01-26 01:19:40,459 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:19:40,468 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Error tokenizing 'ry asking about: users, transactions, login_event'
2026-01-26 01:19:40,507 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 01:19:45,795 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: -- Since the provided schema lacks historical trac...
2026-01-26 01:19:45,799 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-26 01:19:45,823 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-26 01:19:45,833 - nl2sql - INFO - database.py:53 - Executing SQL: -- Since the provided schema lacks historical tracking for account status changes,
-- a query to determine the trend of user account statuses over time cannot be
-- directly constructed from the `users` table alone.
--
-- To address this, we would typically need a table that logs account status
-- changes with associated timestamps. For example, a `user_status_history`
-- table with columns like `user_id`, `account_status`, and `timestamp`.
--
-- Without such a table, we can only provide the current status of users.
--
-- If you were to have a `user_status_history` table, a query might look like this:
--
-- SELECT
--   DATE(timestamp) AS status_date,
--   account_status,
--   COUNT(*) AS number_of_users
-- FROM
--   user_status_history
-- GROUP BY
--   DATE(timestamp),
--   account_status
-- ORDER BY
--   status_date,
--   account_status;
--
-- As a fallback, and acknowledging the limitation, if the intent was to just
-- see the current distribution of account statuses, that would be:
--
-- SELECT
--   account_status,
--   COUNT(*) AS number_of_users
-- FROM
--   users
-- GROUP BY
--   account_status;
--
-- Since the request is specifically about "trend over time" and the schema
-- doesn't support it, the original query might have been an attempt to
-- extrapolate or was based on an incorrect assumption about the schema.
-- The error message "The provided schema does not contain information to track the historical trend of user account statuses" confirms this.
--
-- The provided error message also contains a typo: "ry asking about: users, transactions, login_event" which suggests a potential conversational AI context where it was trying to suggest valid queries based on available tables.
--
-- Given the constraints, a valid SQL query cannot fulfill the original request about historical trends. The best we can do is acknowledge the limitation.
--
-- If you intended to ask about something else that IS supported by the schema, please clarify. For instance, if you meant to query transactions or login events.

-- **Based on the explicit error message, no valid SQL query can be generated for the requested trend over time using the provided schema.**
-- The following is a placeholder to acknowledge the inability to fulfill the request due to schema limitations.
-- If the system requires a SQL query to be returned regardless, this is a non-operational query that highlights the issue.

-- SELECT 'Schema does not support historical account status trends' AS message;
-- Since I must return ONLY the corrected SQL query and the original query is invalid
-- due to schema limitations, and no valid query can fulfill the original request,
-- I will return an empty query or a query that reflects the limitation.
-- The error message itself suggests "try asking about: users, transactions, login_events".
-- This implies that the AI was unable to construct a query for "user account statuses over time".

-- The most direct fix to make it syntactically valid if it were trying to select from `users` and perhaps sort,
-- but still not answering the trend question, would involve correct syntax.
-- However, the error message indicates the fundamental problem is the *lack of data*.

-- Given the instruction "Return ONLY the corrected SQL query.", and that the original query is invalid and the request cannot be fulfilled by the schema,
-- I cannot provide a valid SQL query that answers the original request.
-- The error message "Error tokenizing 'ry asking about: users, transactions, login_event'" is a syntax error in the *error message itself*, not necessarily the query that preceded it.
-- The primary error is "The provided schema does not contain information to track the historical trend of user account statuses."

-- If I *must* return a syntactically valid SQLite query, and acknowledging that it *cannot* answer the original question,
-- I will provide a query that represents the *current* state, as that's the closest possible information available.
-- But this does not answer "over time".

-- As per the strict instructions to return ONLY the corrected SQL query, and given that the original request is unfulfillable due to schema limitations,
-- I cannot produce a valid query that addresses the "trend over time".
-- I will provide a query that lists the current account statuses, as this is derived from the `users` table mentioned in the error, even though it doesn't address the "trend".

-- SELECT account_status, COUNT(*) FROM users GROUP BY account_status;

-- Re-reading the prompt: "Please fix the SQL query to be valid SQLite syntax. Return ONLY the corrected SQL query."
-- The *provided* SQL query was invalid. I do not have the original invalid SQL. I only have the error message.
-- The error message is "Error: The provided schema does not contain information to track the historical trend of user account statuses. The `users` table has an `account_status` column, but it doesn't include a timestamp for when the status changed. Try asking about: users, transactions, login_events"
-- And then "Error: Error tokenizing 'ry asking about: users, transactions, login_event'"

-- This implies the user *tried* to ask for a trend, and the system responded with an error.
-- I am tasked to fix "the SQL query" to be valid. If the SQL query was never provided to me, but only the *result of its execution*, I must infer what a *corrected* query *could* be, given the context.

-- The error message clearly states the schema *lacks historical data*.
-- Therefore, *any* query attempting to show a trend over time for `account_status` will be invalid *in its intent*, even if syntactically correct.

-- If the instruction is to fix a *hypothetical* invalid query that *tried* to ask for a trend, and the fix must result in a *valid SQLite syntax*,
-- I should provide something that *is* valid SQLite, but perhaps acknowledges the limitation or offers an alternative.
-- However, the prompt strictly says "Return ONLY the corrected SQL query." and "No markdown, no explanations."

-- The error message also has a syntax error itself: "Error tokenizing 'ry asking about: users, transactions, login_event'".
-- This suggests the system that generated the error might have had an issue.

-- Given the constraint to return *only* the query, and the impossibility of fulfilling the original request with the described schema,
-- I will return a syntactically valid SQLite query that reflects the *current* distribution of account statuses. This is the closest actionable information from the `users` table mentioned.

SELECT
  account_status,
  COUNT(*) AS user_count
FROM
  users
GROUP BY
  account_status;
2026-01-26 01:19:45,877 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:19:45,882 - nl2sql - INFO - workflow.py:92 - Query execution returned 4 rows.
2026-01-26 01:19:45,890 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 01:19:46,787 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Curre...
2026-01-26 01:19:46,794 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What is the trend of user account statuses over time?
2026-01-26 01:19:46,797 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-26 01:21:30,590 - nl2sql - INFO - endpoints.py:14 - Incoming query: what is the current domain i have selected | Domain: compliance
2026-01-26 01:21:30,595 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:21:30,595 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what is the current domain i have selected
2026-01-26 01:21:30,898 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:21:31,928 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-26 01:21:31,930 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-26 01:21:31,955 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-26 01:21:32,568 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:21:33,535 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 01:21:33,539 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 01:21:33,884 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-26 01:21:37,666 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As a Database Expert, I can help you understand th...
2026-01-26 01:21:37,667 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what is the current domain i have selected
2026-01-26 01:22:58,737 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:22:58,737 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:22:59,100 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 01:22:59,105 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 01:23:15,303 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:23:15,334 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:23:15,525 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 01:23:15,549 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 01:26:30,432 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)? | Domain: compliance
2026-01-26 01:26:30,455 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-26 01:26:30,459 - nl2sql - INFO - workflow.py:23 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 01:29:07,127 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:29:07,130 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:29:07,324 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 01:29:07,328 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 01:29:32,425 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)? | Domain: compliance
2026-01-26 01:29:32,433 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 01:29:32,435 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 01:29:32,437 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 01:29:32,740 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 01:29:33,970 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 01:29:33,971 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:29:34,501 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 01:29:35,233 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "login_stat...
2026-01-26 01:29:35,234 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'login_status': 'SUCCESS'}
2026-01-26 01:29:35,277 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 01:29:35,277 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 01:29:35,292 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 01:29:35,750 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 01:29:36,575 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT STRFTIME('%H', created_at) AS hour_of_day, ...
2026-01-26 01:29:36,577 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT STRFTIME('%H', created_at) AS hour_of_day, ...
2026-01-26 01:29:36,596 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT STRFTIME('%H', created_at) AS hour_of_day, ...
2026-01-26 01:29:36,606 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 01:29:36,611 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 01:29:36,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT STRFTIME('%H', created_at) AS hour_of_day, COUNT(*) AS login_count
FROM login_events
WHERE status = 'SUCCESS'
GROUP BY hour_of_day
ORDER BY hour_of_day;
2026-01-26 01:29:36,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:29:36,628 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 01:29:36,641 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 01:29:36,642 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 01:36:21,473 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:36:21,478 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 01:36:21,481 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:21,481 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 01:36:21,483 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:21,483 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 01:36:21,488 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:21,490 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 01:36:21,491 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:21,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 01:36:21,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:21,498 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 01:36:21,500 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:21,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 01:36:21,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 01:36:21,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 01:36:21,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:21,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 01:36:21,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 01:36:21,516 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,516 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 01:36:21,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:21,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 01:36:21,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 64 rows.
2026-01-26 01:36:21,518 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 01:36:21,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:21,526 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 01:36:21,528 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:21,529 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 01:36:21,530 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:21,532 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 01:36:21,532 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:21,532 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 01:36:21,536 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 01:36:21,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 01:36:21,538 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:21,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 01:36:21,545 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:21,545 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 01:36:21,545 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 01:36:21,545 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 01:36:21,545 - nl2sql - INFO - database.py:60 - Execution complete. Returned 24 rows.
2026-01-26 01:36:21,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 01:36:21,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:21,558 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 01:36:21,561 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:21,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 01:36:21,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:21,566 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 01:36:21,567 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:21,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 01:36:21,570 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:21,572 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 01:36:21,572 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:21,572 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 01:36:21,572 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:21,572 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 01:36:21,582 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:21,582 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 01:36:21,585 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:21,585 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 01:36:21,587 - nl2sql - INFO - database.py:60 - Execution complete. Returned 447 rows.
2026-01-26 01:36:21,587 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 01:36:21,587 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:21,587 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 01:36:21,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:21,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 01:36:21,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 84 rows.
2026-01-26 01:36:21,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 01:36:21,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 198 rows.
2026-01-26 01:36:21,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 01:36:21,610 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:21,611 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 01:36:21,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:21,611 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 01:36:21,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 51 rows.
2026-01-26 01:36:21,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 01:36:21,618 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:21,619 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 01:36:21,619 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:21,619 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 01:36:21,619 - nl2sql - INFO - database.py:60 - Execution complete. Returned 35 rows.
2026-01-26 01:36:21,619 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 01:36:21,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:21,627 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 01:36:21,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 01:36:21,627 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 01:36:21,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:21,634 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 01:36:21,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:21,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 01:36:21,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:21,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 01:36:21,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:21,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 01:36:21,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:21,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 01:36:21,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:21,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 01:36:21,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:21,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 01:36:21,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:21,652 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 01:36:21,653 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:21,653 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 01:36:21,653 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:21,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 01:36:21,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 01:36:21,661 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 01:36:21,661 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 01:36:21,661 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 01:36:21,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,668 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 01:36:21,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 01:36:21,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 01:36:21,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 01:36:21,676 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,676 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 01:36:21,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,677 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 01:36:21,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,677 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 01:36:21,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,677 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 01:36:21,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:21,688 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 01:36:21,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,688 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 01:36:21,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 01:36:21,694 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,694 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 01:36:21,694 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,694 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 01:36:21,694 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,694 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 01:36:21,702 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,702 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 01:36:21,703 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,703 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 01:36:21,708 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,709 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 01:36:21,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:21,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 01:36:21,710 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 01:36:21,714 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 01:36:21,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,719 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,720 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 01:36:21,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,733 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 01:36:21,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:21,733 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL
2026-01-26 01:36:21,737 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,737 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 01:36:21,739 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,739 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL
2026-01-26 01:36:21,739 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL
2026-01-26 01:36:21,741 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,743 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL
2026-01-26 01:36:21,743 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,743 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL
2026-01-26 01:36:21,743 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,743 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 01:36:21,743 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:21,955 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 01:36:25,067 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 01:36:25,080 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 01:36:25,082 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:25,083 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 01:36:25,084 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:25,085 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 01:36:25,086 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:25,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 01:36:25,089 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:25,091 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 01:36:25,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:25,094 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 01:36:25,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:25,094 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 01:36:25,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,099 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 01:36:25,099 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,099 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 01:36:25,099 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:25,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 01:36:25,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,107 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 01:36:25,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 01:36:25,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:25,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 01:36:25,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 64 rows.
2026-01-26 01:36:25,115 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 01:36:25,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:25,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 01:36:25,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:25,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 01:36:25,120 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:25,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 01:36:25,120 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:25,120 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 01:36:25,120 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 01:36:25,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 01:36:25,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:25,131 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 01:36:25,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:25,134 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 01:36:25,134 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 01:36:25,136 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 01:36:25,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 24 rows.
2026-01-26 01:36:25,139 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 01:36:25,142 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:25,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 01:36:25,142 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:25,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 01:36:25,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:25,148 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 01:36:25,148 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:25,148 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 01:36:25,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:25,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 01:36:25,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:25,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 01:36:25,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:25,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 01:36:25,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:25,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 01:36:25,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:25,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 01:36:25,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 447 rows.
2026-01-26 01:36:25,180 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 01:36:25,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:25,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 01:36:25,185 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:25,188 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 01:36:25,190 - nl2sql - INFO - database.py:60 - Execution complete. Returned 84 rows.
2026-01-26 01:36:25,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 01:36:25,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 198 rows.
2026-01-26 01:36:25,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 01:36:25,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:25,198 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 01:36:25,200 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:25,200 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 01:36:25,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 51 rows.
2026-01-26 01:36:25,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 01:36:25,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:25,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 01:36:25,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:25,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 01:36:25,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 35 rows.
2026-01-26 01:36:25,213 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 01:36:25,214 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:25,215 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 01:36:25,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 01:36:25,217 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 01:36:25,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:25,221 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 01:36:25,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:25,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 01:36:25,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:25,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 01:36:25,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:25,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 01:36:25,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:25,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 01:36:25,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:25,234 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 01:36:25,236 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:25,237 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 01:36:25,239 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:25,240 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 01:36:25,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:25,243 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 01:36:25,243 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:25,245 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 01:36:25,246 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,247 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 01:36:25,249 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,249 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 01:36:25,251 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,251 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 01:36:25,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 01:36:25,256 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,256 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 01:36:25,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 01:36:25,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 01:36:25,263 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,264 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 01:36:25,266 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 01:36:25,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,270 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 01:36:25,272 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 01:36:25,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,275 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 01:36:25,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:25,277 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 01:36:25,279 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 01:36:25,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 01:36:25,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 01:36:25,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,288 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 01:36:25,289 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 01:36:25,291 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 01:36:25,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,292 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 01:36:25,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,298 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 01:36:25,299 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:25,300 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 01:36:25,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,300 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 01:36:25,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 01:36:25,307 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,308 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 01:36:25,308 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,310 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 01:36:25,313 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,313 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 01:36:25,314 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,316 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 01:36:25,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,318 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 01:36:25,321 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,321 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 01:36:25,323 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,324 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 01:36:25,325 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,327 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 01:36:25,329 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:25,330 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL
2026-01-26 01:36:25,333 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,334 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 01:36:25,334 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,334 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL
2026-01-26 01:36:25,339 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,340 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL
2026-01-26 01:36:25,342 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL
2026-01-26 01:36:25,343 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,343 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL
2026-01-26 01:36:25,347 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,348 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 01:36:25,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:25,595 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 01:36:29,991 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 01:36:30,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 01:36:30,004 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:30,004 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 01:36:30,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:30,005 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 01:36:30,006 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:30,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 01:36:30,008 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:30,010 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 01:36:30,011 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:30,011 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 01:36:30,013 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:30,014 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 01:36:30,015 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 01:36:30,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 01:36:30,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:30,018 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 01:36:30,019 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 01:36:30,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 01:36:30,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:30,024 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 01:36:30,025 - nl2sql - INFO - database.py:60 - Execution complete. Returned 64 rows.
2026-01-26 01:36:30,025 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 01:36:30,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:30,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 01:36:30,029 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:30,030 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 01:36:30,030 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:30,030 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 01:36:30,030 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:30,030 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 01:36:30,036 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 01:36:30,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 01:36:30,038 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:30,038 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 01:36:30,038 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:30,044 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 01:36:30,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 01:36:30,046 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 01:36:30,046 - nl2sql - INFO - database.py:60 - Execution complete. Returned 24 rows.
2026-01-26 01:36:30,046 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 01:36:30,046 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:30,046 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 01:36:30,052 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:30,052 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 01:36:30,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:30,055 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 01:36:30,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:30,055 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 01:36:30,058 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:30,060 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 01:36:30,061 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:30,062 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 01:36:30,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:30,066 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 01:36:30,069 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:30,070 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 01:36:30,070 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:30,070 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 01:36:30,076 - nl2sql - INFO - database.py:60 - Execution complete. Returned 447 rows.
2026-01-26 01:36:30,077 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 01:36:30,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:30,077 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 01:36:30,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:30,077 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 01:36:30,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 84 rows.
2026-01-26 01:36:30,077 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 01:36:30,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 198 rows.
2026-01-26 01:36:30,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 01:36:30,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:30,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 01:36:30,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:30,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 01:36:30,095 - nl2sql - INFO - database.py:60 - Execution complete. Returned 51 rows.
2026-01-26 01:36:30,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 01:36:30,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:30,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 01:36:30,097 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:30,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 01:36:30,102 - nl2sql - INFO - database.py:60 - Execution complete. Returned 35 rows.
2026-01-26 01:36:30,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 01:36:30,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:30,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 01:36:30,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 01:36:30,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 01:36:30,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:30,110 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 01:36:30,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:30,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 01:36:30,114 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:30,114 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 01:36:30,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:30,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 01:36:30,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:30,119 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 01:36:30,120 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:30,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 01:36:30,120 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:30,120 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 01:36:30,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:30,124 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 01:36:30,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:30,127 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 01:36:30,128 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:30,129 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 01:36:30,129 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,129 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 01:36:30,129 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,129 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 01:36:30,129 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,136 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 01:36:30,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 01:36:30,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 01:36:30,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 01:36:30,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 01:36:30,144 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,145 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 01:36:30,147 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,147 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 01:36:30,147 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,147 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 01:36:30,151 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 01:36:30,153 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,154 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 01:36:30,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:30,154 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 01:36:30,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 01:36:30,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,160 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 01:36:30,161 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 01:36:30,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 01:36:30,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,166 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 01:36:30,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 01:36:30,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 01:36:30,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,170 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 01:36:30,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:30,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 01:36:30,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 01:36:30,176 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 01:36:30,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 01:36:30,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 01:36:30,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 01:36:30,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,185 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 01:36:30,185 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,185 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 01:36:30,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 01:36:30,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 01:36:30,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,187 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 01:36:30,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:30,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL
2026-01-26 01:36:30,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 01:36:30,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL
2026-01-26 01:36:30,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL
2026-01-26 01:36:30,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL
2026-01-26 01:36:30,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL
2026-01-26 01:36:30,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 01:36:30,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:30,383 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 01:36:33,985 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "This databa...
2026-01-26 01:36:33,997 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 01:36:33,999 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:33,999 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 01:36:34,000 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:34,001 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 01:36:34,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:34,003 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 01:36:34,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:34,006 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 01:36:34,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:34,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 01:36:34,009 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:34,009 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 01:36:34,010 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,011 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 01:36:34,012 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 01:36:34,014 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:34,014 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 01:36:34,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 01:36:34,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,019 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 01:36:34,019 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:34,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 01:36:34,022 - nl2sql - INFO - database.py:60 - Execution complete. Returned 64 rows.
2026-01-26 01:36:34,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 01:36:34,024 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:34,025 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 01:36:34,026 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:34,027 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 01:36:34,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:34,030 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 01:36:34,030 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:34,030 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 01:36:34,030 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 01:36:34,030 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 01:36:34,038 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:34,038 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 01:36:34,038 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:34,038 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 01:36:34,038 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 01:36:34,038 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 01:36:34,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 24 rows.
2026-01-26 01:36:34,045 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 01:36:34,048 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:34,050 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 01:36:34,050 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:34,052 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 01:36:34,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:34,055 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 01:36:34,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:34,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 01:36:34,058 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:34,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 01:36:34,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:34,063 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 01:36:34,066 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:34,066 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 01:36:34,068 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:34,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 01:36:34,068 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:34,068 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 01:36:34,078 - nl2sql - INFO - database.py:60 - Execution complete. Returned 447 rows.
2026-01-26 01:36:34,079 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 01:36:34,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:34,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 01:36:34,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:34,087 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 01:36:34,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 84 rows.
2026-01-26 01:36:34,090 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 01:36:34,092 - nl2sql - INFO - database.py:60 - Execution complete. Returned 198 rows.
2026-01-26 01:36:34,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 01:36:34,092 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:34,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 01:36:34,098 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:34,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 01:36:34,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 51 rows.
2026-01-26 01:36:34,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 01:36:34,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:34,105 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 01:36:34,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:34,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 01:36:34,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 35 rows.
2026-01-26 01:36:34,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 01:36:34,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:34,113 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 01:36:34,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 01:36:34,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 01:36:34,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:34,119 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 01:36:34,121 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:34,122 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:34,124 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 01:36:34,132 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:34,132 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 01:36:34,134 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:34,134 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 01:36:34,134 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:34,134 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 01:36:34,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:34,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 01:36:34,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 01:36:34,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 01:36:34,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,144 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 01:36:34,145 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 01:36:34,147 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,147 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 01:36:34,149 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,149 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 01:36:34,149 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,149 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 01:36:34,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 01:36:34,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,155 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 01:36:34,155 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,155 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 01:36:34,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,159 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 01:36:34,159 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,159 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 01:36:34,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:34,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 01:36:34,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 01:36:34,163 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,166 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 01:36:34,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 01:36:34,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 01:36:34,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,170 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 01:36:34,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 01:36:34,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 01:36:34,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,171 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 01:36:34,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:34,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 01:36:34,178 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 01:36:34,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 01:36:34,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 01:36:34,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 01:36:34,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,186 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 01:36:34,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,188 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 01:36:34,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,188 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 01:36:34,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,192 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 01:36:34,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,195 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 01:36:34,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,196 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 01:36:34,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:34,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL
2026-01-26 01:36:34,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 01:36:34,199 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,199 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL
2026-01-26 01:36:34,204 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,204 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL
2026-01-26 01:36:34,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,207 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL
2026-01-26 01:36:34,207 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL
2026-01-26 01:36:34,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 01:36:34,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:34,411 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 01:36:39,056 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "This databa...
2026-01-26 01:36:39,069 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 01:36:39,071 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:39,071 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 01:36:39,073 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:39,074 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL
2026-01-26 01:36:39,077 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:39,077 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL
2026-01-26 01:36:39,079 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:39,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL
2026-01-26 01:36:39,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:39,081 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL
2026-01-26 01:36:39,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:39,081 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL
2026-01-26 01:36:39,081 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL
2026-01-26 01:36:39,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL
2026-01-26 01:36:39,088 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:39,088 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL
2026-01-26 01:36:39,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,093 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL
2026-01-26 01:36:39,096 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,096 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL
2026-01-26 01:36:39,098 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:39,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL
2026-01-26 01:36:39,102 - nl2sql - INFO - database.py:60 - Execution complete. Returned 64 rows.
2026-01-26 01:36:39,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL
2026-01-26 01:36:39,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 01:36:39,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL
2026-01-26 01:36:39,107 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:39,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL
2026-01-26 01:36:39,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:39,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL
2026-01-26 01:36:39,113 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:39,115 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 01:36:39,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 01:36:39,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL
2026-01-26 01:36:39,121 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:39,123 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL
2026-01-26 01:36:39,124 - nl2sql - INFO - database.py:60 - Execution complete. Returned 100 rows.
2026-01-26 01:36:39,126 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL
2026-01-26 01:36:39,126 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 01:36:39,128 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL
2026-01-26 01:36:39,129 - nl2sql - INFO - database.py:60 - Execution complete. Returned 24 rows.
2026-01-26 01:36:39,131 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL
2026-01-26 01:36:39,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:39,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL
2026-01-26 01:36:39,138 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:39,138 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL
2026-01-26 01:36:39,142 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:39,145 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL
2026-01-26 01:36:39,146 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:39,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL
2026-01-26 01:36:39,146 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:39,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL
2026-01-26 01:36:39,146 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:39,146 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL
2026-01-26 01:36:39,156 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:39,158 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL
2026-01-26 01:36:39,161 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:39,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL
2026-01-26 01:36:39,166 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-01-26 01:36:39,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL
2026-01-26 01:36:39,170 - nl2sql - INFO - database.py:60 - Execution complete. Returned 447 rows.
2026-01-26 01:36:39,171 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 01:36:39,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:39,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL
2026-01-26 01:36:39,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:39,177 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL
2026-01-26 01:36:39,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 84 rows.
2026-01-26 01:36:39,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL
2026-01-26 01:36:39,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 198 rows.
2026-01-26 01:36:39,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL
2026-01-26 01:36:39,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:39,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL
2026-01-26 01:36:39,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 01:36:39,186 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL
2026-01-26 01:36:39,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 51 rows.
2026-01-26 01:36:39,188 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL
2026-01-26 01:36:39,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:39,188 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL
2026-01-26 01:36:39,188 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:39,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL
2026-01-26 01:36:39,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 35 rows.
2026-01-26 01:36:39,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL
2026-01-26 01:36:39,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 01:36:39,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL
2026-01-26 01:36:39,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 01:36:39,196 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL
2026-01-26 01:36:39,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 200 rows.
2026-01-26 01:36:39,204 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-26 01:36:39,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:39,205 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL
2026-01-26 01:36:39,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:39,208 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL
2026-01-26 01:36:39,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:39,211 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL
2026-01-26 01:36:39,213 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 01:36:39,215 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL
2026-01-26 01:36:39,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:39,216 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL
2026-01-26 01:36:39,217 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 01:36:39,217 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL
2026-01-26 01:36:39,220 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:39,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL
2026-01-26 01:36:39,222 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 01:36:39,222 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-26 01:36:39,222 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 01:36:39,222 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL
2026-01-26 01:36:39,222 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL
2026-01-26 01:36:39,229 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL
2026-01-26 01:36:39,229 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL
2026-01-26 01:36:39,229 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL
2026-01-26 01:36:39,229 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,235 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL
2026-01-26 01:36:39,236 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,236 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL
2026-01-26 01:36:39,248 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,248 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-26 01:36:39,248 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 01:36:39,248 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL
2026-01-26 01:36:39,248 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,248 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL
2026-01-26 01:36:39,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL
2026-01-26 01:36:39,254 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,254 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL
2026-01-26 01:36:39,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL
2026-01-26 01:36:39,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL
2026-01-26 01:36:39,258 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,258 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL
2026-01-26 01:36:39,264 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,264 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL
2026-01-26 01:36:39,266 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,266 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-26 01:36:39,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 01:36:39,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL
2026-01-26 01:36:39,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,279 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL
2026-01-26 01:36:39,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL
2026-01-26 01:36:39,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL
2026-01-26 01:36:39,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL
2026-01-26 01:36:39,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL
2026-01-26 01:36:39,304 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 01:36:39,545 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-26 01:36:44,967 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 01:37:10,170 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:37:10,186 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 01:37:14,298 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 01:37:14,299 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:48:21,261 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:48:21,501 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:48:36,554 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:48:36,808 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:50:22,649 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)? | Domain: general
2026-01-26 02:50:22,675 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 02:50:22,675 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 02:50:22,686 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 02:50:22,699 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 02:50:24,029 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 02:50:24,031 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 02:50:24,051 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 02:50:24,896 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "login_stat...
2026-01-26 02:50:24,897 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'login_status': 'SUCCESSFUL'}
2026-01-26 02:50:24,934 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 02:50:24,946 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 02:50:24,947 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 02:50:24,959 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-26 02:50:25,654 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT STRFTIME('%H', created_at) AS hour_of_day, ...
2026-01-26 02:50:25,654 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT STRFTIME('%H', created_at) AS hour_of_day, ...
2026-01-26 02:50:25,660 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT STRFTIME('%H', created_at) AS hour_of_day, ...
2026-01-26 02:50:25,664 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 02:50:25,674 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 02:50:25,679 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT STRFTIME('%H', created_at) AS hour_of_day, COUNT(*) AS login_count FROM login_events WHERE status = 'SUCCESS' GROUP BY hour_of_day ORDER BY hour_of_day
2026-01-26 02:50:25,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 02:50:25,692 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 02:50:25,699 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 02:50:25,704 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 02:50:51,138 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:50:51,299 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:51:09,691 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)? | Domain: security
2026-01-26 02:51:09,699 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 02:51:09,704 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 02:51:09,709 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 02:51:09,723 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 02:51:10,696 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 02:51:10,699 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 02:51:10,724 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 02:51:11,290 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "status": "...
2026-01-26 02:51:11,292 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'status': 'SUCCESSFUL'}
2026-01-26 02:51:11,328 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 02:51:11,346 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 02:51:11,349 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 02:51:11,367 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 02:51:12,088 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT strftime('%H', created_at) AS login_hour, C...
2026-01-26 02:51:12,088 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT strftime('%H', created_at) AS login_hour, C...
2026-01-26 02:51:12,090 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT strftime('%H', created_at) AS login_hour, C...
2026-01-26 02:51:12,104 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 02:51:12,128 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 02:51:12,131 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT strftime('%H', created_at) AS login_hour, COUNT(*) AS successful_logins
FROM login_events
WHERE status = 'Success'
GROUP BY login_hour
ORDER BY login_hour;
2026-01-26 02:51:12,147 - nl2sql - INFO - database.py:60 - Execution complete. Returned 24 rows.
2026-01-26 02:51:12,149 - nl2sql - INFO - workflow.py:101 - Query execution returned 24 rows.
2026-01-26 02:51:12,158 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 02:51:12,785 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "line",
  "title": "Syst...
2026-01-26 02:51:12,791 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the system-wide login trends (e.g., number of SUCCESSFUL logins per hour)?
2026-01-26 02:51:12,793 - nl2sql - INFO - endpoints.py:48 - Query success! 24 rows returned.
2026-01-26 02:54:38,619 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:54:38,907 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:54:40,098 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:54:40,342 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:54:47,583 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:54:47,631 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:54:47,781 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:54:47,829 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:55:00,273 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:55:00,346 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:55:00,568 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:55:00,644 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:55:24,189 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:55:24,363 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:55:53,945 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: compliance
2026-01-26 02:55:53,947 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 02:55:53,950 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 02:55:53,955 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What are the compliance violations in the last 30 days?
2026-01-26 02:55:53,977 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 02:55:54,998 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 02:55:54,999 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 02:55:55,009 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 02:55:55,910 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "compliance...
2026-01-26 02:55:55,910 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'compliance_violation': 'True'}
2026-01-26 02:55:55,942 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 02:55:55,959 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 02:55:55,960 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What are the compliance violations in the last 30 days?
2026-01-26 02:55:55,977 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 02:55:56,688 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE created_at BETWEEN date...
2026-01-26 02:55:56,698 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT * FROM alerts WHERE created_at BETWEEN date...
2026-01-26 02:55:56,700 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM alerts WHERE created_at BETWEEN date...
2026-01-26 02:55:56,711 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 02:55:56,722 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 02:55:56,727 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE created_at BETWEEN date('now', '-30 days') AND date('now')
2026-01-26 02:55:56,742 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 02:55:56,745 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 02:55:56,754 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 02:55:59,807 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "alert_id":...
2026-01-26 02:55:59,811 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 02:55:59,819 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the compliance violations in the last 30 days?
2026-01-26 02:55:59,820 - nl2sql - INFO - endpoints.py:48 - Query success! 7 rows returned.
2026-01-26 02:58:38,276 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:58:38,785 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:58:53,321 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:58:53,352 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:58:53,636 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:58:53,669 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:08,510 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:08,613 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:08,747 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:08,866 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:17,540 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:17,646 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:17,854 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:17,941 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:27,459 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:27,518 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:27,778 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:27,831 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:41,948 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:42,227 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 02:59:42,949 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 02:59:43,333 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 03:00:13,234 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 03:00:13,621 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 03:00:14,222 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 03:00:14,476 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 03:16:59,071 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 03:16:59,071 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 03:16:59,271 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 03:16:59,279 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 03:17:22,201 - nl2sql - INFO - endpoints.py:14 - Incoming query: "Show concentration risk - top 5 users by volume | Domain: compliance
2026-01-26 03:17:22,213 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 03:17:22,217 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 03:17:22,217 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: "Show concentration risk - top 5 users by volume
2026-01-26 03:17:22,251 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 03:17:23,513 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {"intent": "SELECT", "confidence": 1.0, "complexit...
2026-01-26 03:17:23,517 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 03:17:23,530 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 03:17:24,203 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_level...
2026-01-26 03:17:24,204 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': 'CONCENTRATION', 'transaction_type': 'TOP_5_USERS_BY_VOLUME'}
2026-01-26 03:17:24,236 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 03:17:24,248 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 03:17:24,253 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: "Show concentration risk - top 5 users by volume
2026-01-26 03:17:24,263 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 03:17:24,636 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, SUM(amount_usd) AS total_volume FR...
2026-01-26 03:17:24,637 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT user_id, SUM(amount_usd) AS total_volume FR...
2026-01-26 03:17:24,640 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT user_id, SUM(amount_usd) AS total_volume FR...
2026-01-26 03:17:24,646 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 03:17:24,661 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 03:17:24,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, SUM(amount_usd) AS total_volume FROM transactions GROUP BY user_id ORDER BY total_volume DESC LIMIT 5
2026-01-26 03:17:24,676 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 03:17:24,678 - nl2sql - INFO - workflow.py:101 - Query execution returned 5 rows.
2026-01-26 03:17:24,686 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 03:17:25,783 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Top 5...
2026-01-26 03:17:25,788 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: "Show concentration risk - top 5 users by volume
2026-01-26 03:17:25,794 - nl2sql - INFO - endpoints.py:48 - Query success! 5 rows returned.
2026-01-26 12:48:04,220 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 12:48:07,003 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 12:55:13,943 - nl2sql - INFO - endpoints.py:14 - Incoming query: How many users are active under the age of 30 | Domain: security
2026-01-26 12:55:13,971 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 12:55:13,973 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 12:55:13,979 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: How many users are active under the age of 30
2026-01-26 12:55:14,139 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 12:55:15,836 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 12:55:15,841 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:55:15,855 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 12:55:16,843 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "account_status": "...
2026-01-26 12:55:16,843 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'account_status': 'ACTIVE'}
2026-01-26 12:55:16,878 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:55:16,891 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 12:55:16,894 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: How many users are active under the age of 30
2026-01-26 12:55:16,912 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 12:55:18,067 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Cannot determine age from the provided sche...
2026-01-26 12:55:18,067 - nl2sql - WARNING - sql_generation.py:87 - SQL Generation guidance response for query: How many users are active under the age of 30 | Msg: Error: Cannot determine age from the provided sche...
2026-01-26 12:55:18,073 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error: Cannot determine age from the provided sche...
2026-01-26 12:55:18,083 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 12:55:18,089 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 23.
  Error: Cannot [4mdetermine[0m age from the provided schema. Try asking about: users.date_of_birth
2026-01-26 12:55:18,092 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 12:55:18,743 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT count(*) FROM users WHERE date_of_birth > d...
2026-01-26 12:55:18,749 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 12:55:18,767 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 12:55:18,769 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT count(*) FROM users WHERE date_of_birth > date('now', '-30 year')
2026-01-26 12:55:18,798 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 12:55:18,804 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 12:55:18,810 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 12:55:21,097 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "user_id": ...
2026-01-26 12:55:21,103 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 12:55:21,115 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How many users are active under the age of 30
2026-01-26 12:55:21,119 - nl2sql - INFO - endpoints.py:48 - Query success! 8 rows returned.
2026-01-26 12:56:32,817 - nl2sql - INFO - endpoints.py:14 - Incoming query: How can you help me? | Domain: compliance
2026-01-26 12:56:32,823 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 12:56:32,828 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 12:56:32,833 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How can you help me?
2026-01-26 12:56:32,867 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 12:56:33,823 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-26 12:56:33,830 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-26 12:56:33,845 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 12:56:34,355 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 12:56:34,359 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 12:56:34,379 - nl2sql - INFO - workflow.py:34 - Intent classified: SCHEMA_QUERY (conf: 0.9) | Needs Clarification: False
2026-01-26 12:56:34,395 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-26 12:56:42,031 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As a Database Expert, I can help you understand an...
2026-01-26 12:56:42,042 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: How can you help me?
2026-01-26 12:57:20,419 - nl2sql - INFO - endpoints.py:14 - Incoming query: What is the KYC status of a specific user, or how many users are in each KYC status? | Domain: compliance
2026-01-26 12:57:20,425 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 12:57:20,428 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 12:57:20,430 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What is the KYC status of a specific user, or how many users are in each KYC status?
2026-01-26 12:57:20,433 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 12:57:21,278 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 12:57:21,278 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:57:21,296 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 12:57:22,068 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-26 12:57:22,069 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'kyc_status': ['VERIFIED', 'UNVERIFIED', 'PENDING', 'FAILED']}
2026-01-26 12:57:22,085 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:57:22,093 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 12:57:22,094 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What is the KYC status of a specific user, or how many users are in each KYC status?
2026-01-26 12:57:22,105 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 12:57:23,002 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-26 12:57:23,005 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-26 12:57:23,008 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-26 12:57:23,008 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 12:57:23,018 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 12:57:23,025 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT kyc_status, COUNT(*) FROM users GROUP BY kyc_status
2026-01-26 12:57:23,043 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 12:57:23,043 - nl2sql - INFO - workflow.py:101 - Query execution returned 2 rows.
2026-01-26 12:57:23,047 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 12:57:24,240 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "User ...
2026-01-26 12:57:24,243 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What is the KYC status of a specific user, or how many users are in each KYC status?
2026-01-26 12:57:24,248 - nl2sql - INFO - endpoints.py:48 - Query success! 2 rows returned.
2026-01-26 12:57:47,814 - nl2sql - INFO - endpoints.py:14 - Incoming query: What is the kyc status of john_smith | Domain: compliance
2026-01-26 12:57:47,819 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 12:57:47,819 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 12:57:47,823 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What is the kyc status of john_smith
2026-01-26 12:57:47,835 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 12:57:48,641 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 12:57:48,644 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:57:48,664 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 12:57:49,174 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-26 12:57:49,174 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'kyc_status': 'VERIFIED'}
2026-01-26 12:57:49,198 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:57:49,208 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 12:57:49,208 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What is the kyc status of john_smith
2026-01-26 12:57:49,221 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 12:57:49,721 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT kyc_status FROM users WHERE full_name = 'jo...
2026-01-26 12:57:49,723 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT kyc_status FROM users WHERE full_name = 'jo...
2026-01-26 12:57:49,728 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT kyc_status FROM users WHERE full_name = 'jo...
2026-01-26 12:57:49,737 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 12:57:49,742 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 12:57:49,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT kyc_status FROM users WHERE full_name = 'john_smith'
2026-01-26 12:57:49,753 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 12:57:49,755 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 12:57:49,759 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 12:57:51,050 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "KYC...
2026-01-26 12:57:51,061 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What is the kyc status of john_smith
2026-01-26 12:57:51,064 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 12:58:04,742 - nl2sql - INFO - endpoints.py:14 - Incoming query: What is the age of john_smith | Domain: compliance
2026-01-26 12:58:04,746 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 12:58:04,748 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 12:58:04,751 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What is the age of john_smith
2026-01-26 12:58:04,760 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 12:58:05,592 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 12:58:05,598 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:58:05,608 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 12:58:06,647 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "user_id": "john_sm...
2026-01-26 12:58:06,651 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'user_id': 'john_smith'}
2026-01-26 12:58:06,682 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:58:06,693 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 12:58:06,699 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: What is the age of john_smith
2026-01-26 12:58:06,721 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 12:58:07,584 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Unable to determine age from the provided s...
2026-01-26 12:58:07,586 - nl2sql - WARNING - sql_generation.py:87 - SQL Generation guidance response for query: What is the age of john_smith | Msg: Error: Unable to determine age from the provided s...
2026-01-26 12:58:07,591 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error: Unable to determine age from the provided s...
2026-01-26 12:58:07,598 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 12:58:07,601 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 16.
  Error: Unable [4mto[0m determine age from the provided schema. The 'users' table contains 'date_of_birth' which can be use
2026-01-26 12:58:07,614 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 12:58:08,150 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT CAST(strftime('%Y.%m%d', 'now') - strftime(...
2026-01-26 12:58:08,156 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 12:58:08,171 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 12:58:08,175 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT CAST(strftime('%Y.%m%d', 'now') - strftime('%Y.%m%d', date_of_birth) AS INTEGER) FROM users WHERE name = 'john_smith'
2026-01-26 12:58:08,198 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: name
[SQL: SELECT CAST(strftime('%Y.%m%d', 'now') - strftime('%Y.%m%d', date_of_birth) AS INTEGER) FROM users WHERE name = 'john_smith']
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT CAST(strftime('%Y.%m%d', 'now') - strftime('%Y.%m%d', date_of_birth) AS INTEGER) FROM users WHERE name = 'john_smith'
2026-01-26 12:58:08,198 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 12:58:08,205 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 12:58:10,141 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "name": "jo...
2026-01-26 12:58:10,143 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 12:58:10,149 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What is the age of john_smith
2026-01-26 12:58:10,154 - nl2sql - INFO - endpoints.py:48 - Query success! 7 rows returned.
2026-01-26 12:58:57,419 - nl2sql - INFO - endpoints.py:14 - Incoming query: List of users with risk score more than 80 | Domain: compliance
2026-01-26 12:58:57,429 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 12:58:57,433 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 12:58:57,436 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: List of users with risk score more than 80
2026-01-26 12:58:57,442 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 12:58:58,217 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 12:58:58,217 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:58:58,242 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 12:58:59,106 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_level...
2026-01-26 12:58:59,108 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': '80'}
2026-01-26 12:58:59,131 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 12:58:59,139 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 12:58:59,143 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: List of users with risk score more than 80
2026-01-26 12:58:59,164 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 12:59:00,280 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, full_name, risk_score FROM users W...
2026-01-26 12:59:00,286 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT user_id, full_name, risk_score FROM users W...
2026-01-26 12:59:00,287 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT user_id, full_name, risk_score FROM users W...
2026-01-26 12:59:00,294 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 12:59:00,306 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 12:59:00,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, full_name, risk_score FROM users WHERE risk_score > 80
2026-01-26 12:59:00,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 12:59:00,316 - nl2sql - INFO - workflow.py:101 - Query execution returned 5 rows.
2026-01-26 12:59:00,320 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 12:59:01,916 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Use...
2026-01-26 12:59:01,925 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: List of users with risk score more than 80
2026-01-26 12:59:01,929 - nl2sql - INFO - endpoints.py:48 - Query success! 5 rows returned.
2026-01-26 13:00:42,071 - nl2sql - INFO - endpoints.py:14 - Incoming query: When is risk level considered as low | Domain: compliance
2026-01-26 13:00:42,080 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:00:42,082 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:00:42,088 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: When is risk level considered as low
2026-01-26 13:00:42,102 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:00:42,880 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 13:00:42,882 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 13:00:42,905 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:00:43,755 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-01-26 13:00:43,762 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 13:00:43,787 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 13:00:43,797 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:00:43,797 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: When is risk level considered as low
2026-01-26 13:00:43,817 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:00:45,044 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain inform...
2026-01-26 13:00:45,044 - nl2sql - WARNING - sql_generation.py:87 - SQL Generation guidance response for query: When is risk level considered as low | Msg: Error: The database schema does not contain inform...
2026-01-26 13:00:45,051 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error: The database schema does not contain inform...
2026-01-26 13:00:45,058 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:00:45,062 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain information about what constitutes a 'low' risk level. The `users` table ha
2026-01-26 13:00:45,075 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 13:00:46,096 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT risk_level FROM users WHERE risk_level = 'l...
2026-01-26 13:00:46,101 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:00:46,116 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:00:46,118 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level FROM users WHERE risk_level = 'low'
2026-01-26 13:00:46,125 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 13:00:46,129 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 13:00:46,134 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 13:00:47,978 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {"user_id": 101, "r...
2026-01-26 13:00:47,979 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 13:00:47,988 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: When is risk level considered as low
2026-01-26 13:00:47,991 - nl2sql - INFO - endpoints.py:48 - Query success! 8 rows returned.
2026-01-26 13:01:26,649 - nl2sql - INFO - endpoints.py:14 - Incoming query: When is risk level considered as low | Domain: compliance
2026-01-26 13:01:26,655 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:01:26,655 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:01:26,662 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: When is risk level considered as low
2026-01-26 13:01:26,671 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:01:27,529 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:01:27,531 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:01:27,547 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:01:28,651 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "risk_level": "LOW"...
2026-01-26 13:01:28,654 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': 'LOW'}
2026-01-26 13:01:28,674 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:01:28,683 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:01:28,683 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: When is risk level considered as low
2026-01-26 13:01:28,709 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:01:29,683 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain inform...
2026-01-26 13:01:29,687 - nl2sql - WARNING - sql_generation.py:87 - SQL Generation guidance response for query: When is risk level considered as low | Msg: Error: The database schema does not contain inform...
2026-01-26 13:01:29,692 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error: The database schema does not contain inform...
2026-01-26 13:01:29,701 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:01:29,709 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain information about the thresholds or definitions for 'low' risk levels. It o
2026-01-26 13:01:29,730 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 13:01:30,638 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE risk_level = 'low'...
2026-01-26 13:01:30,644 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:01:30,656 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:01:30,660 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE risk_level = 'low'
2026-01-26 13:01:30,671 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 13:01:30,672 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 13:01:30,680 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 13:01:34,180 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "user_id": ...
2026-01-26 13:01:34,182 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 13:01:34,191 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: When is risk level considered as low
2026-01-26 13:01:34,192 - nl2sql - INFO - endpoints.py:48 - Query success! 7 rows returned.
2026-01-26 13:01:52,626 - nl2sql - INFO - endpoints.py:14 - Incoming query: At what risk score is risk level considered low | Domain: compliance
2026-01-26 13:01:52,634 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:01:52,641 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:01:52,642 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: At what risk score is risk level considered low
2026-01-26 13:01:52,658 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:01:53,573 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:01:53,577 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:01:53,599 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:01:54,555 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 13:01:54,560 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 13:01:54,579 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:01:54,593 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:01:54,595 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: At what risk score is risk level considered low
2026-01-26 13:01:54,609 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:01:55,621 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain inform...
2026-01-26 13:01:55,629 - nl2sql - WARNING - sql_generation.py:87 - SQL Generation guidance response for query: At what risk score is risk level considered low | Msg: Error: The database schema does not contain inform...
2026-01-26 13:01:55,629 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error: The database schema does not contain inform...
2026-01-26 13:01:55,634 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:01:55,647 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain information on the specific risk score thresholds for different risk levels
2026-01-26 13:01:55,657 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 13:01:56,563 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT risk_level FROM users WHERE risk_s...
2026-01-26 13:01:56,570 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:01:56,581 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:01:56,583 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_score < 30
2026-01-26 13:01:56,583 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:01:56,591 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:01:56,593 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:01:57,942 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Ris...
2026-01-26 13:01:57,947 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: At what risk score is risk level considered low
2026-01-26 13:01:57,952 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:02:49,942 - nl2sql - INFO - endpoints.py:14 - Incoming query: Which are the low risk suspended users | Domain: compliance
2026-01-26 13:02:49,947 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:02:49,949 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:02:49,949 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Which are the low risk suspended users
2026-01-26 13:02:49,963 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:02:50,829 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:02:50,829 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:02:50,855 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:02:51,848 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_level...
2026-01-26 13:02:51,851 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': 'low', 'account_status': 'suspended'}
2026-01-26 13:02:51,881 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:02:51,893 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:02:51,893 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Which are the low risk suspended users
2026-01-26 13:02:51,916 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:02:53,029 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, full_name, email FROM users WHERE ...
2026-01-26 13:02:53,032 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT user_id, full_name, email FROM users WHERE ...
2026-01-26 13:02:53,032 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT user_id, full_name, email FROM users WHERE ...
2026-01-26 13:02:53,042 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:02:53,056 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:02:53,060 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, full_name, email FROM users WHERE risk_level = 'LOW' AND account_status = 'SUSPENDED'
2026-01-26 13:02:53,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 13:02:53,067 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 13:02:53,067 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 13:02:55,323 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "user_id": ...
2026-01-26 13:02:55,328 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 13:02:55,338 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Which are the low risk suspended users
2026-01-26 13:02:55,338 - nl2sql - INFO - endpoints.py:48 - Query success! 7 rows returned.
2026-01-26 13:03:45,342 - nl2sql - INFO - endpoints.py:14 - Incoming query: Who is the youngest user | Domain: compliance
2026-01-26 13:03:45,349 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:03:45,356 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:03:45,359 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Who is the youngest user
2026-01-26 13:03:45,367 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:03:46,581 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:03:46,585 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:03:46,607 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:03:47,505 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-01-26 13:03:47,505 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 13:03:47,530 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:03:47,541 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:03:47,545 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Who is the youngest user
2026-01-26 13:03:47,561 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:03:48,236 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, full_name, date_of_birth FROM user...
2026-01-26 13:03:48,243 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT user_id, full_name, date_of_birth FROM user...
2026-01-26 13:03:48,243 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT user_id, full_name, date_of_birth FROM user...
2026-01-26 13:03:48,250 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:03:48,258 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:03:48,259 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, full_name, date_of_birth FROM users ORDER BY date_of_birth DESC LIMIT 1
2026-01-26 13:03:48,269 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:03:48,269 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:03:48,274 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:03:49,481 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "You...
2026-01-26 13:03:49,482 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Who is the youngest user
2026-01-26 13:03:49,491 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:04:05,928 - nl2sql - INFO - endpoints.py:14 - Incoming query: Who is the first user | Domain: compliance
2026-01-26 13:04:05,935 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:04:05,937 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:04:05,942 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Who is the first user
2026-01-26 13:04:05,948 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:04:06,582 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {"intent": "SELECT", "confidence": 1.0, "complexit...
2026-01-26 13:04:06,590 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:04:06,608 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:04:07,459 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "limit": 1
...
2026-01-26 13:04:07,469 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'limit': 1}
2026-01-26 13:04:07,493 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:04:07,505 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:04:07,505 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Who is the first user
2026-01-26 13:04:07,525 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:04:08,122 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, email, full_name FROM users ORDER ...
2026-01-26 13:04:08,122 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT user_id, email, full_name FROM users ORDER ...
2026-01-26 13:04:08,129 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT user_id, email, full_name FROM users ORDER ...
2026-01-26 13:04:08,129 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:04:08,148 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:04:08,150 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, email, full_name FROM users ORDER BY created_at ASC LIMIT 1
2026-01-26 13:04:08,156 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:04:08,158 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:04:08,158 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:04:09,419 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Fir...
2026-01-26 13:04:09,430 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Who is the first user
2026-01-26 13:04:09,434 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:04:36,842 - nl2sql - INFO - endpoints.py:14 - Incoming query: How many users onboarded in last 30 days | Domain: compliance
2026-01-26 13:04:36,851 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:04:36,851 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:04:36,858 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How many users onboarded in last 30 days
2026-01-26 13:04:36,869 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:04:37,805 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:04:37,810 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:04:37,828 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:04:38,570 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 13:04:38,573 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 13:04:38,598 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:04:38,611 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:04:38,615 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: How many users onboarded in last 30 days
2026-01-26 13:04:38,636 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:04:39,341 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(user_id) FROM users WHERE created_at ...
2026-01-26 13:04:39,343 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT COUNT(user_id) FROM users WHERE created_at ...
2026-01-26 13:04:39,345 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT COUNT(user_id) FROM users WHERE created_at ...
2026-01-26 13:04:39,354 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:04:39,367 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:04:39,376 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(user_id) FROM users WHERE created_at >= date('now', '-30 days')
2026-01-26 13:04:39,379 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:04:39,381 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:04:39,385 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 13:04:40,778 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "date": "20...
2026-01-26 13:04:40,782 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 13:04:40,793 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How many users onboarded in last 30 days
2026-01-26 13:04:40,793 - nl2sql - INFO - endpoints.py:48 - Query success! 10 rows returned.
2026-01-26 13:05:35,709 - nl2sql - INFO - endpoints.py:14 - Incoming query: How many users onboarded in 2024 | Domain: compliance
2026-01-26 13:05:35,717 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:05:35,719 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:05:35,726 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How many users onboarded in 2024
2026-01-26 13:05:35,728 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:05:36,908 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:05:36,908 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:05:36,937 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:05:37,931 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "onboarding...
2026-01-26 13:05:37,931 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'onboarding_year': 2024}
2026-01-26 13:05:37,948 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:05:37,956 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:05:37,965 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: How many users onboarded in 2024
2026-01-26 13:05:37,981 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:05:38,837 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(user_id) FROM users WHERE STRFTIME('%...
2026-01-26 13:05:38,839 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT COUNT(user_id) FROM users WHERE STRFTIME('%...
2026-01-26 13:05:38,842 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT COUNT(user_id) FROM users WHERE STRFTIME('%...
2026-01-26 13:05:38,850 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:05:38,867 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:05:38,867 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(user_id) FROM users WHERE STRFTIME('%Y', created_at) = '2024'
2026-01-26 13:05:38,879 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:05:38,879 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:05:38,890 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:05:41,166 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Total...
2026-01-26 13:05:41,178 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How many users onboarded in 2024
2026-01-26 13:05:41,187 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:09:36,419 - nl2sql - INFO - endpoints.py:14 - Incoming query: Were there any fraudulent transactions? | Domain: compliance
2026-01-26 13:09:36,425 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:09:36,428 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 13:09:36,432 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Were there any fraudulent transactions?
2026-01-26 13:09:36,442 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:09:37,327 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 13:09:37,328 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 13:09:37,348 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:09:38,367 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 13:09:38,373 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'transaction_status': 'FRAUDULENT'}
2026-01-26 13:09:38,406 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 13:09:38,416 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:09:38,420 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Were there any fraudulent transactions?
2026-01-26 13:09:38,441 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 13:09:39,280 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(*) FROM transactions WHERE flag_reaso...
2026-01-26 13:09:39,282 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT COUNT(*) FROM transactions WHERE flag_reaso...
2026-01-26 13:09:39,285 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT COUNT(*) FROM transactions WHERE flag_reaso...
2026-01-26 13:09:39,291 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:09:39,303 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:09:39,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(*) FROM transactions WHERE flag_reason = 'FRAUDULENT'
2026-01-26 13:09:39,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:09:39,311 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:09:39,319 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 13:09:42,057 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "transactio...
2026-01-26 13:09:42,057 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 13:09:42,067 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Were there any fraudulent transactions?
2026-01-26 13:09:42,067 - nl2sql - INFO - endpoints.py:48 - Query success! 7 rows returned.
2026-01-26 13:12:00,659 - nl2sql - INFO - endpoints.py:14 - Incoming query: How many users login from mozilla | Domain: security
2026-01-26 13:12:00,669 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:12:00,669 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 13:12:00,672 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: How many users login from mozilla
2026-01-26 13:12:00,678 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:12:01,786 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:12:01,794 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:12:01,808 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:12:03,217 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "device_typ...
2026-01-26 13:12:03,222 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'device_type': 'Mozilla'}
2026-01-26 13:12:03,238 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:12:03,247 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:12:03,247 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: How many users login from mozilla
2026-01-26 13:12:03,267 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 13:12:04,636 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(DISTINCT user_id) FROM login_events W...
2026-01-26 13:12:04,641 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT COUNT(DISTINCT user_id) FROM login_events W...
2026-01-26 13:12:04,642 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT COUNT(DISTINCT user_id) FROM login_events W...
2026-01-26 13:12:04,648 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:12:04,660 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:12:04,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(DISTINCT user_id) FROM login_events WHERE user_agent LIKE '%Mozilla%'
2026-01-26 13:12:04,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:12:04,682 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:12:04,691 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:12:06,295 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Num...
2026-01-26 13:12:06,300 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How many users login from mozilla
2026-01-26 13:12:06,304 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:12:53,444 - nl2sql - INFO - endpoints.py:14 - Incoming query: What is the most common reasons for login failure | Domain: security
2026-01-26 13:12:53,450 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:12:53,450 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 13:12:53,455 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: What is the most common reasons for login failure
2026-01-26 13:12:53,463 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:12:54,622 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:12:54,622 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:12:54,642 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:12:55,331 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "status": "...
2026-01-26 13:12:55,331 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'status': 'FAILED'}
2026-01-26 13:12:55,351 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:12:55,355 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:12:55,355 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: What is the most common reasons for login failure
2026-01-26 13:12:55,372 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 13:12:56,205 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT failure_reason, COUNT(*) AS failure_count F...
2026-01-26 13:12:56,211 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT failure_reason, COUNT(*) AS failure_count F...
2026-01-26 13:12:56,211 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT failure_reason, COUNT(*) AS failure_count F...
2026-01-26 13:12:56,218 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:12:56,228 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:12:56,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT failure_reason, COUNT(*) AS failure_count FROM login_events WHERE failure_reason IS NOT NULL AND failure_reason != '' GROUP BY failure_reason ORDER BY failure_count DESC LIMIT 1
2026-01-26 13:12:56,238 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:12:56,242 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:12:56,249 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:12:57,798 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Most ...
2026-01-26 13:12:57,800 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What is the most common reasons for login failure
2026-01-26 13:12:57,805 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:13:40,183 - nl2sql - INFO - endpoints.py:14 - Incoming query: I want top 5 | Domain: security
2026-01-26 13:13:40,185 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:13:40,185 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 13:13:40,191 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: I want top 5
2026-01-26 13:13:40,200 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:13:41,178 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {"intent": "SELECT", "confidence": 1.0, "complexit...
2026-01-26 13:13:41,182 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: True
2026-01-26 13:13:41,210 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:13:42,175 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 13:13:42,178 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 13:13:42,195 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: True
2026-01-26 13:13:42,205 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-26 13:13:43,643 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Are you asking for the top 5 most common reasons f...
2026-01-26 13:13:43,647 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: I want top 5
2026-01-26 13:13:47,308 - nl2sql - INFO - endpoints.py:14 - Incoming query: Yeah | Domain: security
2026-01-26 13:13:47,313 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:13:47,319 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 13:13:47,320 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Yeah
2026-01-26 13:13:47,331 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:13:48,197 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {"intent": "SELECT", "confidence": 1.0, "complexit...
2026-01-26 13:13:48,197 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:13:48,217 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:13:49,003 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 13:13:49,005 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 13:13:49,029 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:13:49,041 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:13:49,043 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: Yeah
2026-01-26 13:13:49,061 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 13:13:50,204 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Please provide a question about the securit...
2026-01-26 13:13:50,205 - nl2sql - WARNING - sql_generation.py:87 - SQL Generation guidance response for query: Yeah | Msg: Error: Please provide a question about the securit...
2026-01-26 13:13:50,211 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error: Please provide a question about the securit...
2026-01-26 13:13:50,217 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:13:50,224 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 21.
  Error: Please [4mprovide[0m a question about the security data. Try asking about: users, transactions, login_events, alert_rule
2026-01-26 13:13:50,234 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 13:13:51,097 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT 1...
2026-01-26 13:13:51,102 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:13:51,112 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:13:51,116 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT 1
2026-01-26 13:13:51,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:13:51,119 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:13:51,123 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:13:52,138 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Que...
2026-01-26 13:13:52,147 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Yeah
2026-01-26 13:13:52,150 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:14:08,502 - nl2sql - INFO - endpoints.py:14 - Incoming query: I want top 5 reasons for login failures | Domain: security
2026-01-26 13:14:08,509 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:14:08,510 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 13:14:08,517 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: I want top 5 reasons for login failures
2026-01-26 13:14:08,527 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:14:09,433 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:14:09,433 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:14:09,452 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:14:10,278 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "login_stat...
2026-01-26 13:14:10,278 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'login_status': 'FAILED'}
2026-01-26 13:14:10,316 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:14:10,327 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:14:10,330 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: I want top 5 reasons for login failures
2026-01-26 13:14:10,350 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 13:14:11,102 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT failure_reason, COUNT(*) AS failure_count F...
2026-01-26 13:14:11,105 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT failure_reason, COUNT(*) AS failure_count F...
2026-01-26 13:14:11,109 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT failure_reason, COUNT(*) AS failure_count F...
2026-01-26 13:14:11,117 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:14:11,131 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:14:11,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT failure_reason, COUNT(*) AS failure_count FROM login_events WHERE status = 'Failed' GROUP BY failure_reason ORDER BY failure_count DESC LIMIT 5
2026-01-26 13:14:11,143 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 13:14:11,145 - nl2sql - INFO - workflow.py:101 - Query execution returned 5 rows.
2026-01-26 13:14:11,149 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:14:11,894 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Top 5...
2026-01-26 13:14:11,904 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: I want top 5 reasons for login failures
2026-01-26 13:14:11,909 - nl2sql - INFO - endpoints.py:48 - Query success! 5 rows returned.
2026-01-26 13:15:25,367 - nl2sql - INFO - endpoints.py:14 - Incoming query: Which user has the highest number of login failure due to Suspicious activity | Domain: security
2026-01-26 13:15:25,378 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:15:25,380 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 13:15:25,385 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Which user has the highest number of login failure due to Suspicious activity
2026-01-26 13:15:25,393 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:15:26,381 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:15:26,381 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:15:26,404 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:15:27,443 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "login_stat...
2026-01-26 13:15:27,445 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'login_status': 'FAILURE', 'reason': 'Suspicious activity'}
2026-01-26 13:15:27,469 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:15:27,478 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:15:27,485 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: Which user has the highest number of login failure due to Suspicious activity
2026-01-26 13:15:27,506 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 13:15:29,254 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT u.user_id, u.full_name, COUNT(le.event_id) ...
2026-01-26 13:15:29,257 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT u.user_id, u.full_name, COUNT(le.event_id) ...
2026-01-26 13:15:29,260 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT u.user_id, u.full_name, COUNT(le.event_id) ...
2026-01-26 13:15:29,268 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:15:29,281 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:15:29,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT u.user_id, u.full_name, COUNT(le.event_id) AS failure_count FROM users u JOIN login_events le ON u.user_id = le.user_id WHERE le.status = 'Blocked' AND le.failure_reason = 'Suspicious activity' GROUP BY u.user_id, u.full_name ORDER BY failure_count DESC LIMIT 1
2026-01-26 13:15:29,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 13:15:29,295 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 13:15:29,302 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 13:15:30,881 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Top U...
2026-01-26 13:15:30,892 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Which user has the highest number of login failure due to Suspicious activity
2026-01-26 13:15:30,897 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 13:18:23,114 - nl2sql - INFO - endpoints.py:14 - Incoming query: When was the last login of john_smith | Domain: general
2026-01-26 13:18:23,122 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 13:18:23,126 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 13:18:23,131 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: When was the last login of john_smith
2026-01-26 13:18:23,135 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 13:18:23,931 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 13:18:23,938 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:18:23,955 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 13:18:24,695 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "username":...
2026-01-26 13:18:24,695 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'username': 'john_smith'}
2026-01-26 13:18:24,716 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 13:18:24,724 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 13:18:24,729 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: When was the last login of john_smith
2026-01-26 13:18:24,742 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-26 13:18:25,480 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT created_at FROM login_events JOIN users ON ...
2026-01-26 13:18:25,481 - nl2sql - INFO - sql_generation.py:98 - SQL Generated and cleaned: SELECT created_at FROM login_events JOIN users ON ...
2026-01-26 13:18:25,481 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT created_at FROM login_events JOIN users ON ...
2026-01-26 13:18:25,488 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 13:18:25,502 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 13:18:25,506 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT created_at FROM login_events JOIN users ON login_events.user_id = users.user_id WHERE users.email = 'john_smith' ORDER BY created_at DESC LIMIT 1
2026-01-26 13:18:25,511 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) ambiguous column name: created_at
[SQL: SELECT created_at FROM login_events JOIN users ON login_events.user_id = users.user_id WHERE users.email = 'john_smith' ORDER BY created_at DESC LIMIT 1]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT created_at FROM login_events JOIN users ON login_events.user_id = users.user_id WHERE users.email = 'john_smith' ORDER BY created_at DESC LIMIT 1
2026-01-26 13:18:25,511 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 13:18:25,518 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Data Analyst and Visualization Expert. ...
2026-01-26 13:18:27,247 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "mock_data": [
    {
      "created_at...
2026-01-26 13:18:27,249 - nl2sql - INFO - workflow.py:117 - Injecting mock data for demonstration.
2026-01-26 13:18:27,257 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: When was the last login of john_smith
2026-01-26 13:18:27,258 - nl2sql - INFO - endpoints.py:48 - Query success! 7 rows returned.
2026-01-26 13:41:01,851 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 13:41:02,055 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 13:54:03,218 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 13:54:03,558 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 13:55:41,105 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 13:55:41,455 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 13:56:35,751 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 13:56:35,943 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 13:56:53,647 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 13:56:53,847 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 13:57:55,321 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 13:57:55,517 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 13:58:03,088 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 13:58:03,260 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:00:09,607 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me some suspicious user activities in past week | Domain: security
2026-01-26 14:00:09,626 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:00:09,629 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 14:00:09,634 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: show me some suspicious user activities in past week
2026-01-26 14:00:09,658 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:00:21,114 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:00:21,118 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 14:00:21,136 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:00:49,272 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "risk_level": "HIGH...
2026-01-26 14:00:49,276 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': 'HIGH'}
2026-01-26 14:00:49,302 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 14:00:49,309 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:00:49,319 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: show me some suspicious user activities in past week
2026-01-26 14:00:49,335 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 14:01:09,555 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-26 14:01:09,558 - nl2sql - INFO - sql_generation.py:104 - SQL Generated and cleaned: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-26 14:01:09,564 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-26 14:01:09,572 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:01:09,586 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:01:09,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE created_at >= datetime('now', '-7 days') ORDER BY created_at DESC;
2026-01-26 14:01:09,599 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 14:01:09,606 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:01:09,613 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me some suspicious user activities in past week
2026-01-26 14:01:09,620 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:13:41,293 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 14:13:41,534 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:14:19,443 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 14:14:19,676 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:14:44,655 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 14:14:44,871 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:15:00,331 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 14:15:00,925 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:15:16,387 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me suspicious activities in past week | Domain: general
2026-01-26 14:15:16,397 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:15:16,399 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 14:15:16,404 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me suspicious activities in past week
2026-01-26 14:15:16,419 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:15:41,885 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 14:15:41,885 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 14:15:41,892 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:15:47,740 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["transactions", "login_events"]...
2026-01-26 14:15:47,749 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:16:04,190 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:16:04,192 - nl2sql - ERROR - entity_extractor.py:135 - Entity Extraction Error: Expecting value: line 1 column 1 (char 0)
2026-01-26 14:16:04,218 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 14:16:04,233 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:16:04,236 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: show me suspicious activities in past week
2026-01-26 14:16:04,247 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-26 14:16:43,539 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-26 14:16:43,542 - nl2sql - INFO - sql_generation.py:104 - SQL Generated and cleaned: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-26 14:16:43,543 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-26 14:16:43,555 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:16:43,569 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me the suspicious users in past wekk | Domain: general
2026-01-26 14:16:43,578 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:16:43,581 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 14:16:43,585 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me the suspicious users in past wekk
2026-01-26 14:16:43,592 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:16:48,966 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 0.98,
  "c...
2026-01-26 14:16:48,968 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 14:16:48,968 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:16:57,970 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 14:16:57,980 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:17:12,205 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "risk_level": "HIGH...
2026-01-26 14:17:12,205 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': 'HIGH'}
2026-01-26 14:17:12,205 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 14:17:12,205 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:17:12,205 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE created_at >= datetime('now', '-7 days')
2026-01-26 14:17:12,214 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 14:17:12,214 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:17:12,217 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me suspicious activities in past week
2026-01-26 14:17:12,217 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:17:12,221 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:17:12,223 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: show me the suspicious users in past wekk
2026-01-26 14:17:12,227 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-26 14:17:55,497 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:17:55,497 - nl2sql - WARNING - sql_generation.py:93 - SQL Generation guidance response for query: show me the suspicious users in past wekk | Msg: Error generating response: Invalid operation: The ...
2026-01-26 14:17:55,504 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 14:17:55,506 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:17:55,515 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 14:17:55,522 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 14:18:00,642 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE is_suspicious = 1 AND cr...
2026-01-26 14:18:00,644 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:18:00,649 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:18:00,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE is_suspicious = 1 AND created_at >= date('now', '-7 days');
2026-01-26 14:18:00,652 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: is_suspicious
[SQL: SELECT * FROM users WHERE is_suspicious = 1 AND created_at >= date('now', '-7 days');]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM users WHERE is_suspicious = 1 AND created_at >= date('now', '-7 days');
2026-01-26 14:18:00,652 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:18:00,656 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me the suspicious users in past wekk
2026-01-26 14:18:00,656 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:18:13,543 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 14:18:13,706 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:19:22,169 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me suspicious actvity for users who are flagged | Domain: general
2026-01-26 14:19:22,179 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:19:22,190 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 14:19:22,196 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me suspicious actvity for users who are flagged
2026-01-26 14:19:22,211 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:19:27,707 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-26 14:19:27,715 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 14:19:27,717 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:19:44,447 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:19:44,456 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:19:53,950 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "account_status": "...
2026-01-26 14:19:53,953 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'account_status': 'FLAGGED', 'risk_level': 'HIGH'}
2026-01-26 14:19:53,971 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 14:19:53,978 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:19:53,982 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: show me suspicious actvity for users who are flagged
2026-01-26 14:19:53,994 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-26 14:21:08,647 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:21:08,649 - nl2sql - WARNING - sql_generation.py:93 - SQL Generation guidance response for query: show me suspicious actvity for users who are flagged | Msg: Error generating response: Invalid operation: The ...
2026-01-26 14:21:08,652 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 14:21:08,657 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:21:08,658 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 14:21:08,662 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 14:21:20,008 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM Activity JOIN Users ON Activity.user...
2026-01-26 14:21:20,008 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:21:20,017 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:21:20,017 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM Activity JOIN Users ON Activity.user_id = Users.id WHERE Users.is_flagged = 1;
2026-01-26 14:21:20,020 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: Activity
[SQL: SELECT * FROM Activity JOIN Users ON Activity.user_id = Users.id WHERE Users.is_flagged = 1;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM Activity JOIN Users ON Activity.user_id = Users.id WHERE Users.is_flagged = 1;
2026-01-26 14:21:20,020 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:21:20,024 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me suspicious actvity for users who are flagged
2026-01-26 14:21:20,024 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:22:38,648 - nl2sql - INFO - endpoints.py:14 - Incoming query: Find people between ages 25 and 40 | Domain: general
2026-01-26 14:22:38,649 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:22:38,657 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 14:22:38,660 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Find people between ages 25 and 40
2026-01-26 14:22:38,668 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:22:42,979 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-26 14:22:42,979 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 14:22:42,986 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:22:46,510 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users"]...
2026-01-26 14:22:46,517 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:23:06,821 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 14:23:06,822 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {}
2026-01-26 14:23:06,828 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 14:23:06,832 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:23:06,833 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: Find people between ages 25 and 40
2026-01-26 14:23:06,837 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-26 14:23:18,180 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE age BETWEEN 25 AND 40...
2026-01-26 14:23:18,180 - nl2sql - INFO - sql_generation.py:104 - SQL Generated and cleaned: SELECT * FROM users WHERE age BETWEEN 25 AND 40...
2026-01-26 14:23:18,191 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM users WHERE age BETWEEN 25 AND 40...
2026-01-26 14:23:18,192 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:23:18,197 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:23:18,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE age BETWEEN 25 AND 40
2026-01-26 14:23:18,200 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: age
[SQL: SELECT * FROM users WHERE age BETWEEN 25 AND 40]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM users WHERE age BETWEEN 25 AND 40
2026-01-26 14:23:18,202 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:23:18,206 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Find people between ages 25 and 40
2026-01-26 14:23:18,206 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:26:01,384 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me some suspicous users data | Domain: general
2026-01-26 14:26:01,391 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:26:01,393 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 14:26:01,397 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me some suspicous users data
2026-01-26 14:26:01,405 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:26:11,616 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 14:26:11,616 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 14:26:11,616 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:26:32,121 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions", "login_events"]...
2026-01-26 14:26:32,141 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:27:26,366 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_level...
2026-01-26 14:27:26,367 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'risk_level': 'HIGH'}
2026-01-26 14:27:26,382 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 14:27:26,382 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:27:26,393 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: show me some suspicous users data
2026-01-26 14:27:26,406 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-26 14:27:33,975 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE risk_level = 'High' OR r...
2026-01-26 14:27:33,977 - nl2sql - INFO - sql_generation.py:104 - SQL Generated and cleaned: SELECT * FROM users WHERE risk_level = 'High' OR r...
2026-01-26 14:27:33,978 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM users WHERE risk_level = 'High' OR r...
2026-01-26 14:27:33,978 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:27:33,982 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:27:33,984 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE risk_level = 'High' OR risk_score > 80 OR account_status = 'Suspended';
2026-01-26 14:27:33,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 25 rows.
2026-01-26 14:27:33,988 - nl2sql - INFO - workflow.py:101 - Query execution returned 25 rows.
2026-01-26 14:27:33,990 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 14:27:49,752 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "Suspicious ...
2026-01-26 14:27:49,756 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me some suspicous users data
2026-01-26 14:27:49,756 - nl2sql - INFO - endpoints.py:48 - Query success! 25 rows returned.
2026-01-26 14:31:27,642 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 14:31:27,848 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:31:42,637 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight.db
2026-01-26 14:31:42,836 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:39:46,111 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:39:46,304 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:41:22,466 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me the age of users with login failed attemtps | Domain: security
2026-01-26 14:41:22,475 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:41:22,478 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 14:41:22,480 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: show me the age of users with login failed attemtps
2026-01-26 14:41:22,488 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:41:29,029 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:41:29,029 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 14:41:29,038 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:41:33,039 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "login_events"]...
2026-01-26 14:41:33,052 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:41:39,992 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "status": "FAILED"
...
2026-01-26 14:41:39,992 - nl2sql - INFO - entity_extractor.py:130 - Final Extracted/Resolved Entities: {'status': 'FAILED'}
2026-01-26 14:41:39,997 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 14:41:40,002 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:41:40,003 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: show me the age of users with login failed attemtps
2026-01-26 14:41:40,005 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-26 14:42:00,092 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT users.age FROM users JOIN login_events ON u...
2026-01-26 14:42:00,092 - nl2sql - INFO - sql_generation.py:104 - SQL Generated and cleaned: SELECT users.age FROM users JOIN login_events ON u...
2026-01-26 14:42:00,097 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT users.age FROM users JOIN login_events ON u...
2026-01-26 14:42:00,097 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:42:00,108 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:42:00,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT users.age FROM users JOIN login_events ON users.user_id = login_events.user_id WHERE login_events.status = 'failed';
2026-01-26 14:42:00,116 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 14:42:00,119 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:42:00,125 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me the age of users with login failed attemtps
2026-01-26 14:42:00,129 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:44:09,770 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:44:10,033 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:46:00,871 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:46:01,132 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:46:21,285 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:46:21,568 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:47:20,348 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:47:20,578 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:47:46,345 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:47:46,585 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:48:04,369 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me the age of users with login failed attemtps | Domain: compliance
2026-01-26 14:48:04,369 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:48:04,379 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 14:48:04,382 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: show me the age of users with login failed attemtps
2026-01-26 14:48:04,397 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:48:13,932 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:48:13,942 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 14:48:13,948 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:48:21,508 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:48:21,512 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:48:28,571 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "status": "FAILED"
...
2026-01-26 14:48:28,573 - nl2sql - INFO - entity_extractor.py:139 - Final Extracted/Resolved Entities: {'status': 'FAILED'}
2026-01-26 14:48:28,578 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 14:48:28,583 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:48:28,583 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: show me the age of users with login failed attemtps
2026-01-26 14:48:28,585 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 14:48:35,432 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT users.age FROM users JOIN login_events ON u...
2026-01-26 14:48:35,432 - nl2sql - INFO - sql_generation.py:108 - SQL Generated and cleaned: SELECT users.age FROM users JOIN login_events ON u...
2026-01-26 14:48:35,434 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT users.age FROM users JOIN login_events ON u...
2026-01-26 14:48:35,435 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:48:35,439 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:48:35,441 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT users.age FROM users JOIN login_events ON users.user_id = login_events.user_id WHERE UPPER(login_events.status) = 'FAILED'
2026-01-26 14:48:35,444 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50 rows.
2026-01-26 14:48:35,444 - nl2sql - INFO - workflow.py:101 - Query execution returned 50 rows.
2026-01-26 14:48:35,446 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 14:48:54,256 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "box",
  "title": "Age D...
2026-01-26 14:48:54,258 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me the age of users with login failed attemtps
2026-01-26 14:48:54,265 - nl2sql - INFO - endpoints.py:48 - Query success! 50 rows returned.
2026-01-26 14:49:30,064 - nl2sql - INFO - endpoints.py:14 - Incoming query: lets talk about some high risk users? | Domain: compliance
2026-01-26 14:49:30,071 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:49:30,073 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 14:49:30,078 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: lets talk about some high risk users?
2026-01-26 14:49:30,078 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:49:34,105 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 14:49:34,111 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 14:49:34,116 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:49:41,774 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users"]...
2026-01-26 14:49:41,780 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:49:49,417 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "risk_level": "HIGH...
2026-01-26 14:49:49,417 - nl2sql - INFO - entity_extractor.py:139 - Final Extracted/Resolved Entities: {'risk_level': 'HIGH'}
2026-01-26 14:49:49,433 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 14:49:49,446 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:49:49,448 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: lets talk about some high risk users?
2026-01-26 14:49:49,455 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 14:49:54,686 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE UPPER(risk_level) = 'HIG...
2026-01-26 14:49:54,691 - nl2sql - INFO - sql_generation.py:108 - SQL Generated and cleaned: SELECT * FROM users WHERE UPPER(risk_level) = 'HIG...
2026-01-26 14:49:54,692 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM users WHERE UPPER(risk_level) = 'HIG...
2026-01-26 14:49:54,698 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:49:54,707 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:49:54,710 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE UPPER(risk_level) = 'HIGH'
2026-01-26 14:49:54,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 14:49:54,718 - nl2sql - INFO - workflow.py:101 - Query execution returned 20 rows.
2026-01-26 14:49:54,723 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 14:50:29,123 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:50:29,129 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: lets talk about some high risk users?
2026-01-26 14:50:29,133 - nl2sql - INFO - endpoints.py:48 - Query success! 20 rows returned.
2026-01-26 14:51:27,198 - nl2sql - INFO - endpoints.py:14 - Incoming query: is there any correlation between high risk users and their age | Domain: compliance
2026-01-26 14:51:27,201 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:51:27,208 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 14:51:27,211 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: is there any correlation between high risk users and their age
2026-01-26 14:51:27,212 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:51:37,907 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:51:37,907 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 14:51:37,913 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:51:41,494 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users"]...
2026-01-26 14:51:41,497 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:51:51,878 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:51:51,884 - nl2sql - ERROR - entity_extractor.py:144 - Entity Extraction Error: Expecting value: line 1 column 1 (char 0)
2026-01-26 14:51:51,892 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 14:51:51,900 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:51:51,904 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: is there any correlation between high risk users and their age
2026-01-26 14:51:51,904 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 14:51:55,500 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT age, COUNT(*) FROM users WHERE UPPER(risk_l...
2026-01-26 14:51:55,500 - nl2sql - INFO - sql_generation.py:108 - SQL Generated and cleaned: SELECT age, COUNT(*) FROM users WHERE UPPER(risk_l...
2026-01-26 14:51:55,500 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT age, COUNT(*) FROM users WHERE UPPER(risk_l...
2026-01-26 14:51:55,504 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:51:55,511 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:51:55,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT age, COUNT(*) FROM users WHERE UPPER(risk_level) = 'HIGH' GROUP BY age ORDER BY age;
2026-01-26 14:51:55,517 - nl2sql - INFO - database.py:60 - Execution complete. Returned 18 rows.
2026-01-26 14:51:55,517 - nl2sql - INFO - workflow.py:101 - Query execution returned 18 rows.
2026-01-26 14:51:55,521 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 14:52:05,794 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "scatter",
  "title": "Correlati...
2026-01-26 14:52:05,798 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: is there any correlation between high risk users and their age
2026-01-26 14:52:05,799 - nl2sql - INFO - endpoints.py:48 - Query success! 18 rows returned.
2026-01-26 14:53:41,355 - nl2sql - INFO - endpoints.py:14 - Incoming query: is there any correlation between flag reason and politically exposed users? | Domain: compliance
2026-01-26 14:53:41,360 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:53:41,363 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 14:53:41,363 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: is there any correlation between flag reason and politically exposed users?
2026-01-26 14:53:41,367 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:53:50,748 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:53:50,748 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 14:53:50,758 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:53:53,217 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 14:53:53,217 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:54:04,442 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "is_pep": 1
  },
  ...
2026-01-26 14:54:04,442 - nl2sql - INFO - entity_extractor.py:139 - Final Extracted/Resolved Entities: {'is_pep': 1}
2026-01-26 14:54:04,447 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 14:54:04,452 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:54:04,452 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: is there any correlation between flag reason and politically exposed users?
2026-01-26 14:54:04,452 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 14:54:10,985 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 14:54:10,985 - nl2sql - WARNING - sql_generation.py:97 - SQL Generation guidance response for query: is there any correlation between flag reason and politically exposed users? | Msg: Error generating response: Invalid operation: The ...
2026-01-26 14:54:10,990 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 14:54:10,992 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:54:10,999 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 14:54:11,006 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 14:54:18,598 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT flag_reason, is_politically_exposed, COUNT(...
2026-01-26 14:54:18,598 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:54:18,609 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:54:18,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT flag_reason, is_politically_exposed, COUNT(*) as count FROM flags JOIN users ON flags.user_id = users.user_id GROUP BY flag_reason, is_politically_exposed;
2026-01-26 14:54:18,616 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: flags
[SQL: SELECT flag_reason, is_politically_exposed, COUNT(*) as count FROM flags JOIN users ON flags.user_id = users.user_id GROUP BY flag_reason, is_politically_exposed;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT flag_reason, is_politically_exposed, COUNT(*) as count FROM flags JOIN users ON flags.user_id = users.user_id GROUP BY flag_reason, is_politically_exposed;
2026-01-26 14:54:18,620 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:54:18,629 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: is there any correlation between flag reason and politically exposed users?
2026-01-26 14:54:18,631 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:57:30,943 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the names of user with instrument AMAZON | Domain: compliance
2026-01-26 14:57:30,948 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 14:57:30,948 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 14:57:30,955 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 14:57:30,955 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 14:57:38,248 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 0.98,
  "c...
2026-01-26 14:57:38,255 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 14:57:38,257 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 14:57:41,470 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 14:57:41,478 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 14:57:46,828 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "instrument": "AMAZ...
2026-01-26 14:57:46,841 - nl2sql - INFO - entity_extractor.py:133 - Fuzzy matched 'AMAZON' to 'AMZN' (score: 80) for column 'instrument'.
2026-01-26 14:57:46,842 - nl2sql - INFO - entity_extractor.py:139 - Final Extracted/Resolved Entities: {'instrument': 'AMZN'}
2026-01-26 14:57:46,848 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 14:57:46,851 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 14:57:46,852 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 14:57:46,855 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 14:57:52,157 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT users.full_name FROM users JOIN tr...
2026-01-26 14:57:52,157 - nl2sql - INFO - sql_generation.py:108 - SQL Generated and cleaned: SELECT DISTINCT users.full_name FROM users JOIN tr...
2026-01-26 14:57:52,161 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT users.full_name FROM users JOIN tr...
2026-01-26 14:57:52,161 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 14:57:52,167 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 14:57:52,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT users.full_name FROM users JOIN transactions ON users.user_id = transactions.user_id WHERE UPPER(transactions.instrument) = 'AMAZON'
2026-01-26 14:57:52,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 14:57:52,173 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 14:57:52,176 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the names of user with instrument AMAZON
2026-01-26 14:57:52,178 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 14:59:16,041 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:59:16,303 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:59:31,016 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:59:31,228 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 14:59:43,516 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 14:59:43,778 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:00:50,741 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the names of user with instrument AMAZON | Domain: compliance
2026-01-26 15:00:50,748 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:00:50,751 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 15:00:50,755 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:00:50,770 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:00:56,187 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 15:00:56,191 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:00:56,192 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:00:58,757 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:00:58,764 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:01:17,491 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "instrument": "AMZN...
2026-01-26 15:01:17,492 - nl2sql - INFO - entity_extractor.py:138 - Final Extracted/Resolved Entities: {'instrument': 'AMZN'}
2026-01-26 15:01:17,505 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:01:17,519 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:01:17,522 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:01:17,529 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 15:01:21,378 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT users.full_name FROM users JOIN tr...
2026-01-26 15:01:21,380 - nl2sql - INFO - sql_generation.py:108 - SQL Generated and cleaned: SELECT DISTINCT users.full_name FROM users JOIN tr...
2026-01-26 15:01:21,383 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT users.full_name FROM users JOIN tr...
2026-01-26 15:01:21,387 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:01:21,400 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:01:21,401 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT users.full_name FROM users JOIN transactions ON users.user_id = transactions.user_id WHERE UPPER(transactions.instrument) = 'AMAZON'
2026-01-26 15:01:21,408 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 15:01:21,413 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 15:01:21,419 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the names of user with instrument AMAZON
2026-01-26 15:01:21,419 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 15:01:37,517 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:01:37,704 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:01:53,267 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the names of user with instrument AMAZON | Domain: compliance
2026-01-26 15:01:53,273 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:01:53,278 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 15:01:53,282 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:01:53,300 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:01:59,472 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-26 15:01:59,474 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:01:59,477 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:02:04,288 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:02:04,297 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:02:10,731 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:02:10,737 - nl2sql - ERROR - entity_extractor.py:143 - Entity Extraction Error: Expecting value: line 1 column 1 (char 0)
2026-01-26 15:02:10,762 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:02:10,793 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:02:10,798 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:02:10,811 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 15:02:25,660 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:02:25,663 - nl2sql - WARNING - sql_generation.py:97 - SQL Generation guidance response for query: give me the names of user with instrument AMAZON | Msg: Error generating response: Invalid operation: The ...
2026-01-26 15:02:25,667 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 15:02:25,669 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:02:25,678 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 15:02:25,685 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 15:02:30,247 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT name FROM users WHERE instrument = 'AMAZON'...
2026-01-26 15:02:30,252 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:02:30,260 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:02:30,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM users WHERE instrument = 'AMAZON';
2026-01-26 15:02:30,271 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: name
[SQL: SELECT name FROM users WHERE instrument = 'AMAZON';]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT name FROM users WHERE instrument = 'AMAZON';
2026-01-26 15:02:30,275 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 15:02:30,279 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the names of user with instrument AMAZON
2026-01-26 15:02:30,285 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 15:04:42,970 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:04:43,172 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:04:49,519 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:04:49,708 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:04:56,911 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:04:57,409 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:05:52,809 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:05:52,938 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:06:00,653 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:06:00,840 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:06:19,428 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:06:19,568 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:06:36,030 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:06:36,137 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:06:59,897 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:06:59,997 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:07:20,600 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the names of user with instrument AMAZON | Domain: compliance
2026-01-26 15:07:20,616 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:07:20,621 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 15:07:20,629 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:07:20,646 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:07:27,891 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-26 15:07:27,893 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:07:27,893 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:07:30,728 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:07:30,728 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:07:34,348 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "transactions.instr...
2026-01-26 15:07:34,352 - nl2sql - INFO - entity_extractor.py:135 - Final Extracted/Resolved Entities: {'transactions.instrument': 'AMZN'}
2026-01-26 15:07:34,362 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:07:34,373 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:07:34,373 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:07:34,385 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 15:07:38,348 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT full_name FROM users JOIN transact...
2026-01-26 15:07:38,350 - nl2sql - INFO - sql_generation.py:109 - SQL Generated and cleaned: SELECT DISTINCT full_name FROM users JOIN transact...
2026-01-26 15:07:38,350 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT full_name FROM users JOIN transact...
2026-01-26 15:07:38,351 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:07:38,355 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:07:38,355 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users JOIN transactions ON users.user_id = transactions.user_id WHERE UPPER(instrument) = 'AMAZON'
2026-01-26 15:07:38,357 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 15:07:38,358 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 15:07:38,361 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the names of user with instrument AMAZON
2026-01-26 15:07:38,361 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 15:08:42,343 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:08:42,447 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:08:56,405 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:08:56,536 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:09:11,548 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:09:11,650 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:09:24,810 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the names of user with instrument AMAZON | Domain: compliance
2026-01-26 15:09:24,817 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:09:24,817 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 15:09:24,822 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:09:24,833 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:09:28,900 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-26 15:09:28,902 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:09:28,905 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:09:31,137 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:09:31,148 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:09:35,100 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "transactions.instr...
2026-01-26 15:09:35,102 - nl2sql - INFO - entity_extractor.py:135 - Final Extracted/Resolved Entities: {'transactions.instrument': 'AMZN'}
2026-01-26 15:09:35,124 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:09:35,147 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:09:35,150 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:09:35,164 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 15:09:44,486 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT full_name FROM users JOIN transact...
2026-01-26 15:09:44,486 - nl2sql - INFO - sql_generation.py:109 - SQL Generated and cleaned: SELECT DISTINCT full_name FROM users JOIN transact...
2026-01-26 15:09:44,488 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT full_name FROM users JOIN transact...
2026-01-26 15:09:44,494 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:09:44,505 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:09:44,505 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users JOIN transactions ON users.user_id = transactions.user_id WHERE UPPER(instrument) LIKE '%AMAZON%'
2026-01-26 15:09:44,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 15:09:44,513 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 15:09:44,523 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the names of user with instrument AMAZON
2026-01-26 15:09:44,525 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 15:12:05,728 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:12:05,842 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:12:36,055 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:12:36,186 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:12:59,691 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:12:59,794 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:13:29,079 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:13:29,199 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:16:37,955 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the names of user with instrument AMAZON | Domain: compliance
2026-01-26 15:16:37,967 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:16:37,969 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 15:16:37,971 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:16:37,985 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:16:45,344 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:16:45,347 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 15:16:45,349 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:16:51,996 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:16:51,999 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:16:56,097 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "transactions.instr...
2026-01-26 15:16:56,097 - nl2sql - INFO - entity_extractor.py:135 - Final Extracted/Resolved Entities: {'transactions.instrument': 'AMZN'}
2026-01-26 15:16:56,107 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 15:16:56,113 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:16:56,114 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: give me the names of user with instrument AMAZON
2026-01-26 15:16:56,118 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 15:17:06,581 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT users.username FROM users JOIN tra...
2026-01-26 15:17:06,583 - nl2sql - INFO - sql_generation.py:109 - SQL Generated and cleaned: SELECT DISTINCT users.username FROM users JOIN tra...
2026-01-26 15:17:06,586 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT users.username FROM users JOIN tra...
2026-01-26 15:17:06,591 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:17:06,601 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:17:06,603 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT users.username FROM users JOIN transactions ON users.user_id = transactions.user_id WHERE UPPER(transactions.instrument) LIKE '%AMAZON%'
2026-01-26 15:17:06,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 15:17:06,612 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 15:17:06,620 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the names of user with instrument AMAZON
2026-01-26 15:17:06,622 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 15:17:28,412 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me the names of user with instrument AMZN | Domain: compliance
2026-01-26 15:17:28,414 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:17:28,417 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 15:17:28,418 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: give me the names of user with instrument AMZN
2026-01-26 15:17:28,421 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:17:37,602 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 15:17:37,604 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:17:37,606 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:17:41,791 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:17:41,792 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:17:45,648 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "transactions.instr...
2026-01-26 15:17:45,648 - nl2sql - INFO - entity_extractor.py:135 - Final Extracted/Resolved Entities: {'transactions.instrument': 'AMZN'}
2026-01-26 15:17:45,655 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:17:45,657 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:17:45,657 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: give me the names of user with instrument AMZN
2026-01-26 15:17:45,667 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-26 15:17:52,646 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:17:52,649 - nl2sql - WARNING - sql_generation.py:98 - SQL Generation guidance response for query: give me the names of user with instrument AMZN | Msg: Error generating response: Invalid operation: The ...
2026-01-26 15:17:52,652 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 15:17:52,656 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:17:52,659 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 15:17:52,666 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 15:18:03,942 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT name FROM users JOIN user_instruments ON us...
2026-01-26 15:18:03,942 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:18:03,955 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:18:03,960 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM users JOIN user_instruments ON users.id = user_instruments.user_id WHERE instrument = 'AMZN';
2026-01-26 15:18:03,962 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: user_instruments
[SQL: SELECT name FROM users JOIN user_instruments ON users.id = user_instruments.user_id WHERE instrument = 'AMZN';]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT name FROM users JOIN user_instruments ON users.id = user_instruments.user_id WHERE instrument = 'AMZN';
2026-01-26 15:18:03,967 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 15:18:03,969 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me the names of user with instrument AMZN
2026-01-26 15:18:03,978 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 15:20:46,634 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:21:04,730 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:21:34,918 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:21:35,029 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:24:44,224 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:24:44,359 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:26:06,865 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:26:06,958 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:29:00,887 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:29:01,314 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:30:48,974 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:31:24,381 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:32:31,167 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:32:31,270 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:33:12,643 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:33:12,891 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:33:39,977 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:33:40,181 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:33:49,813 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:33:50,010 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:34:02,831 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:34:02,933 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:35:01,585 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:35:01,684 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:37:53,189 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me user name with transactions instrument AMZN | Domain: general
2026-01-26 15:37:53,197 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:37:53,198 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 15:37:53,204 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me user name with transactions instrument AMZN
2026-01-26 15:37:53,221 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:37:57,521 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-26 15:37:57,521 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:37:57,527 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:38:00,192 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:38:00,198 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:38:05,541 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "transactions.instr...
2026-01-26 15:38:05,542 - nl2sql - INFO - entity_extractor.py:135 - Final Extracted/Resolved Entities: {'transactions.instrument': 'AMZN'}
2026-01-26 15:38:05,555 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 15:38:05,568 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:38:05,571 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: show me user name with transactions instrument AMZN
2026-01-26 15:38:05,582 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: general
2026-01-26 15:38:05,591 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQLite generator for the Genera...
2026-01-26 15:38:08,981 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 15:38:08,981 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 15:38:08,981 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 15:38:08,992 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:38:08,998 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:38:09,005 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT u.username FROM users u JOIN transactions t ON u.user_id = t.user_id WHERE UPPER(t.instrument) LIKE '%AMZN%';
2026-01-26 15:38:09,014 - nl2sql - INFO - database.py:60 - Execution complete. Returned 17 rows.
2026-01-26 15:38:09,014 - nl2sql - INFO - workflow.py:101 - Query execution returned 17 rows.
2026-01-26 15:38:09,016 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 15:38:15,305 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "Users with ...
2026-01-26 15:38:15,311 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me user name with transactions instrument AMZN
2026-01-26 15:38:15,313 - nl2sql - INFO - endpoints.py:48 - Query success! 17 rows returned.
2026-01-26 15:42:52,129 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me user name with transactions instrument AMAZON ? | Domain: general
2026-01-26 15:42:52,129 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:42:52,138 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 15:42:52,143 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me user name with transactions instrument AMAZON ?
2026-01-26 15:42:52,148 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:42:56,955 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:42:56,955 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 15:42:56,960 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:42:59,934 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:42:59,941 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:43:04,335 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "transactions.instr...
2026-01-26 15:43:04,339 - nl2sql - INFO - entity_extractor.py:135 - Final Extracted/Resolved Entities: {'transactions.instrument': 'AMZN'}
2026-01-26 15:43:04,342 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 15:43:04,351 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:43:04,354 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: show me user name with transactions instrument AMAZON ?
2026-01-26 15:43:04,366 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: general
2026-01-26 15:43:04,367 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQLite generator for the Genera...
2026-01-26 15:43:08,483 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 15:43:08,483 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 15:43:08,483 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 15:43:08,491 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:43:08,500 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:43:08,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT u.username FROM users u JOIN transactions t ON u.user_id = t.user_id WHERE UPPER(t.instrument) LIKE '%AMAZON%' OR UPPER(t.instrument) LIKE '%AMZN%';
2026-01-26 15:43:08,510 - nl2sql - INFO - database.py:60 - Execution complete. Returned 17 rows.
2026-01-26 15:43:08,510 - nl2sql - INFO - workflow.py:101 - Query execution returned 17 rows.
2026-01-26 15:43:08,517 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 15:43:12,947 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "Users with ...
2026-01-26 15:43:12,949 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me user name with transactions instrument AMAZON ?
2026-01-26 15:43:12,951 - nl2sql - INFO - endpoints.py:48 - Query success! 17 rows returned.
2026-01-26 15:43:53,032 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: security
2026-01-26 15:43:53,042 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:43:53,044 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 15:43:53,046 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Show me all high severity incidents
2026-01-26 15:43:53,055 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:43:57,578 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 15:43:57,580 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 15:43:57,580 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:44:59,762 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ["users"]...
2026-01-26 15:44:59,765 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:45:09,683 - nl2sql - ERROR - llm.py:66 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:45:09,683 - nl2sql - ERROR - entity_extractor.py:140 - Entity Extraction Error: Expecting value: line 1 column 1 (char 0)
2026-01-26 15:45:09,691 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 15:45:09,692 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:45:09,692 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: Show me all high severity incidents
2026-01-26 15:45:09,697 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: security
2026-01-26 15:45:09,698 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQLite generator for the Securi...
2026-01-26 15:45:22,791 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE UPPER(risk_level) LIKE '...
2026-01-26 15:45:22,791 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT * FROM users WHERE UPPER(risk_level) LIKE '...
2026-01-26 15:45:22,792 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM users WHERE UPPER(risk_level) LIKE '...
2026-01-26 15:45:22,793 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:45:22,796 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:45:22,796 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE UPPER(risk_level) LIKE '%HIGH%';
2026-01-26 15:45:22,798 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 15:45:22,798 - nl2sql - INFO - workflow.py:101 - Query execution returned 20 rows.
2026-01-26 15:45:22,800 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 15:45:36,859 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "High Severi...
2026-01-26 15:45:36,859 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-26 15:45:36,865 - nl2sql - INFO - endpoints.py:48 - Query success! 20 rows returned.
2026-01-26 15:46:25,628 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:46:26,121 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:46:48,397 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 15:46:48,848 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 15:46:48,878 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me all payment methods which is flagged | Domain: security
2026-01-26 15:46:48,886 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:46:48,893 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 15:46:48,898 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: show me all payment methods which is flagged
2026-01-26 15:46:48,917 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:46:54,736 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 0.95,
  "c...
2026-01-26 15:46:54,736 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 15:46:54,741 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:46:58,448 - nl2sql - ERROR - llm.py:83 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:46:58,460 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:47:08,309 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: {
  "resolved_entities": {
    "transactions.statu...
2026-01-26 15:47:08,318 - nl2sql - INFO - entity_extractor.py:143 - Final Extracted/Resolved Entities: {'transactions.status': 'FLAGGED'}
2026-01-26 15:47:08,328 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 15:47:08,343 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:47:08,348 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: show me all payment methods which is flagged
2026-01-26 15:47:08,366 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: security
2026-01-26 15:47:08,371 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQLite generator for the Securi...
2026-01-26 15:47:19,467 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: SELECT DISTINCT payment_method FROM transactions W...
2026-01-26 15:47:19,467 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT DISTINCT payment_method FROM transactions W...
2026-01-26 15:47:19,467 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT DISTINCT payment_method FROM transactions W...
2026-01-26 15:47:19,481 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:47:19,500 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:47:19,511 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE UPPER(status) LIKE '%FLAGGED%' OR UPPER(flag_reason) IS NOT NULL;
2026-01-26 15:47:19,522 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 15:47:19,522 - nl2sql - INFO - workflow.py:101 - Query execution returned 8 rows.
2026-01-26 15:47:19,535 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 15:47:25,136 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "Flagged Pay...
2026-01-26 15:47:25,141 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me all payment methods which is flagged
2026-01-26 15:47:25,144 - nl2sql - INFO - endpoints.py:48 - Query success! 8 rows returned.
2026-01-26 15:48:29,588 - nl2sql - INFO - endpoints.py:14 - Incoming query: I want to analyze user transactoion anomalies | Domain: security
2026-01-26 15:48:29,597 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:48:29,598 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 15:48:29,605 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: I want to analyze user transactoion anomalies
2026-01-26 15:48:29,608 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:48:44,929 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 15:48:44,931 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 15:48:44,935 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:48:49,208 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: ["users", "transactions"]...
2026-01-26 15:48:49,217 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:49:22,748 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-01-26 15:49:22,755 - nl2sql - INFO - entity_extractor.py:143 - Final Extracted/Resolved Entities: {}
2026-01-26 15:49:22,769 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 15:49:22,779 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:49:22,782 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: I want to analyze user transactoion anomalies
2026-01-26 15:49:22,805 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: security
2026-01-26 15:49:22,809 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQLite generator for the Securi...
2026-01-26 15:49:38,567 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: SELECT u.username, t.txn_id, t.amount_usd, t.statu...
2026-01-26 15:49:38,569 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT u.username, t.txn_id, t.amount_usd, t.statu...
2026-01-26 15:49:38,569 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT u.username, t.txn_id, t.amount_usd, t.statu...
2026-01-26 15:49:38,579 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:49:38,608 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 15:49:38,614 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT u.username, t.txn_id, t.amount_usd, t.status, t.flag_reason, u.risk_level, u.risk_score FROM users u JOIN transactions t ON u.user_id = t.user_id WHERE UPPER(t.status) LIKE '%FLAGGED%' OR UPPER(u.risk_level) LIKE '%HIGH%' OR UPPER(t.status) LIKE '%FAILED%'
2026-01-26 15:49:38,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 207 rows.
2026-01-26 15:49:38,637 - nl2sql - INFO - workflow.py:101 - Query execution returned 207 rows.
2026-01-26 15:49:38,646 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 15:49:52,699 - nl2sql - ERROR - llm.py:83 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:49:52,703 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: I want to analyze user transactoion anomalies
2026-01-26 15:49:52,705 - nl2sql - INFO - endpoints.py:48 - Query success! 207 rows returned.
2026-01-26 15:58:26,075 - nl2sql - INFO - endpoints.py:14 - Incoming query: I want to know the user anomalous activity in past 2 hours | Domain: security
2026-01-26 15:58:26,092 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 15:58:26,101 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 15:58:26,118 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: I want to know the user anomalous activity in past 2 hours
2026-01-26 15:58:26,131 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 15:58:35,348 - nl2sql - ERROR - llm.py:83 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:58:35,348 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 15:58:35,355 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 15:58:50,580 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: ["users", "transactions", "login_events"]...
2026-01-26 15:58:50,604 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 15:59:02,682 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 15:59:02,686 - nl2sql - INFO - entity_extractor.py:143 - Final Extracted/Resolved Entities: {'transactions.status': 'FLAGGED', 'login_events.status': 'FAILED'}
2026-01-26 15:59:02,707 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 15:59:02,721 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 15:59:02,724 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: I want to know the user anomalous activity in past 2 hours
2026-01-26 15:59:02,750 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: security
2026-01-26 15:59:02,760 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQLite generator for the Securi...
2026-01-26 15:59:46,443 - nl2sql - ERROR - llm.py:83 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 15:59:46,447 - nl2sql - WARNING - sql_generation.py:103 - SQL Generation guidance response for query: I want to know the user anomalous activity in past 2 hours | Msg: Error generating response: Invalid operation: The ...
2026-01-26 15:59:46,448 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 15:59:46,450 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 15:59:46,453 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 15:59:46,455 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-26 16:00:01,567 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: SELECT * FROM user_activity WHERE is_anomalous = 1...
2026-01-26 16:00:01,570 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:00:01,575 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 16:00:01,576 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM user_activity WHERE is_anomalous = 1 AND timestamp >= datetime('now', '-2 hours');
2026-01-26 16:00:01,578 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: user_activity
[SQL: SELECT * FROM user_activity WHERE is_anomalous = 1 AND timestamp >= datetime('now', '-2 hours');]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM user_activity WHERE is_anomalous = 1 AND timestamp >= datetime('now', '-2 hours');
2026-01-26 16:00:01,578 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 16:00:01,584 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: I want to know the user anomalous activity in past 2 hours
2026-01-26 16:00:01,585 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 16:01:08,576 - nl2sql - INFO - endpoints.py:14 - Incoming query: what is the intensity of user anomalies recently, for a month | Domain: security
2026-01-26 16:01:08,582 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:01:08,584 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:01:08,588 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: what is the intensity of user anomalies recently, for a month
2026-01-26 16:01:08,592 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-26 16:01:14,985 - nl2sql - ERROR - llm.py:83 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:01:14,989 - nl2sql - ERROR - intent_classification.py:86 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 16:01:14,992 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: You are a database expert. Given a user's natural ...
2026-01-26 16:01:35,255 - nl2sql - ERROR - llm.py:83 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:01:35,258 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-26 16:02:05,086 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 16:02:05,091 - nl2sql - INFO - entity_extractor.py:143 - Final Extracted/Resolved Entities: {}
2026-01-26 16:02:05,106 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 16:02:05,121 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:02:05,123 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: what is the intensity of user anomalies recently, for a month
2026-01-26 16:02:05,142 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: security
2026-01-26 16:02:05,148 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQLite generator for the Securi...
2026-01-26 16:02:22,464 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: SELECT date(created_at), COUNT(*) FROM transaction...
2026-01-26 16:02:22,469 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT date(created_at), COUNT(*) FROM transaction...
2026-01-26 16:02:22,469 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT date(created_at), COUNT(*) FROM transaction...
2026-01-26 16:02:22,480 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:02:22,497 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 16:02:22,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT date(created_at), COUNT(*) FROM transactions WHERE UPPER(status) LIKE '%FLAGGED%' AND created_at >= date('now', '-1 month') GROUP BY date(created_at)
2026-01-26 16:02:22,515 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-26 16:02:22,518 - nl2sql - INFO - workflow.py:101 - Query execution returned 1 rows.
2026-01-26 16:02:22,523 - nl2sql - INFO - llm.py:54 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-26 16:02:26,557 - nl2sql - INFO - llm.py:72 - LLM response received. Snippet: {
  "chart_type": "line",
  "title": "Daily User A...
2026-01-26 16:02:26,557 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: what is the intensity of user anomalies recently, for a month
2026-01-26 16:02:26,557 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-26 16:10:42,702 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:10:42,907 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:10:48,474 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:10:48,610 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:11:09,329 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:11:09,579 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:11:34,792 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:11:34,953 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:11:46,547 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:11:46,692 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:11:56,924 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:11:57,101 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:12:05,008 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:12:05,167 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:12:19,370 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:12:19,512 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:12:28,397 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:12:28,567 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:12:40,531 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:12:40,710 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:12:52,921 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:12:53,087 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:13:06,879 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:13:07,031 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:13:38,709 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:13:39,209 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:13:46,371 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:13:46,781 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:20:38,347 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:20:38,514 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:20:52,626 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:20:52,766 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:21:17,477 - nl2sql - INFO - endpoints.py:14 - Incoming query: I want to know the user anomalous activity in past 2 hours | Domain: general
2026-01-26 16:21:17,498 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:21:17,505 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 16:21:17,517 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: I want to know the user anomalous activity in past 2 hours
2026-01-26 16:21:17,595 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [emini-3-flash-preview] generating response...
2026-01-26 16:21:18,502 - nl2sql - ERROR - llm.py:99 - LLM Error: 404 models/emini-3-flash-preview is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.
2026-01-26 16:21:18,509 - nl2sql - ERROR - intent_classification.py:95 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 16:21:18,518 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:21:18,940 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 16:21:18,951 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:21:19,817 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 16:21:19,828 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.created_at': "INTERVAL '2 hours'"}
2026-01-26 16:21:19,868 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 16:21:19,892 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:21:19,894 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: I want to know the user anomalous activity in past 2 hours
2026-01-26 16:21:19,929 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: general
2026-01-26 16:21:19,934 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:22:05,051 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT u.username, t.txn_id, t.amount_usd, t.statu...
2026-01-26 16:22:05,056 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT u.username, t.txn_id, t.amount_usd, t.statu...
2026-01-26 16:22:05,059 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT u.username, t.txn_id, t.amount_usd, t.statu...
2026-01-26 16:22:05,071 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:22:05,119 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 16:22:05,125 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT u.username, t.txn_id, t.amount_usd, t.status, t.flag_reason, t.created_at FROM users u JOIN transactions t ON u.user_id = t.user_id WHERE t.created_at >= datetime('now', '-2 hours') AND (UPPER(t.status) LIKE '%FLAG%' OR UPPER(t.status) LIKE '%FAIL%' OR UPPER(t.status) LIKE '%DECLINE%');
2026-01-26 16:22:05,207 - nl2sql - INFO - database.py:60 - Execution complete. Returned 76 rows.
2026-01-26 16:22:05,219 - nl2sql - INFO - workflow.py:101 - Query execution returned 76 rows.
2026-01-26 16:22:05,237 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:22:28,528 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "chart_type": "table",
  "title": "Ano...
2026-01-26 16:22:28,544 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: I want to know the user anomalous activity in past 2 hours
2026-01-26 16:22:28,549 - nl2sql - INFO - endpoints.py:48 - Query success! 76 rows returned.
2026-01-26 16:24:21,810 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:24:22,061 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:24:43,992 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:24:44,130 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:24:53,868 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:24:53,998 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:25:31,276 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:25:32,162 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:25:32,429 - nl2sql - INFO - endpoints.py:14 - Incoming query: I want to know the user anomalous activity in past 2 hours | Domain: general
2026-01-26 16:25:32,441 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:25:32,449 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 16:25:32,449 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: I want to know the user anomalous activity in past 2 hours
2026-01-26 16:25:32,596 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:25:42,614 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "intent": "SELECT",
  "confidence": 0.95,
  "c...
2026-01-26 16:25:42,617 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:25:42,629 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:25:43,317 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 16:25:43,328 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:25:44,229 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 16:25:44,229 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-01-26 16:25:44,229 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:25:44,240 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:25:44,905 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: What kind of anomalous activity are you interested...
2026-01-26 16:25:44,908 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: I want to know the user anomalous activity in past 2 hours
2026-01-26 16:26:26,007 - nl2sql - INFO - endpoints.py:14 - Incoming query: i am looking for login failure | Domain: general
2026-01-26 16:26:26,017 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:26:26,018 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 16:26:26,023 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: i am looking for login failure
2026-01-26 16:26:26,029 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:26:36,670 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "intent": "SELECT",
  "confidence": 0.95,
  "c...
2026-01-26 16:26:36,671 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:26:36,673 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:26:37,086 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 16:26:37,089 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:26:37,830 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 16:26:37,830 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.status': 'FAILED'}
2026-01-26 16:26:37,834 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:26:37,837 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:26:37,837 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: i am looking for login failure
2026-01-26 16:26:37,841 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: general
2026-01-26 16:26:37,842 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:26:42,101 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT * FROM login_events WHERE UPPER(status) LIK...
2026-01-26 16:26:42,106 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT * FROM login_events WHERE UPPER(status) LIK...
2026-01-26 16:26:42,109 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT * FROM login_events WHERE UPPER(status) LIK...
2026-01-26 16:26:42,119 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:26:42,142 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 16:26:42,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM login_events WHERE UPPER(status) LIKE '%FAIL%' OR UPPER(status) LIKE '%FAILURE%' OR UPPER(status) LIKE '%FAILED%';
2026-01-26 16:26:42,195 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50 rows.
2026-01-26 16:26:42,202 - nl2sql - INFO - workflow.py:101 - Query execution returned 50 rows.
2026-01-26 16:26:42,222 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:27:11,083 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "chart_type": "table",
  "title": "Det...
2026-01-26 16:27:11,087 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: i am looking for login failure
2026-01-26 16:27:11,091 - nl2sql - INFO - endpoints.py:48 - Query success! 50 rows returned.
2026-01-26 16:28:04,721 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: operations
2026-01-26 16:28:04,730 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:28:04,735 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 16:28:04,741 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: What are the compliance violations in the last 30 days?
2026-01-26 16:28:04,747 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:28:13,611 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:28:13,633 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:28:13,678 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:28:14,347 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-01-26 16:28:14,389 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:28:14,922 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 16:28:14,938 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-01-26 16:28:15,023 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:28:15,073 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:28:16,033 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: To clarify, could you please specify what kind of ...
2026-01-26 16:28:16,039 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: What are the compliance violations in the last 30 days?
2026-01-26 16:28:30,473 - nl2sql - INFO - endpoints.py:14 - Incoming query: risk level? | Domain: operations
2026-01-26 16:28:30,484 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:28:30,488 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 16:28:30,488 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: risk level?
2026-01-26 16:28:30,492 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:28:43,048 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:28:43,055 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 16:28:43,061 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:28:44,018 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-01-26 16:28:44,037 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:28:45,042 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 16:28:45,046 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-01-26 16:28:45,071 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 16:28:45,087 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:28:45,093 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: operations | Query: risk level?
2026-01-26 16:28:45,122 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: operations
2026-01-26 16:28:45,131 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:28:58,049 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-01-26 16:28:58,055 - nl2sql - INFO - sql_generation.py:114 - SQL Generated and cleaned: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-01-26 16:28:58,061 - nl2sql - INFO - workflow.py:72 - SQL Generated: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-01-26 16:28:58,067 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:28:58,091 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 16:28:58,098 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level, COUNT(user_id) FROM users GROUP BY risk_level;
2026-01-26 16:28:58,125 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:28:58,130 - nl2sql - INFO - workflow.py:101 - Query execution returned 4 rows.
2026-01-26 16:28:58,141 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:29:04,393 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "chart_type": "bar",
  "title": "User Distribu...
2026-01-26 16:29:04,405 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: risk level?
2026-01-26 16:29:04,407 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-26 16:29:33,029 - nl2sql - INFO - endpoints.py:14 - Incoming query: i want to ncheck for flag reason | Domain: operations
2026-01-26 16:29:33,033 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:29:33,042 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 16:29:33,047 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: i want to ncheck for flag reason
2026-01-26 16:29:33,053 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:29:55,648 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:29:55,652 - nl2sql - ERROR - intent_classification.py:95 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 16:29:55,655 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:29:56,684 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["transactions"]...
2026-01-26 16:29:56,700 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:29:57,850 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 16:29:57,855 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-01-26 16:29:57,880 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 16:29:57,895 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:29:57,909 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: operations | Query: i want to ncheck for flag reason
2026-01-26 16:29:57,939 - nl2sql - INFO - sql_generation.py:41 - Using custom SQL prompt for domain: operations
2026-01-26 16:29:57,944 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:30:20,524 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:30:20,528 - nl2sql - WARNING - sql_generation.py:103 - SQL Generation guidance response for query: i want to ncheck for flag reason | Msg: Error generating response: Invalid operation: The ...
2026-01-26 16:30:20,530 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 16:30:20,539 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:30:20,548 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 16:30:20,559 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:30:28,288 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT flag_reason FROM flags;...
2026-01-26 16:30:28,292 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:30:28,311 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 16:30:28,314 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT flag_reason FROM flags;
2026-01-26 16:30:28,329 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: flags
[SQL: SELECT flag_reason FROM flags;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT flag_reason FROM flags;
2026-01-26 16:30:28,334 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 16:30:28,350 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: i want to ncheck for flag reason
2026-01-26 16:30:28,354 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 16:32:06,066 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:32:06,254 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:32:15,381 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:32:15,592 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:33:00,863 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:33:00,867 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 16:33:00,867 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:00,867 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 16:33:00,870 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:00,870 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:00,872 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,872 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT username FROM users WHERE username IS NOT NULL LIMIT 20
2026-01-26 16:33:00,879 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,880 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT age FROM users WHERE age IS NOT NULL LIMIT 20
2026-01-26 16:33:00,880 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,880 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 20
2026-01-26 16:33:00,880 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:00,887 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 20
2026-01-26 16:33:00,890 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:00,891 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 20
2026-01-26 16:33:00,893 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,895 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 20
2026-01-26 16:33:00,897 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:00,898 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 20
2026-01-26 16:33:00,898 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:00,901 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:00,903 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 20
2026-01-26 16:33:00,906 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,906 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 16:33:00,910 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 16:33:00,910 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 20
2026-01-26 16:33:00,914 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,915 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:00,918 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,920 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 20
2026-01-26 16:33:00,922 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 16:33:00,924 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 20
2026-01-26 16:33:00,925 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,927 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 20
2026-01-26 16:33:00,929 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 20
2026-01-26 16:33:00,930 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:00,930 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 20
2026-01-26 16:33:00,936 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,939 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:00,939 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 16:33:00,941 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:00,944 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:00,945 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 20
2026-01-26 16:33:00,948 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:00,948 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 20
2026-01-26 16:33:00,948 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:00,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:00,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,962 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 20
2026-01-26 16:33:00,964 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,966 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 16:33:00,967 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 16:33:00,970 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 20
2026-01-26 16:33:00,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:00,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,979 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 20
2026-01-26 16:33:00,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,979 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:00,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,986 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 20
2026-01-26 16:33:00,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 16:33:00,988 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 20
2026-01-26 16:33:00,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 20
2026-01-26 16:33:00,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:00,996 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 20
2026-01-26 16:33:00,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:00,997 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 20
2026-01-26 16:33:01,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:01,003 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:01,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:01,008 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:01,012 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 16:33:01,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:01,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:01,021 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:33:05,177 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 16:33:41,244 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:33:41,441 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:33:47,621 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:33:47,626 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 16:33:47,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:47,628 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 16:33:47,628 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:47,628 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:47,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT username FROM users WHERE username IS NOT NULL LIMIT 20
2026-01-26 16:33:47,635 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,635 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT age FROM users WHERE age IS NOT NULL LIMIT 20
2026-01-26 16:33:47,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 20
2026-01-26 16:33:47,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:47,640 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 20
2026-01-26 16:33:47,642 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:47,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 20
2026-01-26 16:33:47,645 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 20
2026-01-26 16:33:47,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:47,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 20
2026-01-26 16:33:47,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:47,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:47,651 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 20
2026-01-26 16:33:47,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,655 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 16:33:47,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 16:33:47,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 20
2026-01-26 16:33:47,660 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:47,663 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,663 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 20
2026-01-26 16:33:47,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 16:33:47,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 20
2026-01-26 16:33:47,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,671 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 20
2026-01-26 16:33:47,672 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,672 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 20
2026-01-26 16:33:47,672 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:47,672 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 20
2026-01-26 16:33:47,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,679 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:47,680 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 16:33:47,680 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:47,684 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:47,684 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 20
2026-01-26 16:33:47,687 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:47,688 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 20
2026-01-26 16:33:47,691 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:47,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:47,696 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,697 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 20
2026-01-26 16:33:47,700 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,700 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 16:33:47,703 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 16:33:47,705 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 20
2026-01-26 16:33:47,706 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,706 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:47,706 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,706 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 20
2026-01-26 16:33:47,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,712 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:47,714 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,714 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 20
2026-01-26 16:33:47,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 16:33:47,721 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 20
2026-01-26 16:33:47,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,721 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 20
2026-01-26 16:33:47,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:47,721 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 20
2026-01-26 16:33:47,728 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,728 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 20
2026-01-26 16:33:47,731 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,731 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:47,734 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:47,734 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:47,737 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 16:33:47,738 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:47,741 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:47,747 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:33:52,548 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 16:33:52,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 16:33:52,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:52,560 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 16:33:52,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:52,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:52,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,567 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT username FROM users WHERE username IS NOT NULL LIMIT 20
2026-01-26 16:33:52,568 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,570 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT age FROM users WHERE age IS NOT NULL LIMIT 20
2026-01-26 16:33:52,573 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,575 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 20
2026-01-26 16:33:52,575 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:52,578 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 20
2026-01-26 16:33:52,580 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:52,580 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 20
2026-01-26 16:33:52,583 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,583 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 20
2026-01-26 16:33:52,585 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:52,585 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 20
2026-01-26 16:33:52,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:52,588 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:52,591 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,592 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 20
2026-01-26 16:33:52,592 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,593 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 16:33:52,593 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 16:33:52,593 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 20
2026-01-26 16:33:52,597 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,599 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:52,599 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,599 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 20
2026-01-26 16:33:52,603 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 16:33:52,605 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 20
2026-01-26 16:33:52,607 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,607 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 20
2026-01-26 16:33:52,609 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 20
2026-01-26 16:33:52,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:52,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 20
2026-01-26 16:33:52,615 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:52,617 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 16:33:52,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:52,622 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:52,622 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 20
2026-01-26 16:33:52,625 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:52,625 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 20
2026-01-26 16:33:52,625 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,629 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:52,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:52,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,636 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 20
2026-01-26 16:33:52,638 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,638 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 16:33:52,641 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 16:33:52,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 20
2026-01-26 16:33:52,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,646 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:52,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 20
2026-01-26 16:33:52,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:52,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 20
2026-01-26 16:33:52,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 16:33:52,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 20
2026-01-26 16:33:52,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 20
2026-01-26 16:33:52,664 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:52,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 20
2026-01-26 16:33:52,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,667 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 20
2026-01-26 16:33:52,667 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,670 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:52,672 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:52,674 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:52,674 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 16:33:52,674 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:52,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:52,682 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:33:57,255 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 16:33:57,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 16:33:57,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:57,267 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 16:33:57,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:57,269 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:57,271 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,271 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT username FROM users WHERE username IS NOT NULL LIMIT 20
2026-01-26 16:33:57,273 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,273 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT age FROM users WHERE age IS NOT NULL LIMIT 20
2026-01-26 16:33:57,275 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,275 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 20
2026-01-26 16:33:57,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:57,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 20
2026-01-26 16:33:57,278 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:57,281 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 20
2026-01-26 16:33:57,281 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,283 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 20
2026-01-26 16:33:57,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:33:57,285 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 20
2026-01-26 16:33:57,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:33:57,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:57,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,291 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 20
2026-01-26 16:33:57,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,292 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 16:33:57,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 16:33:57,295 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 20
2026-01-26 16:33:57,295 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:57,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,297 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 20
2026-01-26 16:33:57,297 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 16:33:57,302 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 20
2026-01-26 16:33:57,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 20
2026-01-26 16:33:57,306 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 20
2026-01-26 16:33:57,306 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:33:57,306 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 20
2026-01-26 16:33:57,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,312 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:57,314 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 16:33:57,314 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:57,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:57,318 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 20
2026-01-26 16:33:57,318 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:33:57,320 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 20
2026-01-26 16:33:57,322 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,322 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:57,322 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,322 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:57,327 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,328 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 20
2026-01-26 16:33:57,330 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,330 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 16:33:57,330 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 16:33:57,330 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 20
2026-01-26 16:33:57,335 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:33:57,339 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,340 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 20
2026-01-26 16:33:57,342 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,342 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:33:57,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,345 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 20
2026-01-26 16:33:57,347 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 16:33:57,347 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 20
2026-01-26 16:33:57,349 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,349 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 20
2026-01-26 16:33:57,352 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:57,352 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 20
2026-01-26 16:33:57,354 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,357 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 20
2026-01-26 16:33:57,359 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,359 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:33:57,361 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:33:57,362 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 20
2026-01-26 16:33:57,365 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 16:33:57,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:33:57,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:33:57,370 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:34:01,078 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 16:34:01,086 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 16:34:01,091 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:34:01,092 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 16:34:01,092 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:34:01,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:34:01,092 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,097 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT username FROM users WHERE username IS NOT NULL LIMIT 20
2026-01-26 16:34:01,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT age FROM users WHERE age IS NOT NULL LIMIT 20
2026-01-26 16:34:01,105 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,106 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 20
2026-01-26 16:34:01,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:34:01,111 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 20
2026-01-26 16:34:01,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:34:01,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 20
2026-01-26 16:34:01,119 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,119 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 20
2026-01-26 16:34:01,123 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:34:01,125 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 20
2026-01-26 16:34:01,128 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:34:01,129 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:34:01,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,131 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 20
2026-01-26 16:34:01,131 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,131 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 16:34:01,137 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 16:34:01,137 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 20
2026-01-26 16:34:01,141 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:34:01,142 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 20
2026-01-26 16:34:01,147 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 16:34:01,147 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 20
2026-01-26 16:34:01,147 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 20
2026-01-26 16:34:01,154 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,155 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 20
2026-01-26 16:34:01,155 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:34:01,155 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 20
2026-01-26 16:34:01,155 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,155 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:34:01,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 16:34:01,163 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 20
2026-01-26 16:34:01,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:34:01,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 20
2026-01-26 16:34:01,167 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:34:01,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 20
2026-01-26 16:34:01,172 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:34:01,172 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:34:01,172 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,172 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 20
2026-01-26 16:34:01,178 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,178 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 16:34:01,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 16:34:01,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 20
2026-01-26 16:34:01,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:34:01,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,186 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 20
2026-01-26 16:34:01,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,188 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:34:01,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,191 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 20
2026-01-26 16:34:01,192 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 16:34:01,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 20
2026-01-26 16:34:01,196 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 20
2026-01-26 16:34:01,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:34:01,197 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 20
2026-01-26 16:34:01,197 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,203 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 20
2026-01-26 16:34:01,203 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,204 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:34:01,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:34:01,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 20
2026-01-26 16:34:01,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 16:34:01,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:34:01,211 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:01,217 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:34:05,956 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "refined_schema_context": "This databa...
2026-01-26 16:34:05,966 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-26 16:34:05,966 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:34:05,970 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-26 16:34:05,974 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:34:05,974 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:34:05,974 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:05,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT username FROM users WHERE username IS NOT NULL LIMIT 20
2026-01-26 16:34:05,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:05,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT age FROM users WHERE age IS NOT NULL LIMIT 20
2026-01-26 16:34:05,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:05,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 20
2026-01-26 16:34:05,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:34:05,981 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 20
2026-01-26 16:34:05,981 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:34:05,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 20
2026-01-26 16:34:05,988 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:05,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 20
2026-01-26 16:34:05,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-26 16:34:05,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 20
2026-01-26 16:34:05,994 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-26 16:34:05,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:34:05,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:05,996 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 20
2026-01-26 16:34:05,997 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,000 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-26 16:34:06,000 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-26 16:34:06,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 20
2026-01-26 16:34:06,003 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,003 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:34:06,005 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 20
2026-01-26 16:34:06,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 16:34:06,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 20
2026-01-26 16:34:06,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 20
2026-01-26 16:34:06,007 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,007 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 20
2026-01-26 16:34:06,016 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:34:06,016 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 20
2026-01-26 16:34:06,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,018 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:34:06,018 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-26 16:34:06,023 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 20
2026-01-26 16:34:06,023 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:34:06,023 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 20
2026-01-26 16:34:06,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:34:06,028 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 20
2026-01-26 16:34:06,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,028 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:34:06,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,028 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:34:06,034 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,035 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 20
2026-01-26 16:34:06,036 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,037 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-26 16:34:06,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-26 16:34:06,041 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 20
2026-01-26 16:34:06,042 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 20
2026-01-26 16:34:06,046 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,046 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 20
2026-01-26 16:34:06,048 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,048 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 20
2026-01-26 16:34:06,048 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,048 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 20
2026-01-26 16:34:06,053 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-26 16:34:06,054 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 20
2026-01-26 16:34:06,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,055 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 20
2026-01-26 16:34:06,055 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:34:06,055 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 20
2026-01-26 16:34:06,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,063 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 20
2026-01-26 16:34:06,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,067 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 20
2026-01-26 16:34:06,067 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-26 16:34:06,069 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 20
2026-01-26 16:34:06,071 - nl2sql - INFO - database.py:60 - Execution complete. Returned 9 rows.
2026-01-26 16:34:06,071 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 20
2026-01-26 16:34:06,071 - nl2sql - INFO - database.py:60 - Execution complete. Returned 20 rows.
2026-01-26 16:34:06,081 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:34:09,650 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-26 16:34:58,048 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:34:58,224 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:35:42,407 - nl2sql - INFO - endpoints.py:14 - Incoming query: i want to ncheck for flag reason | Domain: operations
2026-01-26 16:35:42,425 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:35:42,429 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 16:35:42,434 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: i want to ncheck for flag reason
2026-01-26 16:35:42,459 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:35:49,650 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:35:49,660 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-26 16:35:49,671 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:35:50,481 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["transactions"]...
2026-01-26 16:36:30,978 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:36:31,161 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:37:07,078 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:37:08,211 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:37:26,887 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are the last suspicious activity for 2 hrs | Domain: security
2026-01-26 16:37:26,904 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:37:26,911 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:37:26,919 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: what are the last suspicious activity for 2 hrs
2026-01-26 16:37:26,949 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:37:40,097 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:37:40,101 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:37:40,107 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:37:40,943 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events", "transactions"]...
2026-01-26 16:37:40,962 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:37:42,209 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 16:37:42,215 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.failure_reason': 'Suspicious activity', 'login_events.status': 'FAILED'}
2026-01-26 16:37:42,241 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:37:42,264 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:37:43,193 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: When you say "suspicious activity," are you referr...
2026-01-26 16:37:43,202 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are the last suspicious activity for 2 hrs
2026-01-26 16:37:50,434 - nl2sql - INFO - endpoints.py:14 - Incoming query: flagged | Domain: security
2026-01-26 16:37:50,442 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:37:50,442 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:37:50,451 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: flagged
2026-01-26 16:37:50,451 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:37:57,255 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:37:57,258 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:37:57,266 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:37:57,708 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["transactions"]...
2026-01-26 16:37:57,721 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:37:58,704 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 16:37:58,704 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.status': 'FLAGGED'}
2026-01-26 16:37:58,729 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:37:58,745 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:37:58,754 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: flagged
2026-01-26 16:37:58,787 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: security
2026-01-26 16:37:58,795 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:38:47,815 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:38:47,816 - nl2sql - WARNING - sql_generation.py:114 - SQL Generation guidance response for query: flagged | Msg: Error generating response: Invalid operation: The ...
2026-01-26 16:38:47,825 - nl2sql - INFO - workflow.py:72 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 16:38:47,836 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:38:47,844 - nl2sql - WARNING - workflow.py:80 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 16:38:47,855 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:39:10,323 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT * FROM table_name WHERE flagged = 1;...
2026-01-26 16:39:10,329 - nl2sql - INFO - workflow.py:76 - Node: [validate_sql]
2026-01-26 16:39:10,350 - nl2sql - INFO - workflow.py:97 - Node: [execute_query]
2026-01-26 16:39:10,356 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM table_name WHERE flagged = 1;
2026-01-26 16:39:10,362 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: table_name
[SQL: SELECT * FROM table_name WHERE flagged = 1;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM table_name WHERE flagged = 1;
2026-01-26 16:39:10,367 - nl2sql - INFO - workflow.py:101 - Query execution returned 0 rows.
2026-01-26 16:39:10,384 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: flagged
2026-01-26 16:39:10,390 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 16:41:00,682 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:41:00,900 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:41:09,551 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:41:09,809 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:41:36,493 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:41:36,698 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:42:18,493 - nl2sql - INFO - endpoints.py:14 - Incoming query: can you show the last few login attempt whihc is anomalus | Domain: security
2026-01-26 16:42:18,502 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:42:18,504 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:42:18,506 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: can you show the last few login attempt whihc is anomalus
2026-01-26 16:42:18,524 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:42:29,109 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:42:29,123 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:42:29,138 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:42:29,981 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 16:42:29,993 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:42:31,392 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 16:42:31,392 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.status': 'FAILED', 'login_events.failure_reason': 'Suspicious activity'}
2026-01-26 16:42:31,416 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:42:31,447 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:42:32,436 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: To help me identify anomalous login attempts, coul...
2026-01-26 16:42:32,447 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: can you show the last few login attempt whihc is anomalus
2026-01-26 16:42:40,600 - nl2sql - INFO - endpoints.py:14 - Incoming query: faield | Domain: security
2026-01-26 16:42:40,608 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:42:40,613 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:42:40,623 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: faield
2026-01-26 16:42:40,635 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:42:44,995 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:42:45,001 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:42:45,006 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:42:45,775 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 16:42:45,793 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:42:46,923 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 16:42:46,933 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.status': 'FAILED', 'login_events.status': 'FAILED'}
2026-01-26 16:42:46,958 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:42:46,976 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:42:46,985 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: faield
2026-01-26 16:42:47,014 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: security
2026-01-26 16:42:47,022 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:43:08,523 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT event_id, user_id, email_attempted, ip_addr...
2026-01-26 16:43:08,525 - nl2sql - INFO - sql_generation.py:137 - SQL Generated and cleaned: SELECT event_id, user_id, email_attempted, ip_addr...
2026-01-26 16:43:08,531 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT event_id, user_id, email_attempted, ip_addr...
2026-01-26 16:43:08,541 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:43:08,562 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 16:43:08,568 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT event_id, user_id, email_attempted, ip_address, country, city, device_type, status, failure_reason, created_at FROM login_events WHERE UPPER(status) LIKE '%FAILED%' ORDER BY created_at DESC;
2026-01-26 16:43:08,581 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50 rows.
2026-01-26 16:43:08,589 - nl2sql - INFO - workflow.py:102 - Query execution returned 50 rows.
2026-01-26 16:43:08,598 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:43:34,003 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "chart_type": "table",
  "title": "Failed Logi...
2026-01-26 16:43:34,008 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: faield
2026-01-26 16:43:34,008 - nl2sql - INFO - endpoints.py:48 - Query success! 50 rows returned.
2026-01-26 16:44:26,868 - nl2sql - INFO - endpoints.py:14 - Incoming query: which all payment methods are flagged | Domain: security
2026-01-26 16:44:26,876 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:44:26,884 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:44:26,887 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: which all payment methods are flagged
2026-01-26 16:44:26,888 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:44:30,740 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:44:30,747 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:44:30,751 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:44:31,677 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["transactions"]...
2026-01-26 16:44:31,681 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:44:32,890 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 16:44:32,897 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.payment_method': 'Credit Card'}
2026-01-26 16:44:32,929 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:44:32,939 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:44:32,941 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: which all payment methods are flagged
2026-01-26 16:44:32,965 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: security
2026-01-26 16:44:32,969 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:44:46,753 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT DISTINCT payment_method FROM transactions W...
2026-01-26 16:44:46,755 - nl2sql - INFO - sql_generation.py:137 - SQL Generated and cleaned: SELECT DISTINCT payment_method FROM transactions W...
2026-01-26 16:44:46,756 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT DISTINCT payment_method FROM transactions W...
2026-01-26 16:44:46,759 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:44:46,775 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 16:44:46,780 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE UPPER(status) LIKE '%FLAGGED%';
2026-01-26 16:44:46,803 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 16:44:46,806 - nl2sql - INFO - workflow.py:102 - Query execution returned 8 rows.
2026-01-26 16:44:46,817 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:44:52,371 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "chart_type": "table",
  "title": "Flagged Pay...
2026-01-26 16:44:52,375 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: which all payment methods are flagged
2026-01-26 16:44:52,380 - nl2sql - INFO - endpoints.py:48 - Query success! 8 rows returned.
2026-01-26 16:45:18,170 - nl2sql - INFO - endpoints.py:14 - Incoming query: get the user names for debit payments and flaaged | Domain: security
2026-01-26 16:45:18,180 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:45:18,185 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:45:18,187 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: get the user names for debit payments and flaaged
2026-01-26 16:45:18,187 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:45:22,397 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:45:22,402 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:45:22,407 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:45:23,371 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users", "transactions"]...
2026-01-26 16:45:23,378 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:45:24,178 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 16:45:24,178 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.payment_method': 'Debit Card', 'transactions.status': 'FLAGGED'}
2026-01-26 16:45:24,189 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:45:24,202 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:45:24,209 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: get the user names for debit payments and flaaged
2026-01-26 16:45:24,231 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: security
2026-01-26 16:45:24,236 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:46:48,344 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:46:48,346 - nl2sql - WARNING - sql_generation.py:126 - SQL Generation guidance response for query: get the user names for debit payments and flaaged | Msg: Error generating response: Invalid operation: The ...
2026-01-26 16:46:48,346 - nl2sql - INFO - workflow.py:73 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 16:46:48,356 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:46:48,363 - nl2sql - WARNING - workflow.py:81 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 16:46:48,374 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:47:03,497 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:47:03,504 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:47:03,509 - nl2sql - WARNING - workflow.py:81 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 16:47:03,515 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:47:27,210 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT T1.name FROM users AS T1 JOIN payments AS T...
2026-01-26 16:47:27,210 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:47:27,252 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 16:47:27,257 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT T1.name FROM users AS T1 JOIN payments AS T2 ON T1.id = T2.user_id WHERE T2.payment_type = 'debit' AND T2.is_flagged = 1;
2026-01-26 16:47:27,275 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: payments
[SQL: SELECT T1.name FROM users AS T1 JOIN payments AS T2 ON T1.id = T2.user_id WHERE T2.payment_type = 'debit' AND T2.is_flagged = 1;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT T1.name FROM users AS T1 JOIN payments AS T2 ON T1.id = T2.user_id WHERE T2.payment_type = 'debit' AND T2.is_flagged = 1;
2026-01-26 16:47:27,275 - nl2sql - INFO - workflow.py:102 - Query execution returned 0 rows.
2026-01-26 16:47:27,286 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: get the user names for debit payments and flaaged
2026-01-26 16:47:27,287 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 16:49:21,128 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:49:21,441 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:49:28,741 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 16:49:28,952 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 16:50:24,964 - nl2sql - INFO - endpoints.py:14 - Incoming query: "get the user names for debit payments and flagged" | Domain: general
2026-01-26 16:50:24,974 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:50:24,982 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 16:50:24,983 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: "get the user names for debit payments and flagged"
2026-01-26 16:50:25,002 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:50:38,930 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:50:38,941 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 16:50:38,947 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:50:39,468 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users", "transactions"]...
2026-01-26 16:50:39,482 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:50:40,465 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 16:50:40,465 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.payment_method': 'Debit Card', 'transactions.status': 'FLAGGED'}
2026-01-26 16:50:40,485 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 16:50:40,499 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:50:40,507 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: "get the user names for debit payments and flagged"
2026-01-26 16:50:40,524 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-01-26 16:50:40,532 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:51:17,736 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 16:51:17,740 - nl2sql - INFO - sql_generation.py:133 - SQL Generated and cleaned: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 16:51:17,744 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 16:51:17,753 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:51:17,773 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 16:51:17,773 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT u.username FROM users u JOIN transactions t ON u.user_id = t.user_id WHERE UPPER(t.payment_method) LIKE '%DEBIT%' AND UPPER(t.status) LIKE '%FLAGGED%';
2026-01-26 16:51:17,791 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-26 16:51:17,791 - nl2sql - INFO - workflow.py:102 - Query execution returned 10 rows.
2026-01-26 16:51:17,799 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:51:25,800 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "chart_type": "table",
  "title": "Users with ...
2026-01-26 16:51:25,813 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: "get the user names for debit payments and flagged"
2026-01-26 16:51:25,820 - nl2sql - INFO - endpoints.py:48 - Query success! 10 rows returned.
2026-01-26 16:52:17,912 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me the suspended accounts and users age | Domain: security
2026-01-26 16:52:17,920 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:52:17,924 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 16:52:17,928 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: show me the suspended accounts and users age
2026-01-26 16:52:17,937 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:52:35,041 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-26 16:52:35,049 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 16:52:35,052 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:52:35,755 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-01-26 16:52:35,764 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:52:36,652 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "users.acco...
2026-01-26 16:52:36,657 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'users.account_status': 'SUSPENDED'}
2026-01-26 16:52:36,672 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 16:52:36,676 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:52:36,685 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: security | Query: show me the suspended accounts and users age
2026-01-26 16:52:36,702 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: security
2026-01-26 16:52:36,705 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:52:50,632 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT username, age FROM users WHERE UPPER(accoun...
2026-01-26 16:52:50,632 - nl2sql - INFO - sql_generation.py:133 - SQL Generated and cleaned: SELECT username, age FROM users WHERE UPPER(accoun...
2026-01-26 16:52:50,639 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT username, age FROM users WHERE UPPER(accoun...
2026-01-26 16:52:50,644 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:52:50,652 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 16:52:50,652 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT username, age FROM users WHERE UPPER(account_status) LIKE '%SUSPENDED%';
2026-01-26 16:52:50,664 - nl2sql - INFO - database.py:60 - Execution complete. Returned 6 rows.
2026-01-26 16:52:50,666 - nl2sql - INFO - workflow.py:102 - Query execution returned 6 rows.
2026-01-26 16:52:50,670 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:52:55,885 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "chart_type": "bar",
  "title": "Age of Suspen...
2026-01-26 16:52:55,893 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me the suspended accounts and users age
2026-01-26 16:52:55,893 - nl2sql - INFO - endpoints.py:48 - Query success! 6 rows returned.
2026-01-26 16:54:23,111 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: compliance
2026-01-26 16:54:23,124 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:54:23,128 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 16:54:23,131 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: What are the compliance violations in the last 30 days?
2026-01-26 16:54:23,131 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:54:38,490 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:54:38,494 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:54:38,494 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:54:39,225 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["transactions"]...
2026-01-26 16:54:39,236 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:54:40,790 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 16:54:40,793 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.flag_reason': 'AML alert', 'transactions.created_at': '5/29/25 18:11'}
2026-01-26 16:54:40,801 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 16:54:40,815 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:54:41,671 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: To help me find compliance violations, could you p...
2026-01-26 16:54:41,677 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: What are the compliance violations in the last 30 days?
2026-01-26 16:54:55,548 - nl2sql - INFO - endpoints.py:14 - Incoming query: looking for transactions flagged | Domain: compliance
2026-01-26 16:54:55,554 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 16:54:55,559 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 16:54:55,564 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: looking for transactions flagged
2026-01-26 16:54:55,567 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:55:02,127 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 16:55:02,130 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:55:02,134 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:55:03,047 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["transactions"]...
2026-01-26 16:55:03,062 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 16:55:03,868 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 16:55:03,869 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.status': 'FLAGGED'}
2026-01-26 16:55:03,886 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-26 16:55:03,894 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 16:55:03,894 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: looking for transactions flagged
2026-01-26 16:55:03,919 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: compliance
2026-01-26 16:55:03,919 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:55:23,327 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT t.*, u.username FROM transactions t JOIN us...
2026-01-26 16:55:23,330 - nl2sql - INFO - sql_generation.py:133 - SQL Generated and cleaned: SELECT t.*, u.username FROM transactions t JOIN us...
2026-01-26 16:55:23,331 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT t.*, u.username FROM transactions t JOIN us...
2026-01-26 16:55:23,338 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 16:55:23,357 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 16:55:23,357 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT t.*, u.username FROM transactions t JOIN users u ON t.user_id = u.user_id WHERE UPPER(t.status) LIKE '%FLAGGED%' AND t.created_at >= date('2026-01-26', '-30 days');
2026-01-26 16:55:23,371 - nl2sql - INFO - database.py:60 - Execution complete. Returned 40 rows.
2026-01-26 16:55:23,371 - nl2sql - INFO - workflow.py:102 - Query execution returned 40 rows.
2026-01-26 16:55:23,381 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 16:55:42,587 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 16:55:42,597 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: looking for transactions flagged
2026-01-26 16:55:42,604 - nl2sql - INFO - endpoints.py:48 - Query success! 40 rows returned.
2026-01-26 17:00:28,232 - nl2sql - INFO - endpoints.py:14 - Incoming query: what the risk which we can ask | Domain: risk
2026-01-26 17:00:28,246 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:00:28,249 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: risk
2026-01-26 17:00:28,256 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: what the risk which we can ask
2026-01-26 17:00:28,260 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:00:38,946 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "intent": "SCHEMA_QUERY",
  "confidence": 0.95...
2026-01-26 17:00:38,949 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SCHEMA_QUERY (conf: 0.95) | Needs Clarification: False
2026-01-26 17:00:38,952 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:00:39,664 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-01-26 17:00:39,670 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:00:40,428 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "users.risk...
2026-01-26 17:00:40,432 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'users.risk_level': 'HIGH'}
2026-01-26 17:00:40,442 - nl2sql - INFO - workflow.py:34 - Intent classified: SCHEMA_QUERY (conf: 0.95) | Needs Clarification: False
2026-01-26 17:00:40,452 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:00:48,984 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: Hello! As a Database Expert, I can help you unders...
2026-01-26 17:00:48,992 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what the risk which we can ask
2026-01-26 17:01:10,440 - nl2sql - INFO - endpoints.py:14 - Incoming query: Find users who logged in from a new location and immediately made a large transaction | Domain: risk
2026-01-26 17:01:10,448 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:01:10,452 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: risk
2026-01-26 17:01:10,456 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: Find users who logged in from a new location and immediately made a large transaction
2026-01-26 17:01:10,461 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:01:27,694 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-26 17:01:27,698 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 17:01:27,701 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:01:28,622 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users", "login_events", "transactions"]...
2026-01-26 17:01:28,628 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:01:29,433 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 17:01:29,433 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.status': 'COMPLETED', 'login_events.status': 'SUCCESS', 'transactions.flag_reason': 'Unusual pattern'}
2026-01-26 17:01:29,438 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-26 17:01:29,451 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 17:01:29,451 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: risk | Query: Find users who logged in from a new location and immediately made a large transaction
2026-01-26 17:01:29,469 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: risk
2026-01-26 17:01:29,469 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:02:30,268 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 17:02:30,268 - nl2sql - INFO - sql_generation.py:133 - SQL Generated and cleaned: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 17:02:30,273 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT DISTINCT u.username FROM users u JOIN trans...
2026-01-26 17:02:30,273 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:02:30,282 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 17:02:30,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT u.username FROM users u JOIN transactions t ON u.user_id = t.user_id JOIN login_events le ON u.user_id = le.user_id WHERE t.amount_usd > 10000 AND t.created_at >= le.created_at AND (strftime('%s', t.created_at) - strftime('%s', le.created_at)) <= 3600 AND UPPER(le.status) LIKE '%SUCCESS%' AND le.country NOT IN (SELECT le2.country FROM login_events le2 WHERE le2.user_id = u.user_id AND le2.created_at < le.created_at);
2026-01-26 17:02:30,300 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-26 17:02:30,300 - nl2sql - INFO - workflow.py:102 - Query execution returned 0 rows.
2026-01-26 17:02:30,306 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Find users who logged in from a new location and immediately made a large transaction
2026-01-26 17:02:30,307 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 17:14:41,054 - nl2sql - INFO - endpoints.py:14 - Incoming query: Are there multiple failed login attempts on a single account (Account Takeover risk)? | Domain: operations
2026-01-26 17:14:41,067 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:14:41,070 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 17:14:41,079 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: Are there multiple failed login attempts on a single account (Account Takeover risk)?
2026-01-26 17:14:41,090 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:15:05,175 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 17:15:05,175 - nl2sql - ERROR - intent_classification.py:95 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 17:15:05,175 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:15:05,910 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users", "login_events"]...
2026-01-26 17:15:05,932 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:15:06,723 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 17:15:06,726 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.status': 'FAILED', 'login_events.failure_reason': 'Too many attempts'}
2026-01-26 17:15:06,739 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 17:15:06,751 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 17:15:06,754 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: operations | Query: Are there multiple failed login attempts on a single account (Account Takeover risk)?
2026-01-26 17:15:06,769 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: operations
2026-01-26 17:15:06,771 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:15:13,373 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT u.username, COUNT(le.event_id) FROM login_e...
2026-01-26 17:15:13,373 - nl2sql - INFO - sql_generation.py:133 - SQL Generated and cleaned: SELECT u.username, COUNT(le.event_id) FROM login_e...
2026-01-26 17:15:13,373 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT u.username, COUNT(le.event_id) FROM login_e...
2026-01-26 17:15:13,382 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:15:13,391 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 17:15:13,395 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT u.username, COUNT(le.event_id) FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE UPPER(le.status) LIKE '%FAILED%' GROUP BY u.username, u.user_id HAVING COUNT(le.event_id) > 1;
2026-01-26 17:15:13,418 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-26 17:15:13,422 - nl2sql - INFO - workflow.py:102 - Query execution returned 8 rows.
2026-01-26 17:15:13,427 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:15:18,687 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "chart_type": "bar",
  "title": "Failed Login ...
2026-01-26 17:15:18,693 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Are there multiple failed login attempts on a single account (Account Takeover risk)?
2026-01-26 17:15:18,695 - nl2sql - INFO - endpoints.py:48 - Query success! 8 rows returned.
2026-01-26 17:15:55,826 - nl2sql - INFO - endpoints.py:14 - Incoming query: what the different oeprational anomalies | Domain: operations
2026-01-26 17:15:55,834 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:15:55,834 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 17:15:55,838 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: what the different oeprational anomalies
2026-01-26 17:15:55,846 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:16:09,910 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 17:16:09,910 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.7) | Needs Clarification: True
2026-01-26 17:16:09,910 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:16:10,627 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["transactions"]...
2026-01-26 17:16:10,636 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:16:11,484 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 17:16:11,484 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-01-26 17:16:11,497 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.7) | Needs Clarification: True
2026-01-26 17:16:11,505 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:16:12,147 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: Are you interested in operational anomalies relate...
2026-01-26 17:16:12,152 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what the different oeprational anomalies
2026-01-26 17:17:12,174 - nl2sql - INFO - endpoints.py:14 - Incoming query: login events | Domain: operations
2026-01-26 17:17:12,183 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:17:12,185 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 17:17:12,185 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: login events
2026-01-26 17:17:12,190 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:17:23,504 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 17:17:23,507 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 17:17:23,509 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:17:24,471 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 17:17:24,480 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:17:25,471 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 17:17:25,471 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-01-26 17:17:25,482 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 17:17:25,482 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:17:26,359 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: Are you looking for unusual login events, such as ...
2026-01-26 17:17:26,362 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: login events
2026-01-26 17:17:43,822 - nl2sql - INFO - endpoints.py:14 - Incoming query: failed attempts | Domain: operations
2026-01-26 17:17:43,825 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:17:43,826 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: operations
2026-01-26 17:17:43,828 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: failed attempts
2026-01-26 17:17:43,835 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:17:48,463 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "intent": "SELECT",
  "confidence": 0.98,
  "c...
2026-01-26 17:17:48,463 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 17:17:48,463 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:17:49,334 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 17:17:49,345 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:17:50,139 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 17:17:50,139 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.status': 'FAILED'}
2026-01-26 17:17:50,148 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 17:17:50,154 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 17:17:50,158 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: operations | Query: failed attempts
2026-01-26 17:17:50,171 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: operations
2026-01-26 17:17:50,178 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:18:04,822 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:18:04,823 - nl2sql - INFO - sql_generation.py:133 - SQL Generated and cleaned: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:18:04,823 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:18:04,823 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:18:04,839 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 17:18:04,845 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT le.*, u.username FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE UPPER(le.status) LIKE '%FAILED%';
2026-01-26 17:18:04,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50 rows.
2026-01-26 17:18:04,860 - nl2sql - INFO - workflow.py:102 - Query execution returned 50 rows.
2026-01-26 17:18:04,869 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:19:10,912 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "chart_type": "table",
  "title": "Det...
2026-01-26 17:19:10,918 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: failed attempts
2026-01-26 17:19:10,921 - nl2sql - INFO - endpoints.py:48 - Query success! 50 rows returned.
2026-01-26 17:20:22,022 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are the securiy related events which are anomalous | Domain: security
2026-01-26 17:20:22,022 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:20:22,032 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 17:20:22,034 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: what are the securiy related events which are anomalous
2026-01-26 17:20:22,046 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:20:36,261 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 17:20:36,266 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 17:20:36,266 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:20:36,905 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 17:20:36,913 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:20:37,787 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 17:20:37,793 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.failure_reason': 'Suspicious activity'}
2026-01-26 17:20:37,804 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 17:20:37,816 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:20:38,492 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: To identify anomalous security events, what specif...
2026-01-26 17:20:38,496 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are the securiy related events which are anomalous
2026-01-26 17:21:19,309 - nl2sql - INFO - endpoints.py:14 - Incoming query: what about unusaual locations | Domain: compliance
2026-01-26 17:21:19,316 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:21:19,318 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 17:21:19,321 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what about unusaual locations
2026-01-26 17:21:19,329 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:21:24,915 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 17:21:24,915 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 17:21:24,919 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:21:25,668 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 17:21:25,675 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:21:28,423 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 17:21:28,423 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.flag_reason': 'Unusual pattern', 'login_events.failure_reason': 'Suspicious activity'}
2026-01-26 17:21:28,442 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-01-26 17:21:28,454 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:21:29,162 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: When you say "unusual locations" for security even...
2026-01-26 17:21:29,164 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what about unusaual locations
2026-01-26 17:22:02,571 - nl2sql - INFO - endpoints.py:14 - Incoming query: login attempts from coutnries a user has never logged in | Domain: compliance
2026-01-26 17:22:02,571 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:22:02,571 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 17:22:02,581 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: login attempts from coutnries a user has never logged in
2026-01-26 17:22:02,585 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:22:07,059 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 17:22:07,062 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 17:22:07,063 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:22:07,613 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users", "login_events"]...
2026-01-26 17:22:07,613 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:22:08,809 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-26 17:22:08,812 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-01-26 17:22:08,828 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-26 17:22:08,841 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 17:22:08,848 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: login attempts from coutnries a user has never logged in
2026-01-26 17:22:08,876 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: compliance
2026-01-26 17:22:08,878 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:23:13,011 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:23:13,012 - nl2sql - INFO - sql_generation.py:133 - SQL Generated and cleaned: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:23:13,015 - nl2sql - INFO - workflow.py:73 - SQL Generated: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:23:13,021 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:23:13,031 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 17:23:13,033 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT le.*, u.username FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE le.country NOT IN (SELECT le2.country FROM login_events le2 WHERE le2.user_id = le.user_id AND le2.created_at < le.created_at);
2026-01-26 17:23:13,053 - nl2sql - INFO - database.py:60 - Execution complete. Returned 185 rows.
2026-01-26 17:23:13,057 - nl2sql - INFO - workflow.py:102 - Query execution returned 185 rows.
2026-01-26 17:23:13,063 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:23:27,533 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "chart_type": "table",
  "title": "Log...
2026-01-26 17:23:27,537 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: login attempts from coutnries a user has never logged in
2026-01-26 17:23:27,539 - nl2sql - INFO - endpoints.py:48 - Query success! 185 rows returned.
2026-01-26 17:25:09,462 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: security
2026-01-26 17:25:09,467 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:25:09,467 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: security
2026-01-26 17:25:09,472 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Show me all high severity incidents
2026-01-26 17:25:09,479 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:25:14,572 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-26 17:25:14,573 - nl2sql - INFO - intent_classification.py:91 - Classification Result: SELECT (conf: 0.85) | Needs Clarification: True
2026-01-26 17:25:14,574 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:25:14,909 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: []...
2026-01-26 17:25:14,914 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:25:15,862 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-01-26 17:25:15,862 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'transactions.flag_reason': 'High amount', 'users.risk_level': 'HIGH'}
2026-01-26 17:25:15,877 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.85) | Needs Clarification: True
2026-01-26 17:25:15,886 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:25:16,634 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: Are you referring to incidents with a 'HIGH' or 'C...
2026-01-26 17:25:16,636 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: Show me all high severity incidents
2026-01-26 17:25:36,831 - nl2sql - INFO - endpoints.py:14 - Incoming query: lets discuss about compalince rules in UAE about AML | Domain: compliance
2026-01-26 17:25:36,834 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:25:36,835 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: compliance
2026-01-26 17:25:36,835 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: lets discuss about compalince rules in UAE about AML
2026-01-26 17:25:36,838 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:25:51,031 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 17:25:51,036 - nl2sql - ERROR - intent_classification.py:95 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 17:25:51,039 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:25:51,684 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: []...
2026-01-26 17:25:51,690 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:25:52,665 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 17:25:52,665 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.country': 'UAE', 'login_events.currency': 'AED'}
2026-01-26 17:25:52,679 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 17:25:52,687 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 17:25:52,690 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: compliance | Query: lets discuss about compalince rules in UAE about AML
2026-01-26 17:25:52,704 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: compliance
2026-01-26 17:25:52,707 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:27:07,266 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 17:27:07,271 - nl2sql - WARNING - sql_generation.py:122 - SQL Generation guidance response for query: lets discuss about compalince rules in UAE about AML | Msg: Error generating response: Invalid operation: The ...
2026-01-26 17:27:07,271 - nl2sql - INFO - workflow.py:73 - SQL Generated: Error generating response: Invalid operation: The ...
2026-01-26 17:27:07,272 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:27:07,273 - nl2sql - WARNING - workflow.py:81 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 17:27:07,274 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:27:19,406 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 17:27:19,407 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:27:19,409 - nl2sql - WARNING - workflow.py:81 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 17:27:19,410 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:27:25,897 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 17:27:25,902 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:27:25,902 - nl2sql - WARNING - workflow.py:81 - SQL Validation Error: Error tokenizing 'oogle.dev/api/generate-content#finishreason) is 1'
2026-01-26 17:27:25,902 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:27:30,761 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT * FROM compliance_rules WHERE country = 'UA...
2026-01-26 17:27:30,761 - nl2sql - INFO - workflow.py:77 - Node: [validate_sql]
2026-01-26 17:27:30,761 - nl2sql - INFO - workflow.py:98 - Node: [execute_query]
2026-01-26 17:27:30,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM compliance_rules WHERE country = 'UAE' AND category = 'AML';
2026-01-26 17:27:30,774 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: compliance_rules
[SQL: SELECT * FROM compliance_rules WHERE country = 'UAE' AND category = 'AML';]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM compliance_rules WHERE country = 'UAE' AND category = 'AML';
2026-01-26 17:27:30,775 - nl2sql - INFO - workflow.py:102 - Query execution returned 0 rows.
2026-01-26 17:27:30,777 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: lets discuss about compalince rules in UAE about AML
2026-01-26 17:27:30,778 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-26 17:30:18,702 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 17:30:18,837 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 17:30:33,882 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 17:30:33,981 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 17:31:04,496 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 17:31:04,609 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 17:31:19,479 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 17:31:19,607 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 17:31:29,809 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 17:31:29,921 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 17:32:23,865 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsightnew.db
2026-01-26 17:32:23,999 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-26 17:32:36,920 - nl2sql - INFO - endpoints.py:14 - Incoming query: lets discuss about compalince rules in UAE about AML ? | Domain: general
2026-01-26 17:32:36,928 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:32:36,929 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 17:32:36,931 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: lets discuss about compalince rules in UAE about AML ?
2026-01-26 17:32:36,936 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:32:44,893 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "OFF_TOPIC",
  "confidence":...
2026-01-26 17:32:44,893 - nl2sql - INFO - intent_classification.py:95 - Classification Result: OFF_TOPIC (conf: 0.95) | Needs Clarification: True
2026-01-26 17:32:44,896 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:32:45,502 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: []...
2026-01-26 17:32:45,510 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:32:46,605 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 17:32:46,610 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.country': 'UAE'}
2026-01-26 17:32:46,611 - nl2sql - INFO - workflow.py:34 - Intent classified: OFF_TOPIC (conf: 0.95) | Needs Clarification: True
2026-01-26 17:32:46,635 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:32:59,024 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: I'm a database assistant focused on specific inter...
2026-01-26 17:32:59,024 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: lets discuss about compalince rules in UAE about AML ?
2026-01-26 17:35:02,537 - nl2sql - INFO - endpoints.py:14 - Incoming query: Suspicious login activity to track unauthorized access or security risks in the login logs. | Domain: general
2026-01-26 17:35:02,546 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-01-26 17:35:02,547 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-01-26 17:35:02,556 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Suspicious login activity to track unauthorized access or security risks in the login logs.
2026-01-26 17:35:02,561 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:35:42,861 - nl2sql - ERROR - llm.py:99 - LLM Error: Invalid operation: The `response.text` quick accessor requires the response to contain a valid `Part`, but none were returned. The candidate's [finish_reason](https://ai.google.dev/api/generate-content#finishreason) is 1.
2026-01-26 17:35:42,867 - nl2sql - ERROR - intent_classification.py:99 - Intent classification error: Expecting value: line 1 column 1 (char 0)
2026-01-26 17:35:42,868 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:35:43,514 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-01-26 17:35:43,524 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-01-26 17:35:44,480 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-01-26 17:35:44,482 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.failure_reason': 'Suspicious activity', 'login_events.status': 'FAILED'}
2026-01-26 17:35:44,489 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-26 17:35:44,496 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-01-26 17:35:44,504 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: Suspicious login activity to track unauthorized access or security risks in the login logs.
2026-01-26 17:35:44,515 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-01-26 17:35:44,522 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:35:56,302 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:35:56,302 - nl2sql - INFO - sql_generation.py:134 - SQL Generated and cleaned: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:35:56,304 - nl2sql - INFO - workflow.py:83 - SQL Generated: SELECT le.*, u.username FROM login_events le JOIN ...
2026-01-26 17:35:56,312 - nl2sql - INFO - workflow.py:87 - Node: [validate_sql]
2026-01-26 17:35:56,333 - nl2sql - INFO - workflow.py:108 - Node: [execute_query]
2026-01-26 17:35:56,337 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT le.*, u.username FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE UPPER(le.status) LIKE '%FAILED%' OR UPPER(le.failure_reason) LIKE '%SUSPICIOUS%' OR UPPER(le.failure_reason) LIKE '%UNAUTHORIZED%';
2026-01-26 17:35:56,350 - nl2sql - INFO - database.py:60 - Execution complete. Returned 55 rows.
2026-01-26 17:35:56,354 - nl2sql - INFO - workflow.py:112 - Query execution returned 55 rows.
2026-01-26 17:35:56,361 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-01-26 17:36:54,438 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Suspi...
2026-01-26 17:36:54,438 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Suspicious login activity to track unauthorized access or security risks in the login logs.
2026-01-26 17:36:54,446 - nl2sql - INFO - endpoints.py:48 - Query success! 55 rows returned.
=======
2026-01-25 14:31:48,587 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:31:48,827 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:31:50,873 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:17,274 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:17,315 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:17,333 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:28,802 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:28,887 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:28,903 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:40,242 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:40,278 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:32:40,290 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:03,987 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:04,024 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:04,070 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:04,110 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:04,157 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:04,185 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:15,121 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:15,156 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:15,196 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:15,199 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:15,229 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:15,233 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:30,801 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:30,833 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:30,872 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:30,892 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:30,922 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:30,953 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:45,018 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:45,035 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:45,042 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:45,068 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:45,149 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:45,168 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:54,259 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:54,289 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:54,293 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:54,300 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:33:54,327 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:33:54,335 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:11,210 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:11,238 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:11,244 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:11,261 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:11,285 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:11,293 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:36,195 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:36,237 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:36,285 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:36,317 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:36,320 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:36,355 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:46,272 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:46,280 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:46,308 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:34:46,313 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:46,320 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:34:46,344 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:35:10,246 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:35:10,316 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:36:30,778 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: risk
2026-01-25 14:36:30,784 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:36:30,791 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: What are the compliance violations in the last 30 days?
2026-01-25 14:36:30,798 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:36:32,822 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:36:32,825 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:36:32,829 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:36:32,912 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:36:32,912 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: What are the compliance violations in the last 30 days?
2026-01-25 14:36:32,922 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:36:33,928 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain inform...
2026-01-25 14:36:33,932 - nl2sql - WARNING - sql_generation.py:69 - SQL Generation guidance response for query: What are the compliance violations in the last 30 days? | Msg: Error: The database schema does not contain inform...
2026-01-25 14:36:33,935 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not contain inform...
2026-01-25 14:36:33,941 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:36:33,943 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain information about compliance violations. Try asking about: users, transacti
2026-01-25 14:36:33,951 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:36:35,089 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT * FROM audit_logs WHERE timestamp...
2026-01-25 14:36:35,092 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:36:35,096 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));
2026-01-25 14:36:35,106 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:36:36,046 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM audit_logs WHERE timestamp >= strfti...
2026-01-25 14:36:36,052 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:36:36,069 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:36:36,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));
2026-01-25 14:36:36,078 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: timestamp
[SQL: SELECT * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM audit_logs WHERE timestamp >= strftime('%Y-%m-%d %H:%M:%S', date('now', '-30 days'));
2026-01-25 14:36:36,078 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:36:36,082 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the compliance violations in the last 30 days?
2026-01-25 14:36:36,091 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:37:06,792 - nl2sql - INFO - endpoints.py:14 - Incoming query: show the compliace violations | Domain: risk
2026-01-25 14:37:06,797 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:37:06,801 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: show the compliace violations
2026-01-25 14:37:06,803 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:37:07,744 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:37:07,744 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 14:37:07,751 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 14:37:07,801 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 14:37:08,739 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Could you please specify the time range you'd like...
2026-01-25 14:37:08,742 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: show the compliace violations
2026-01-25 14:37:18,698 - nl2sql - INFO - endpoints.py:14 - Incoming query: last year | Domain: risk
2026-01-25 14:37:18,699 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:37:18,705 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: last year
2026-01-25 14:37:18,705 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:37:19,792 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:37:19,792 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:19,795 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:19,850 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:37:19,853 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: last year
2026-01-25 14:37:19,857 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:37:20,989 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Your request is not clear. Please specify w...
2026-01-25 14:37:20,992 - nl2sql - WARNING - sql_generation.py:69 - SQL Generation guidance response for query: last year | Msg: Error: Your request is not clear. Please specify w...
2026-01-25 14:37:20,995 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Your request is not clear. Please specify w...
2026-01-25 14:37:20,999 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:21,004 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: Your [4mrequest[0m is not clear. Please specify which data from the last year you want to query. Try asking about: use
2026-01-25 14:37:21,014 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:37:22,457 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT * FROM users WHERE strftime('%Y',...
2026-01-25 14:37:22,463 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:22,469 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));
2026-01-25 14:37:22,473 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:37:23,339 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE strftime('%Y', registrat...
2026-01-25 14:37:23,342 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:23,355 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:37:23,359 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));
2026-01-25 14:37:23,363 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: registration_date
[SQL: SELECT * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM users WHERE strftime('%Y', registration_date) = strftime('%Y', date('now', '-1 year'));
2026-01-25 14:37:23,367 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:37:23,373 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: last year
2026-01-25 14:37:23,378 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:37:36,265 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents and the count | Domain: risk
2026-01-25 14:37:36,269 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:37:36,274 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: Show me all high severity incidents and the count
2026-01-25 14:37:36,282 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:37:37,203 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:37:37,206 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:37,207 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:37:37,277 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:37:37,281 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: Show me all high severity incidents and the count
2026-01-25 14:37:37,283 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:37:38,093 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT severity, COUNT(*) FROM alerts WHERE severi...
2026-01-25 14:37:38,095 - nl2sql - INFO - sql_generation.py:80 - SQL Generated and cleaned: SELECT severity, COUNT(*) FROM alerts WHERE severi...
2026-01-25 14:37:38,095 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT severity, COUNT(*) FROM alerts WHERE severi...
2026-01-25 14:37:38,104 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:37:38,121 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:37:38,121 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT severity, COUNT(*) FROM alerts WHERE severity = 'HIGH' GROUP BY severity;
2026-01-25 14:37:38,133 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 14:37:38,135 - nl2sql - INFO - workflow.py:92 - Query execution returned 1 rows.
2026-01-25 14:37:38,140 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:37:39,460 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Count...
2026-01-25 14:37:39,468 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents and the count
2026-01-25 14:37:39,471 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-01-25 14:38:48,036 - nl2sql - INFO - endpoints.py:14 - Incoming query: List all open security risks | Domain: risk
2026-01-25 14:38:48,043 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:38:48,046 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: List all open security risks
2026-01-25 14:38:48,046 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:38:49,236 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:38:49,241 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:38:49,245 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:38:49,308 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:38:49,313 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: List all open security risks
2026-01-25 14:38:49,314 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:38:50,356 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sql
SELECT alert_id, rule_name, severity, user_...
2026-01-25 14:38:50,360 - nl2sql - INFO - sql_generation.py:80 - SQL Generated and cleaned: SELECT alert_id, rule_name, severity, user_id, tra...
2026-01-25 14:38:50,363 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT alert_id, rule_name, severity, user_id, tra...
2026-01-25 14:38:50,370 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:38:50,379 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:38:50,383 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT alert_id, rule_name, severity, user_id, transaction_id FROM alerts WHERE status = 'OPEN';
2026-01-25 14:38:50,385 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT alert_id, rule_name, severity, user_id, transaction_id FROM alerts WHERE status = 'OPEN';]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT alert_id, rule_name, severity, user_id, transaction_id FROM alerts WHERE status = 'OPEN';
2026-01-25 14:38:50,392 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:38:50,402 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: List all open security risks
2026-01-25 14:38:50,402 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:44:27,327 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:27,362 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:27,469 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:27,507 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:28,625 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:28,640 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:46,166 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:46,199 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:46,212 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:46,216 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:44:46,255 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:44:46,262 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:45:11,892 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:45:11,909 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:45:28,091 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: security
2026-01-25 14:45:28,098 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:45:28,098 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Show me all high severity incidents
2026-01-25 14:45:28,112 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:45:29,613 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:45:29,618 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:45:29,618 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:45:29,630 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:45:31,005 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "severity":...
2026-01-25 14:45:31,006 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 14:45:31,012 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:45:31,012 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: Show me all high severity incidents
2026-01-25 14:45:31,014 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 14:45:31,972 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT alert_id, rule_name, user_id, txn_id, detai...
2026-01-25 14:45:31,974 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT alert_id, rule_name, user_id, txn_id, detai...
2026-01-25 14:45:31,974 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT alert_id, rule_name, user_id, txn_id, detai...
2026-01-25 14:45:31,978 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:45:31,983 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:45:31,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT alert_id, rule_name, user_id, txn_id, details FROM alerts WHERE severity = 'HIGH';
2026-01-25 14:45:31,990 - nl2sql - INFO - database.py:60 - Execution complete. Returned 99 rows.
2026-01-25 14:45:31,992 - nl2sql - INFO - workflow.py:92 - Query execution returned 99 rows.
2026-01-25 14:45:31,992 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:45:33,573 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Hig...
2026-01-25 14:45:33,578 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 14:45:33,578 - nl2sql - INFO - endpoints.py:48 - Query success! 99 rows returned.
2026-01-25 14:46:01,984 - nl2sql - INFO - endpoints.py:14 - Incoming query: what is this domian speciality | Domain: risk
2026-01-25 14:46:01,992 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:46:01,996 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: what is this domian speciality
2026-01-25 14:46:01,996 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:46:03,037 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "UNKNOWN",
  "confidence": 0...
2026-01-25 14:46:03,042 - nl2sql - INFO - intent_classification.py:81 - Classification Result: UNKNOWN (conf: 0.3) | Needs Clarification: True
2026-01-25 14:46:03,042 - nl2sql - INFO - workflow.py:24 - Intent classified: UNKNOWN (conf: 0.3) | Needs Clarification: True
2026-01-25 14:46:03,050 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:46:04,380 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:46:04,384 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:46:04,393 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 14:46:05,308 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Could you please tell me which area of the RISK do...
2026-01-25 14:46:05,314 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what is this domian speciality
2026-01-25 14:46:22,141 - nl2sql - INFO - endpoints.py:14 - Incoming query: which table has data related to fruad detection | Domain: risk
2026-01-25 14:46:22,141 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:46:22,150 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: which table has data related to fruad detection
2026-01-25 14:46:22,159 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:46:23,205 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:46:23,205 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:23,209 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:23,215 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:46:24,203 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:46:24,203 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:46:24,213 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:46:24,213 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: which table has data related to fruad detection
2026-01-25 14:46:24,224 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:46:25,299 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not explicitly con...
2026-01-25 14:46:25,301 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: which table has data related to fruad detection | Msg: Error: The database schema does not explicitly con...
2026-01-25 14:46:25,304 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not explicitly con...
2026-01-25 14:46:25,310 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:25,314 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not explicitly contain a "fraud detection" table. However, the `alerts`, `transactions`
2026-01-25 14:46:25,322 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:46:26,355 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT DISTINCT tbl_name FROM sqlite_mas...
2026-01-25 14:46:26,360 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:26,363 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m DISTINCT tbl_name FROM sqlite_master WHERE type = 'table' AND tbl_name IN ('alerts', 'transactions'
2026-01-25 14:46:26,371 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:46:27,222 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT tbl_name FROM sqlite_master WHERE ...
2026-01-25 14:46:27,225 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:27,238 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:46:27,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT tbl_name FROM sqlite_master WHERE type = 'table' AND tbl_name IN ('alerts', 'transactions', 'users', 'login_events');
2026-01-25 14:46:27,245 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 14:46:27,259 - nl2sql - INFO - workflow.py:92 - Query execution returned 4 rows.
2026-01-25 14:46:27,264 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:46:28,432 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Tab...
2026-01-25 14:46:28,441 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: which table has data related to fruad detection
2026-01-25 14:46:28,443 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-25 14:46:46,517 - nl2sql - INFO - endpoints.py:14 - Incoming query: ok what the columns in transcations table | Domain: risk
2026-01-25 14:46:46,524 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:46:46,531 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: ok what the columns in transcations table
2026-01-25 14:46:46,534 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:46:47,797 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:46:47,797 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:47,806 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:46:47,811 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:46:48,659 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:46:48,662 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:46:48,668 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:46:48,668 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: ok what the columns in transcations table
2026-01-25 14:46:48,678 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:46:49,679 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:46:49,682 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:46:49,686 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:46:49,690 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:46:49,703 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:46:49,703 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5
2026-01-25 14:46:49,708 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5
2026-01-25 14:46:49,715 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:46:49,727 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: ok what the columns in transcations table
2026-01-25 14:46:49,731 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:47:34,240 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are the cloumns in transcation table | Domain: risk
2026-01-25 14:47:34,245 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:47:34,248 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: what are the cloumns in transcation table
2026-01-25 14:47:34,255 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:47:35,170 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:47:35,173 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:47:35,178 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:47:35,187 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:47:36,069 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:47:36,071 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:47:36,079 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:47:36,082 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: what are the cloumns in transcation table
2026-01-25 14:47:36,083 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:47:37,061 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: To understand the columns in the `transacti...
2026-01-25 14:47:37,065 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: what are the cloumns in transcation table | Msg: Error: To understand the columns in the `transacti...
2026-01-25 14:47:37,065 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: To understand the columns in the `transacti...
2026-01-25 14:47:37,073 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:47:37,078 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 20.
  Error: To [4munderstand[0m the columns in the `transactions` table, query a few rows from it, for example using `SELECT * FROM
2026-01-25 14:47:37,087 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 14:47:37,882 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions LIMIT 5;
...
2026-01-25 14:47:37,892 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:47:37,900 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:47:37,900 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions LIMIT 5;
2026-01-25 14:47:37,905 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 14:47:37,911 - nl2sql - INFO - workflow.py:92 - Query execution returned 5 rows.
2026-01-25 14:47:37,914 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:47:39,328 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Sam...
2026-01-25 14:47:39,336 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: what are the cloumns in transcation table
2026-01-25 14:47:39,342 - nl2sql - INFO - endpoints.py:48 - Query success! 5 rows returned.
2026-01-25 14:48:05,591 - nl2sql - INFO - endpoints.py:14 - Incoming query: give me only the column names from transaction table | Domain: risk
2026-01-25 14:48:05,600 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:48:05,600 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: risk | Query: give me only the column names from transaction table
2026-01-25 14:48:05,606 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:48:06,650 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:48:06,656 - nl2sql - INFO - intent_classification.py:81 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:48:06,657 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:48:06,662 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:48:07,591 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:48:07,595 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:48:07,602 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:48:07,602 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: risk | Query: give me only the column names from transaction table
2026-01-25 14:48:07,611 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the risk doma...
2026-01-25 14:48:08,633 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:48:08,636 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:48:08,637 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT transaction_id, user_id, transaction_type, ...
2026-01-25 14:48:08,642 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:48:08,652 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:48:08,659 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5;
2026-01-25 14:48:08,662 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT transaction_id, user_id, transaction_type, instrument, amount, currency, amount_usd, status, flag_reason, payment_method, external_reference, ip_address, created_at, processing_at FROM transactions LIMIT 5;
2026-01-25 14:48:08,668 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 14:48:08,678 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: give me only the column names from transaction table
2026-01-25 14:48:08,685 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 14:48:59,713 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:48:59,752 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:48:59,760 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:48:59,794 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:00,741 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:00,762 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:12,558 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:12,572 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:12,597 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:12,600 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:12,616 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:12,640 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:49:28,389 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 14:49:28,405 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 14:51:28,161 - nl2sql - INFO - endpoints.py:14 - Incoming query: What columns are in the transactions table? | Domain: general
2026-01-25 14:51:28,169 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:51:28,169 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: What columns are in the transactions table?
2026-01-25 14:51:28,182 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:51:29,965 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 14:51:29,969 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-25 14:51:29,969 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 1.0) | Needs Clarification: False
2026-01-25 14:51:29,982 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:51:30,888 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:51:30,890 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:51:30,909 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 14:51:34,336 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Okay, here's a breakdown of the columns within the...
2026-01-25 14:51:34,341 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: What columns are in the transactions table?
2026-01-25 14:56:25,353 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: general
2026-01-25 14:56:25,360 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:56:25,363 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show me all high severity incidents
2026-01-25 14:56:25,369 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:56:27,665 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:56:27,668 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:56:27,672 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:56:27,678 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:56:28,771 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "severity":...
2026-01-25 14:56:28,771 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 14:56:28,783 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:56:28,788 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show me all high severity incidents
2026-01-25 14:56:28,796 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 14:56:29,755 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE severity = 'HIGH';
...
2026-01-25 14:56:29,757 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM alerts WHERE severity = 'HIGH';...
2026-01-25 14:56:29,760 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM alerts WHERE severity = 'HIGH';...
2026-01-25 14:56:29,762 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:56:29,782 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 14:56:29,784 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE severity = 'HIGH';
2026-01-25 14:56:29,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 99 rows.
2026-01-25 14:56:29,801 - nl2sql - INFO - workflow.py:92 - Query execution returned 99 rows.
2026-01-25 14:56:29,809 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 14:56:31,466 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Hig...
2026-01-25 14:56:31,466 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 14:56:31,478 - nl2sql - INFO - endpoints.py:48 - Query success! 99 rows returned.
2026-01-25 14:59:54,949 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show operational metrics for last quarter | Domain: general
2026-01-25 14:59:54,957 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 14:59:54,962 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show operational metrics for last quarter
2026-01-25 14:59:54,965 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 14:59:56,164 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 14:59:56,166 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:59:56,170 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-01-25 14:59:56,179 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 14:59:57,228 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 14:59:57,233 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 14:59:57,241 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 14:59:57,245 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show operational metrics for last quarter
2026-01-25 14:59:57,252 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 14:59:58,621 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain specif...
2026-01-25 14:59:58,624 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show operational metrics for last quarter | Msg: Error: The database schema does not contain specif...
2026-01-25 14:59:58,628 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not contain specif...
2026-01-25 14:59:58,633 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 14:59:58,633 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain specific tables or columns for operational metrics. Try asking about: users
2026-01-25 14:59:58,648 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:00:00,009 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```sqlite
SELECT
  COUNT(T.transaction_id)
FROM tr...
2026-01-25 15:00:00,013 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:00:00,021 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 2, Col: 6.
  ite
[4mSELECT[0m
  COUNT(T.transaction_id)
FROM transactions AS T
WHERE
  T.timestamp BETWEEN date('now', '-3 months
2026-01-25 15:00:00,030 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:00:00,983 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT
  COUNT(transaction_id)
FROM transactions
W...
2026-01-25 15:00:00,991 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:00:00,996 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:00:00,996 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT
  COUNT(transaction_id)
FROM transactions
WHERE
  timestamp BETWEEN date('now', '-3 months') AND date('now');
2026-01-25 15:00:01,012 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_id
[SQL: SELECT
  COUNT(transaction_id)
FROM transactions
WHERE
  timestamp BETWEEN date('now', '-3 months') AND date('now');]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT
  COUNT(transaction_id)
FROM transactions
WHERE
  timestamp BETWEEN date('now', '-3 months') AND date('now');
2026-01-25 15:00:01,020 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:00:01,033 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show operational metrics for last quarter
2026-01-25 15:00:01,036 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:01:43,658 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are you capabitliies | Domain: security
2026-01-25 15:01:43,664 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:01:43,666 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: what are you capabitliies
2026-01-25 15:01:43,671 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:01:44,794 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 15:01:44,794 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.95) | Needs Clarification: False
2026-01-25 15:01:44,802 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 0.95) | Needs Clarification: False
2026-01-25 15:01:44,812 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:01:45,754 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:01:45,760 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:01:45,768 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 15:02:04,766 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Okay, here's a breakdown of the database schema an...
2026-01-25 15:02:04,766 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are you capabitliies
2026-01-25 15:03:56,788 - nl2sql - INFO - endpoints.py:14 - Incoming query: ok show me good visaulization of user queries | Domain: security
2026-01-25 15:03:56,792 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:03:56,792 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: ok show me good visaulization of user queries
2026-01-25 15:03:56,803 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:03:58,007 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "UNKNOWN",
  "confidence": 0...
2026-01-25 15:03:58,009 - nl2sql - INFO - intent_classification.py:82 - Classification Result: UNKNOWN (conf: 0.6) | Needs Clarification: True
2026-01-25 15:03:58,012 - nl2sql - INFO - workflow.py:24 - Intent classified: UNKNOWN (conf: 0.6) | Needs Clarification: True
2026-01-25 15:03:58,015 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:03:59,013 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:03:59,013 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:03:59,028 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:04:00,270 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: What kind of user queries are you interested in vi...
2026-01-25 15:04:00,274 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: ok show me good visaulization of user queries
2026-01-25 15:04:05,442 - nl2sql - INFO - endpoints.py:14 - Incoming query: signups | Domain: security
2026-01-25 15:04:05,446 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:04:05,446 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: signups
2026-01-25 15:04:05,452 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:04:06,433 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:04:06,433 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.8) | Needs Clarification: True
2026-01-25 15:04:06,441 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.8) | Needs Clarification: True
2026-01-25 15:04:06,442 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:04:07,596 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:04:07,601 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:04:07,635 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:04:08,842 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: What time range are you interested in for signups ...
2026-01-25 15:04:08,846 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: signups
2026-01-25 15:04:14,462 - nl2sql - INFO - endpoints.py:14 - Incoming query: daily | Domain: security
2026-01-25 15:04:14,469 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:04:14,469 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: daily
2026-01-25 15:04:14,478 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:04:15,403 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:04:15,409 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:04:15,412 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:04:15,415 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:04:16,513 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:04:16,517 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:04:16,526 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:04:16,531 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: daily
2026-01-25 15:04:16,536 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 15:04:17,516 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Please specify what information about "dail...
2026-01-25 15:04:17,525 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: daily | Msg: Error: Please specify what information about "dail...
2026-01-25 15:04:17,525 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Please specify what information about "dail...
2026-01-25 15:04:17,533 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:04:17,536 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 21.
  Error: Please [4mspecify[0m what information about "daily" you want to retrieve. Try asking about: users, transactions, alerts,
2026-01-25 15:04:17,542 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:04:18,388 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM daily;
...
2026-01-25 15:04:18,392 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:04:18,401 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:04:18,405 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM daily;
2026-01-25 15:04:18,409 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such table: daily
[SQL: SELECT * FROM daily;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM daily;
2026-01-25 15:04:18,411 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:04:18,421 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: daily
2026-01-25 15:04:18,427 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:05:55,067 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:05:55,069 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:05:55,087 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:05:55,096 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:05:57,630 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:05:57,655 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:06:29,047 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: security
2026-01-25 15:06:29,063 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:06:29,063 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:06:29,073 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:06:34,603 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 0.98,
  "c...
2026-01-25 15:06:34,603 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-25 15:06:34,603 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-01-25 15:06:34,613 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:07:43,838 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:07:43,840 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:07:43,852 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: security
2026-01-25 15:07:43,862 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:07:43,864 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: security | Query: Show me all high severity incidents
2026-01-25 15:07:43,869 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:07:46,647 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-01-25 15:07:46,651 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:07:46,651 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:07:46,659 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:07:50,609 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "severity": "HIGH"
...
2026-01-25 15:07:50,612 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 15:07:50,656 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:07:50,660 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:07:50,663 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 15:08:04,005 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-25 15:08:04,005 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-25 15:08:04,005 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM alerts WHERE created_at >= datetime(...
2026-01-25 15:08:04,011 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:08:04,012 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:08:04,016 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: security | Query: Show me all high severity incidents
2026-01-25 15:08:04,016 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the security ...
2026-01-25 15:08:08,595 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT alert_id, rule_name, user_id, severity, sta...
2026-01-25 15:08:08,595 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT alert_id, rule_name, user_id, severity, sta...
2026-01-25 15:08:08,600 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT alert_id, rule_name, user_id, severity, sta...
2026-01-25 15:08:08,604 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:08:08,612 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:08:08,612 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE created_at >= datetime('now', '-30 days');
2026-01-25 15:08:08,626 - nl2sql - INFO - database.py:60 - Execution complete. Returned 161 rows.
2026-01-25 15:08:08,627 - nl2sql - INFO - workflow.py:92 - Query execution returned 161 rows.
2026-01-25 15:08:08,633 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 15:08:17,826 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "Compliance ...
2026-01-25 15:08:17,828 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:08:17,828 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT alert_id, rule_name, user_id, severity, status, created_at FROM alerts WHERE severity = 'HIGH';
2026-01-25 15:08:17,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 99 rows.
2026-01-25 15:08:17,835 - nl2sql - INFO - workflow.py:92 - Query execution returned 99 rows.
2026-01-25 15:08:17,837 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 15:08:28,807 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "chart_type": "table",
  "title": "High Severi...
2026-01-25 15:08:28,813 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the compliance violations in the last 30 days?
2026-01-25 15:08:28,815 - nl2sql - INFO - endpoints.py:48 - Query success! 161 rows returned.
2026-01-25 15:08:28,831 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 15:08:28,834 - nl2sql - INFO - endpoints.py:48 - Query success! 99 rows returned.
2026-01-25 15:10:34,976 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:10:34,976 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:10:35,079 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:10:35,088 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:10:37,328 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 15:10:37,352 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 15:10:37,375 - nl2sql - INFO - endpoints.py:14 - Incoming query: What are the compliance violations in the last 30 days? | Domain: general
2026-01-25 15:10:37,378 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:10:37,381 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:10:37,387 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:10:39,260 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:10:39,261 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:10:39,262 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:10:39,262 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:10:39,802 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:10:39,803 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:10:39,808 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:10:39,809 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: What are the compliance violations in the last 30 days?
2026-01-25 15:10:39,812 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 15:10:40,925 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT DISTINCT alert_rules.rule_name FROM alerts ...
2026-01-25 15:10:40,928 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT DISTINCT alert_rules.rule_name FROM alerts ...
2026-01-25 15:10:40,928 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT DISTINCT alert_rules.rule_name FROM alerts ...
2026-01-25 15:10:40,928 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:10:40,933 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:10:40,933 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_rules.rule_name FROM alerts JOIN alert_rules ON alerts.rule_id = alert_rules.rule_id WHERE alerts.severity IN ('HIGH', 'CRITICAL') AND alerts.creation_timestamp >= date('now', '-30 days')
2026-01-25 15:10:40,938 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: alerts.creation_timestamp
[SQL: SELECT DISTINCT alert_rules.rule_name FROM alerts JOIN alert_rules ON alerts.rule_id = alert_rules.rule_id WHERE alerts.severity IN ('HIGH', 'CRITICAL') AND alerts.creation_timestamp >= date('now', '-30 days')]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT DISTINCT alert_rules.rule_name FROM alerts JOIN alert_rules ON alerts.rule_id = alert_rules.rule_id WHERE alerts.severity IN ('HIGH', 'CRITICAL') AND alerts.creation_timestamp >= date('now', '-30 days')
2026-01-25 15:10:40,938 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:10:40,942 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: What are the compliance violations in the last 30 days?
2026-01-25 15:10:40,942 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:11:16,772 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show operational metrics for last quarter | Domain: general
2026-01-25 15:11:16,772 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:11:16,780 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show operational metrics for last quarter
2026-01-25 15:11:16,783 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:11:17,543 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:11:17,545 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:11:17,545 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:11:17,551 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:11:18,305 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:11:18,307 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:11:18,312 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:11:18,316 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show operational metrics for last quarter
2026-01-25 15:11:18,316 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 15:11:19,089 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Cannot determine "operational metrics" from...
2026-01-25 15:11:19,092 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show operational metrics for last quarter | Msg: Error: Cannot determine "operational metrics" from...
2026-01-25 15:11:19,096 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Cannot determine "operational metrics" from...
2026-01-25 15:11:19,098 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:19,105 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 23.
  Error: Cannot [4mdetermine[0m "operational metrics" from the provided schema. Try asking about: users, transactions, login_events
2026-01-25 15:11:19,112 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:11:19,973 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(*) FROM login_events WHERE event_time...
2026-01-25 15:11:19,978 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:19,991 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:11:19,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(*) FROM login_events WHERE event_timestamp >= date('now', '-3 months')
2026-01-25 15:11:19,997 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: event_timestamp
[SQL: SELECT COUNT(*) FROM login_events WHERE event_timestamp >= date('now', '-3 months')]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT COUNT(*) FROM login_events WHERE event_timestamp >= date('now', '-3 months')
2026-01-25 15:11:19,997 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:11:20,005 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show operational metrics for last quarter
2026-01-25 15:11:20,009 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:11:42,012 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me operation metrics all | Domain: general
2026-01-25 15:11:42,016 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:11:42,025 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me operation metrics all
2026-01-25 15:11:42,030 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:11:42,981 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:11:42,983 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:11:42,983 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 15:11:42,992 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:11:43,743 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:11:43,746 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:11:43,749 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:11:43,754 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: show me operation metrics all
2026-01-25 15:11:43,754 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 15:11:44,353 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: "operation metrics" is too vague. Try askin...
2026-01-25 15:11:44,355 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: show me operation metrics all | Msg: Error: "operation metrics" is too vague. Try askin...
2026-01-25 15:11:44,355 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: "operation metrics" is too vague. Try askin...
2026-01-25 15:11:44,363 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:44,363 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 29.
  Error: "operation metrics" [4mis[0m too vague. Try asking about: transactions, login_events, alerts.
2026-01-25 15:11:44,371 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:11:45,078 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions UNION ALL SELECT * FROM...
2026-01-25 15:11:45,082 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:11:45,095 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:11:45,098 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions UNION ALL SELECT * FROM login_events UNION ALL SELECT * FROM alerts
2026-01-25 15:11:45,102 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) SELECTs to the left and right of UNION ALL do not have the same number of result columns
[SQL: SELECT * FROM transactions UNION ALL SELECT * FROM login_events UNION ALL SELECT * FROM alerts]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM transactions UNION ALL SELECT * FROM login_events UNION ALL SELECT * FROM alerts
2026-01-25 15:11:45,104 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:11:45,115 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me operation metrics all
2026-01-25 15:11:45,117 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:12:07,304 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me all operational metrics | Domain: operations
2026-01-25 15:12:07,312 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:12:07,312 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: operations | Query: show me all operational metrics
2026-01-25 15:12:07,312 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:12:07,971 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:12:07,971 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:12:07,977 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:12:07,983 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:12:08,970 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:12:08,974 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:12:08,983 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:12:08,983 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: operations | Query: show me all operational metrics
2026-01-25 15:12:08,991 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the operation...
2026-01-25 15:12:10,034 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The term "operational metrics" is too broad...
2026-01-25 15:12:10,034 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: show me all operational metrics | Msg: Error: The term "operational metrics" is too broad...
2026-01-25 15:12:10,034 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The term "operational metrics" is too broad...
2026-01-25 15:12:10,041 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:12:10,050 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 15.
  Error: The [4mterm[0m "operational metrics" is too broad. Please specify which operational metrics you are interested in.
2026-01-25 15:12:10,058 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:12:10,819 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM transactions...
2026-01-25 15:12:10,824 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:12:10,833 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:12:10,833 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM transactions
2026-01-25 15:12:12,836 - nl2sql - INFO - database.py:60 - Execution complete. Returned 50000 rows.
2026-01-25 15:12:12,836 - nl2sql - INFO - workflow.py:92 - Query execution returned 50000 rows.
2026-01-25 15:12:12,842 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 15:12:14,188 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "All...
2026-01-25 15:12:14,197 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me all operational metrics
2026-01-25 15:12:14,201 - nl2sql - INFO - endpoints.py:48 - Query success! 50000 rows returned.
2026-01-25 15:18:08,767 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are complaice in UAE ? | Domain: compliance
2026-01-25 15:18:08,791 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:18:08,797 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what are complaice in UAE ?
2026-01-25 15:18:08,819 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:18:10,238 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:18:10,238 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:18:10,242 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:18:10,262 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:18:11,136 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "country": ...
2026-01-25 15:18:11,136 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'country': 'AE'}
2026-01-25 15:18:11,152 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:18:11,683 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: To help me understand what you're looking for rega...
2026-01-25 15:18:11,685 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are complaice in UAE ?
2026-01-25 15:18:29,425 - nl2sql - INFO - endpoints.py:14 - Incoming query: politcally expoed person | Domain: compliance
2026-01-25 15:18:29,430 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:18:29,431 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: politcally expoed person
2026-01-25 15:18:29,436 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:18:30,492 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:18:30,492 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:18:30,492 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:18:30,501 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:18:31,368 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "is_pep": t...
2026-01-25 15:18:31,371 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'is_pep': True}
2026-01-25 15:18:31,378 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:18:31,385 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: politcally expoed person
2026-01-25 15:18:31,392 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 15:18:32,013 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, email FROM users WHERE pep_status ...
2026-01-25 15:18:32,020 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT user_id, email FROM users WHERE pep_status ...
2026-01-25 15:18:32,023 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT user_id, email FROM users WHERE pep_status ...
2026-01-25 15:18:32,023 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:18:32,042 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:18:32,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, email FROM users WHERE pep_status = 1
2026-01-25 15:18:32,080 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: pep_status
[SQL: SELECT user_id, email FROM users WHERE pep_status = 1]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT user_id, email FROM users WHERE pep_status = 1
2026-01-25 15:18:32,083 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:18:32,092 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: politcally expoed person
2026-01-25 15:18:32,099 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 15:22:47,413 - nl2sql - INFO - endpoints.py:14 - Incoming query: accroding to transaction monitoring rules in UAE  apid Fund MovementDeposit + withdrawal within short periodAML red flag ..lets see from our data if we are complaint | Domain: compliance
2026-01-25 15:22:47,421 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:22:47,421 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: accroding to transaction monitoring rules in UAE  apid Fund MovementDeposit + withdrawal within short periodAML red flag ..lets see from our data if we are complaint
2026-01-25 15:22:47,430 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:22:49,327 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:22:49,327 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:22:49,332 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-01-25 15:22:49,340 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:22:50,305 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "country": ...
2026-01-25 15:22:50,305 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'country': 'AE', 'transaction_type': ['DEPOSIT', 'WITHDRAWAL']}
2026-01-25 15:22:50,333 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:22:51,192 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: To help me check your compliance with UAE transact...
2026-01-25 15:22:51,195 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: accroding to transaction monitoring rules in UAE  apid Fund MovementDeposit + withdrawal within short periodAML red flag ..lets see from our data if we are complaint
2026-01-25 15:23:10,743 - nl2sql - INFO - endpoints.py:14 - Incoming query: lets whatever time period we have | Domain: compliance
2026-01-25 15:23:10,751 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:23:10,751 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: lets whatever time period we have
2026-01-25 15:23:10,760 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:23:11,602 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 15:23:11,608 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.7) | Needs Clarification: True
2026-01-25 15:23:11,610 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.7) | Needs Clarification: True
2026-01-25 15:23:11,612 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:23:12,492 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:23:12,496 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:23:12,499 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-01-25 15:23:14,479 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: To effectively check for rapid fund movements, cou...
2026-01-25 15:23:14,482 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: lets whatever time period we have
2026-01-25 15:23:22,078 - nl2sql - INFO - endpoints.py:14 - Incoming query: 24 hrs | Domain: compliance
2026-01-25 15:23:22,083 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 15:23:22,083 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: 24 hrs
2026-01-25 15:23:22,093 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 15:23:23,033 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 15:23:23,033 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:23:23,033 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 15:23:23,045 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 15:23:23,887 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 15:23:23,887 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 15:23:23,896 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 15:23:23,900 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: 24 hrs
2026-01-25 15:23:23,905 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 15:23:25,018 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The request "24 hrs" is too vague. It's unc...
2026-01-25 15:23:25,021 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: 24 hrs | Msg: Error: The request "24 hrs" is too vague. It's unc...
2026-01-25 15:23:25,022 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The request "24 hrs" is too vague. It's unc...
2026-01-25 15:23:25,028 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:23:25,030 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Error tokenizing 'y asking about: transactions, login_events, alert'
2026-01-25 15:23:25,047 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:23:26,474 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: This request is to fix an invalid SQL query based ...
2026-01-25 15:23:26,478 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:23:26,496 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 15.
  This request [4mis[0m to fix an invalid SQL query based on the provided error message. The error message indicates that t
2026-01-25 15:23:26,504 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 15:23:27,297 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT COUNT(*) FROM transactions WHERE transactio...
2026-01-25 15:23:27,299 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 15:23:27,319 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 15:23:27,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT COUNT(*) FROM transactions WHERE transaction_time >= strftime('%s', 'now', '-24 hours')
2026-01-25 15:23:27,337 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: transaction_time
[SQL: SELECT COUNT(*) FROM transactions WHERE transaction_time >= strftime('%s', 'now', '-24 hours')]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT COUNT(*) FROM transactions WHERE transaction_time >= strftime('%s', 'now', '-24 hours')
2026-01-25 15:23:27,339 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-01-25 15:23:27,347 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: 24 hrs
2026-01-25 15:23:27,351 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-01-25 16:03:59,009 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:03:59,009 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:03:59,057 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:03:59,060 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:04:10,829 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:04:10,850 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:04:10,870 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:04:10,890 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:04:19,034 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-01-25 16:04:19,058 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:19,063 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:19,063 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:19,066 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:19,066 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,069 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,071 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:19,075 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,075 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:19,078 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:19,082 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,083 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,089 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,091 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,093 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:19,098 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,098 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:19,100 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:19,108 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:19,108 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,113 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,115 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,117 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,118 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,120 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:19,122 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:19,123 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,125 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,128 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,133 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,133 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:19,205 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,205 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:19,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,229 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:19,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:19,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:19,728 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,728 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,783 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,785 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:19,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,799 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:19,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,816 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,829 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,829 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,830 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,830 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:19,832 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:19,832 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,837 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,838 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,841 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:19,846 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,846 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:19,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:19,863 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,863 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:19,940 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:19,941 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:19,951 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,951 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:19,954 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,955 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:19,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,962 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:19,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:19,970 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:19,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,977 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,979 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,980 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:19,982 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:19,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:19,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:19,986 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,987 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:19,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:19,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:19,991 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:19,991 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:19,995 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:20,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:20,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,021 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,021 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,025 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,029 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,029 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,033 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,035 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:20,037 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:20,037 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:20,040 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:20,042 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:20,045 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,045 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:20,048 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,050 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:20,054 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,062 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,064 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:20,064 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:20,064 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,070 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,074 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,076 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,079 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:20,099 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,100 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:20,103 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,103 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,109 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,110 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:20,149 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:20,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:20,153 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,153 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,160 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,161 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:20,165 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:20,167 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:20,171 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,171 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,179 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,179 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:20,182 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,182 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:20,187 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,187 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:20,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:20,201 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:20,206 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,206 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:20,208 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,210 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,214 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:20,214 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:20,216 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:20,218 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:20,221 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:20,231 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:20,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:20,237 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,238 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:20,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:20,244 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:25,466 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:25,470 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:25,478 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:25,478 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:25,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:25,482 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,486 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,488 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:25,492 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,492 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,497 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,497 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:25,504 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,504 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:25,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,512 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:25,515 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,517 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,521 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,521 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,526 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,528 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:25,531 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,533 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:25,535 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:25,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,541 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,547 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,554 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,554 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,557 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,557 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:25,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:25,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,564 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,564 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,569 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,571 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,578 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,578 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:25,583 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,586 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:25,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,590 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:25,612 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:25,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,620 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,630 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,630 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:25,650 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,653 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:25,670 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,670 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:25,677 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,679 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:25,679 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,681 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,682 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,684 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,686 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,688 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:25,690 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:25,690 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:25,692 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,702 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:25,702 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,702 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:25,714 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:25,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,733 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:25,741 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:25,746 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,759 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:25,768 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,770 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,778 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:25,778 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:25,778 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,782 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,783 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,785 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,787 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,787 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,789 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,790 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,791 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,794 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,797 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:25,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,799 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:25,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:25,802 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:25,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,806 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:25,806 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,808 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,810 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,812 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:25,814 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:25,814 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,816 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,818 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:25,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:25,822 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,824 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,825 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,827 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,829 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:25,831 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,831 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,833 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:25,841 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:25,844 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:25,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,853 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:25,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:25,857 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,857 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,861 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:25,864 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,865 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,868 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,870 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:25,873 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:25,877 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,878 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:25,880 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:25,882 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:25,882 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,885 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:25,887 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,890 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,892 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,892 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,895 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:25,895 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:25,895 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:25,899 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,899 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,903 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:25,905 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,905 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:25,907 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,907 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:25,909 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:25,912 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,918 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:25,919 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:25,922 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:30,241 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:30,266 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:30,268 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:30,270 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:30,270 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:30,270 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,279 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:30,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,288 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,290 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:30,292 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,294 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:30,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,296 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:30,296 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,304 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,305 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,305 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,311 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:30,311 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,316 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:30,316 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,319 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:30,322 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,322 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:30,324 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:30,324 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,328 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,328 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,333 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,335 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,335 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:30,340 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:30,341 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,341 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,344 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,345 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,345 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,357 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,358 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:30,362 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,364 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:30,366 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,366 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:30,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,396 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:30,396 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,402 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,405 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,412 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:30,431 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,433 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:30,453 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,460 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:30,462 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:30,469 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,471 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:30,477 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,479 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:30,479 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,482 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:30,482 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,485 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:30,494 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,494 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,508 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,508 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:30,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,512 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:30,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,533 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:30,533 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:30,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,537 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,540 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,541 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:30,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,544 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:30,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:30,560 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,560 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:30,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,566 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,566 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:30,568 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:30,569 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,571 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,573 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,573 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,575 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,576 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,577 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,579 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,581 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,582 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,582 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:30,584 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:30,590 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,592 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:30,594 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:30,602 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,608 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,609 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,611 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,613 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:30,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,617 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:30,620 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,621 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,621 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,624 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:30,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:30,627 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:30,627 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:30,632 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,641 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:30,641 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,645 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,647 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,647 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:30,649 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,649 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:30,651 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,651 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:30,654 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:30,656 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:30,658 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,660 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:30,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,664 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,666 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,666 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:30,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,678 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:30,681 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,683 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:30,685 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,685 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:30,688 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,688 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:30,691 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,693 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:30,695 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:30,695 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:34,914 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:34,929 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:34,933 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:34,935 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:34,937 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:34,939 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:34,942 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,943 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:34,945 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,946 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:34,947 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,947 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:34,953 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,954 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,957 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:34,962 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:34,962 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,964 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:34,970 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:34,971 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:34,978 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:34,980 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:34,980 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:34,983 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,983 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:34,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,987 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:34,987 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:34,990 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:34,992 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:35,002 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,012 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:35,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,028 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:35,028 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,033 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:35,036 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,040 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:35,044 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,057 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:35,080 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,082 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:35,084 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,085 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:35,087 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,087 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,090 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,092 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,094 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,102 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,104 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:35,111 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:35,112 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,112 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:35,128 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,128 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,140 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:35,142 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:35,143 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,143 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:35,152 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,152 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:35,158 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:35,160 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:35,162 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,169 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:35,177 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,178 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:35,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,180 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:35,180 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,183 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,186 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:35,186 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:35,190 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,191 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,193 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,194 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:35,202 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:35,209 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:35,210 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,212 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,217 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:35,219 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,226 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,228 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,228 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:35,232 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,232 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:35,234 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,235 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,235 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,235 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:35,240 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,242 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:35,250 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,253 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:35,259 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:35,260 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,262 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,267 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,275 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:35,277 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,278 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:35,280 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,280 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:35,282 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,282 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:35,283 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,285 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:35,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,287 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:35,287 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:35,290 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:39,454 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:04:39,500 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';
2026-01-25 16:04:39,502 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:39,503 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(users);
2026-01-25 16:04:39,505 - nl2sql - INFO - database.py:60 - Execution complete. Returned 15 rows.
2026-01-25 16:04:39,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM users WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,507 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,507 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email FROM users WHERE email IS NOT NULL LIMIT 5
2026-01-25 16:04:39,511 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT full_name FROM users WHERE full_name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,513 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,513 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM users WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:39,518 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,519 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT phone FROM users WHERE phone IS NOT NULL LIMIT 5
2026-01-25 16:04:39,520 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,520 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT date_of_birth FROM users WHERE date_of_birth IS NOT NULL LIMIT 5
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_status FROM users WHERE kyc_status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,524 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_verified_at FROM users WHERE kyc_verified_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,529 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT kyc_expiry_date FROM users WHERE kyc_expiry_date IS NOT NULL LIMIT 5
2026-01-25 16:04:39,529 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,532 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_level FROM users WHERE risk_level IS NOT NULL LIMIT 5
2026-01-25 16:04:39,532 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT risk_score FROM users WHERE risk_score IS NOT NULL LIMIT 5
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_pep FROM users WHERE is_pep IS NOT NULL LIMIT 5
2026-01-25 16:04:39,534 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:39,540 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT account_status FROM users WHERE account_status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,542 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM users WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,542 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,544 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT updated_at FROM users WHERE updated_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(transactions);
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:60 - Execution complete. Returned 14 rows.
2026-01-25 16:04:39,546 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM transactions WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,553 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM transactions WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,555 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,555 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_type FROM transactions WHERE txn_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT instrument FROM transactions WHERE instrument IS NOT NULL LIMIT 5
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount FROM transactions WHERE amount IS NOT NULL LIMIT 5
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,562 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT currency FROM transactions WHERE currency IS NOT NULL LIMIT 5
2026-01-25 16:04:39,588 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT amount_usd FROM transactions WHERE amount_usd IS NOT NULL LIMIT 5
2026-01-25 16:04:39,591 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,591 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM transactions WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,600 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,600 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT flag_reason FROM transactions WHERE flag_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:39,616 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,616 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT payment_method FROM transactions WHERE payment_method IS NOT NULL LIMIT 5
2026-01-25 16:04:39,636 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT external_ref FROM transactions WHERE external_ref IS NOT NULL LIMIT 5
2026-01-25 16:04:39,637 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,637 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM transactions WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:39,640 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,642 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM transactions WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,643 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT processed_at FROM transactions WHERE processed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(login_events);
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT event_id FROM login_events WHERE event_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,644 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,651 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM login_events WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,652 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,652 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT email_attempted FROM login_events WHERE email_attempted IS NOT NULL LIMIT 5
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM login_events WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,655 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT country FROM login_events WHERE country IS NOT NULL LIMIT 5
2026-01-25 16:04:39,660 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT city FROM login_events WHERE city IS NOT NULL LIMIT 5
2026-01-25 16:04:39,669 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,669 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_type FROM login_events WHERE device_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,678 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,678 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT device_fingerprint FROM login_events WHERE device_fingerprint IS NOT NULL LIMIT 5
2026-01-25 16:04:39,696 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,698 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_agent FROM login_events WHERE user_agent IS NOT NULL LIMIT 5
2026-01-25 16:04:39,706 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,709 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM login_events WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,712 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-01-25 16:04:39,714 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT failure_reason FROM login_events WHERE failure_reason IS NOT NULL LIMIT 5
2026-01-25 16:04:39,716 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,716 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM login_events WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,718 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,719 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alert_rules);
2026-01-25 16:04:39,721 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:39,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alert_rules WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,723 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,723 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alert_rules WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,725 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,726 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_type FROM alert_rules WHERE rule_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,729 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,729 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT condition FROM alert_rules WHERE condition IS NOT NULL LIMIT 5
2026-01-25 16:04:39,731 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,732 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alert_rules WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:39,733 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,734 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_active FROM alert_rules WHERE is_active IS NOT NULL LIMIT 5
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alert_rules WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,735 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(alerts);
2026-01-25 16:04:39,740 - nl2sql - INFO - database.py:60 - Execution complete. Returned 12 rows.
2026-01-25 16:04:39,741 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT alert_id FROM alerts WHERE alert_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,743 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_name FROM alerts WHERE rule_name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT rule_id FROM alerts WHERE rule_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM alerts WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,745 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT txn_id FROM alerts WHERE txn_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT severity FROM alerts WHERE severity IS NOT NULL LIMIT 5
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT status FROM alerts WHERE status IS NOT NULL LIMIT 5
2026-01-25 16:04:39,752 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:04:39,759 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT details FROM alerts WHERE details IS NOT NULL LIMIT 5
2026-01-25 16:04:39,760 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,761 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT assigned_to FROM alerts WHERE assigned_to IS NOT NULL LIMIT 5
2026-01-25 16:04:39,762 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,762 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolved_at FROM alerts WHERE resolved_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,764 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,764 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resolution_notes FROM alerts WHERE resolution_notes IS NOT NULL LIMIT 5
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM alerts WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(audit_logs);
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 8 rows.
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT log_id FROM audit_logs WHERE log_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,766 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,775 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT actor_id FROM audit_logs WHERE actor_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,776 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,778 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT action FROM audit_logs WHERE action IS NOT NULL LIMIT 5
2026-01-25 16:04:39,781 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,781 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_type FROM audit_logs WHERE resource_type IS NOT NULL LIMIT 5
2026-01-25 16:04:39,783 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,783 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT resource_id FROM audit_logs WHERE resource_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,785 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,785 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_text FROM audit_logs WHERE query_text IS NOT NULL LIMIT 5
2026-01-25 16:04:39,794 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-01-25 16:04:39,796 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT ip_address FROM audit_logs WHERE ip_address IS NOT NULL LIMIT 5
2026-01-25 16:04:39,797 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,799 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM audit_logs WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,799 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,801 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(dashboards);
2026-01-25 16:04:39,804 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-01-25 16:04:39,804 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT dashboard_id FROM dashboards WHERE dashboard_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,805 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,805 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT name FROM dashboards WHERE name IS NOT NULL LIMIT 5
2026-01-25 16:04:39,809 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,811 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT owner_id FROM dashboards WHERE owner_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,813 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,815 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT widgets FROM dashboards WHERE widgets IS NOT NULL LIMIT 5
2026-01-25 16:04:39,815 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,817 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT layout FROM dashboards WHERE layout IS NOT NULL LIMIT 5
2026-01-25 16:04:39,820 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_deployed FROM dashboards WHERE is_deployed IS NOT NULL LIMIT 5
2026-01-25 16:04:39,821 - nl2sql - INFO - database.py:60 - Execution complete. Returned 2 rows.
2026-01-25 16:04:39,821 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deploy_url FROM dashboards WHERE deploy_url IS NOT NULL LIMIT 5
2026-01-25 16:04:39,828 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,828 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT refresh_interval FROM dashboards WHERE refresh_interval IS NOT NULL LIMIT 5
2026-01-25 16:04:39,831 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,832 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM dashboards WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,833 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,835 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT deployed_at FROM dashboards WHERE deployed_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,835 - nl2sql - INFO - database.py:60 - Execution complete. Returned 5 rows.
2026-01-25 16:04:39,835 - nl2sql - INFO - database.py:53 - Executing SQL: PRAGMA table_info(query_history);
2026-01-25 16:04:39,842 - nl2sql - INFO - database.py:60 - Execution complete. Returned 7 rows.
2026-01-25 16:04:39,842 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT query_id FROM query_history WHERE query_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,844 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,844 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT user_id FROM query_history WHERE user_id IS NOT NULL LIMIT 5
2026-01-25 16:04:39,848 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,848 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT nl_query FROM query_history WHERE nl_query IS NOT NULL LIMIT 5
2026-01-25 16:04:39,851 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,853 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT generated_sql FROM query_history WHERE generated_sql IS NOT NULL LIMIT 5
2026-01-25 16:04:39,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,855 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT result_count FROM query_history WHERE result_count IS NOT NULL LIMIT 5
2026-01-25 16:04:39,855 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,864 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT is_favorite FROM query_history WHERE is_favorite IS NOT NULL LIMIT 5
2026-01-25 16:04:39,867 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,873 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT DISTINCT created_at FROM query_history WHERE created_at IS NOT NULL LIMIT 5
2026-01-25 16:04:39,875 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-01-25 16:04:39,880 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert Data Scientist and System Archi...
2026-01-25 16:04:44,752 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "refined_schema_context": "The databas...
2026-01-25 16:31:11,686 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 16:31:11,686 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 16:31:11,747 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:31:11,752 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:31:24,874 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_hackathon.db
2026-01-25 16:31:24,908 - nl2sql - INFO - main.py:11 - Starting NL2SQL Pipeline on port 8080...
2026-01-25 16:32:49,822 - nl2sql - INFO - endpoints.py:14 - Incoming query: what are the complaince data capabilities | Domain: compliance
2026-01-25 16:32:49,834 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:32:49,842 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: what are the complaince data capabilities
2026-01-25 16:32:49,852 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:32:51,254 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SCHEMA_QUERY",
  "confidenc...
2026-01-25 16:32:51,255 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SCHEMA_QUERY (conf: 0.8) | Needs Clarification: False
2026-01-25 16:32:51,255 - nl2sql - INFO - workflow.py:24 - Intent classified: SCHEMA_QUERY (conf: 0.8) | Needs Clarification: False
2026-01-25 16:32:51,270 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:32:52,368 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 16:32:52,368 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 16:32:52,378 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
        You are a Database Expert. The user wants...
2026-01-25 16:32:59,181 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: As a Database Expert, I can help you understand th...
2026-01-25 16:32:59,186 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: what are the complaince data capabilities
2026-01-25 16:34:32,592 - nl2sql - INFO - endpoints.py:14 - Incoming query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)? | Domain: compliance
2026-01-25 16:34:32,598 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:34:32,598 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)?
2026-01-25 16:34:32,606 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:34:33,492 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:34:33,492 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:34:33,496 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:34:33,505 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:34:34,155 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "kyc_status...
2026-01-25 16:34:34,155 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'kyc_status': ['PENDING', 'VERIFIED']}
2026-01-25 16:34:34,163 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:34:34,170 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)?
2026-01-25 16:34:34,170 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 16:34:34,894 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-25 16:34:34,897 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-25 16:34:34,903 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT kyc_status, COUNT(*) FROM users GROUP BY ky...
2026-01-25 16:34:34,903 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:34:34,921 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:34:34,928 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT kyc_status, COUNT(*) FROM users GROUP BY kyc_status
2026-01-25 16:34:34,942 - nl2sql - INFO - database.py:60 - Execution complete. Returned 4 rows.
2026-01-25 16:34:34,946 - nl2sql - INFO - workflow.py:92 - Query execution returned 4 rows.
2026-01-25 16:34:34,952 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:34:35,798 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "User ...
2026-01-25 16:34:35,801 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: How many users are in each kyc_status category (e.g., PENDING, VERIFIED)?
2026-01-25 16:34:35,801 - nl2sql - INFO - endpoints.py:48 - Query success! 4 rows returned.
2026-01-25 16:34:48,313 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show me all high severity incidents | Domain: compliance
2026-01-25 16:34:48,313 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:34:48,321 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: Show me all high severity incidents
2026-01-25 16:34:48,321 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:34:49,525 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-01-25 16:34:49,528 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 16:34:49,531 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-01-25 16:34:49,536 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:34:50,629 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "severity":...
2026-01-25 16:34:50,630 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'severity': 'HIGH'}
2026-01-25 16:34:50,635 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:34:50,641 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: Show me all high severity incidents
2026-01-25 16:34:50,643 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 16:34:51,442 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 16:34:51,442 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 16:34:51,447 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM alerts WHERE severity = 'HIGH'...
2026-01-25 16:34:51,454 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:34:51,465 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:34:51,466 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM alerts WHERE severity = 'HIGH'
2026-01-25 16:34:51,493 - nl2sql - INFO - database.py:60 - Execution complete. Returned 239 rows.
2026-01-25 16:34:51,493 - nl2sql - INFO - workflow.py:92 - Query execution returned 239 rows.
2026-01-25 16:34:51,499 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:34:52,596 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Hig...
2026-01-25 16:34:52,610 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show me all high severity incidents
2026-01-25 16:34:52,612 - nl2sql - INFO - endpoints.py:48 - Query success! 239 rows returned.
2026-01-25 16:40:55,802 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me user with rsik score more than 25 | Domain: compliance
2026-01-25 16:40:55,811 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:40:55,813 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: compliance | Query: show me user with rsik score more than 25
2026-01-25 16:40:55,815 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:40:56,712 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:40:56,714 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:40:56,714 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:40:56,722 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:40:57,592 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-01-25 16:40:57,592 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-01-25 16:40:57,599 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:40:57,599 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: compliance | Query: show me user with rsik score more than 25
2026-01-25 16:40:57,606 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the complianc...
2026-01-25 16:40:59,091 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The provided schema does not contain a 'ris...
2026-01-25 16:40:59,091 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: show me user with rsik score more than 25 | Msg: Error: The provided schema does not contain a 'ris...
2026-01-25 16:40:59,091 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The provided schema does not contain a 'ris...
2026-01-25 16:40:59,099 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:40:59,107 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mprovided[0m schema does not contain a 'risk_score' column for users or a direct way to query by a numerical ris
2026-01-25 16:40:59,114 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-01-25 16:41:00,094 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE risk_level = 'HIGH'...
2026-01-25 16:41:00,101 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:41:00,113 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:41:00,114 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE risk_level = 'HIGH'
2026-01-25 16:41:00,117 - nl2sql - INFO - database.py:60 - Execution complete. Returned 17 rows.
2026-01-25 16:41:00,119 - nl2sql - INFO - workflow.py:92 - Query execution returned 17 rows.
2026-01-25 16:41:00,123 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:41:01,290 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Use...
2026-01-25 16:41:01,294 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me user with rsik score more than 25
2026-01-25 16:41:01,294 - nl2sql - INFO - endpoints.py:48 - Query success! 17 rows returned.
2026-01-25 16:42:07,983 - nl2sql - INFO - endpoints.py:14 - Incoming query: show me users with risk score more than 25 | Domain: general
2026-01-25 16:42:07,984 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-01-25 16:42:07,991 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: show me users with risk score more than 25
2026-01-25 16:42:08,000 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-01-25 16:42:09,607 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-01-25 16:42:09,609 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:42:09,609 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-01-25 16:42:09,613 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-01-25 16:42:10,456 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_score...
2026-01-25 16:42:10,458 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_score': 25}
2026-01-25 16:42:10,462 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-01-25 16:42:10,471 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: show me users with risk score more than 25
2026-01-25 16:42:10,476 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-01-25 16:42:11,105 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 16:42:11,105 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 16:42:11,111 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT user_id, full_name, risk_score FROM users W...
2026-01-25 16:42:11,112 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-01-25 16:42:11,120 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-01-25 16:42:11,130 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT user_id, full_name, risk_score FROM users WHERE risk_score > 25
2026-01-25 16:42:11,140 - nl2sql - INFO - database.py:60 - Execution complete. Returned 131 rows.
2026-01-25 16:42:11,142 - nl2sql - INFO - workflow.py:92 - Query execution returned 131 rows.
2026-01-25 16:42:11,144 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-01-25 16:42:12,278 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Use...
2026-01-25 16:42:12,283 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: show me users with risk score more than 25
2026-01-25 16:42:12,288 - nl2sql - INFO - endpoints.py:48 - Query success! 131 rows returned.
2026-02-01 17:58:00,301 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 17:58:00,332 - nl2sql - INFO - main.py:12 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:14:19,727 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show regulatory compliance status | Domain: general
2026-02-01 19:14:19,794 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:14:19,795 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show regulatory compliance status
2026-02-01 19:14:19,805 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:14:21,123 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:14:21,124 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:14:21,124 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:14:21,126 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:14:21,845 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:14:21,845 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:14:21,847 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:14:21,847 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show regulatory compliance status
2026-02-01 19:14:21,848 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:14:23,044 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain inform...
2026-02-01 19:14:23,044 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show regulatory compliance status | Msg: Error: The database schema does not contain inform...
2026-02-01 19:14:23,044 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not contain inform...
2026-02-01 19:14:23,045 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:14:23,049 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 19.
  Error: The [4mdatabase[0m schema does not contain information about "regulatory compliance status". Try asking about: users (
2026-02-01 19:14:23,050 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-02-01 19:14:26,020 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT kyc_status FROM users...
2026-02-01 19:14:26,020 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:14:26,022 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:14:26,022 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT kyc_status FROM users
2026-02-01 19:14:26,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-02-01 19:14:26,027 - nl2sql - INFO - workflow.py:92 - Query execution returned 500 rows.
2026-02-01 19:14:26,028 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:14:26,964 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Regul...
2026-02-01 19:14:26,964 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show regulatory compliance status
2026-02-01 19:14:26,964 - nl2sql - INFO - endpoints.py:48 - Query success! 500 rows returned.
2026-02-01 19:15:07,827 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show regulatory compliance status | Domain: general
2026-02-01 19:15:07,830 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:15:07,830 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show regulatory compliance status
2026-02-01 19:15:07,831 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:15:08,445 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:15:08,446 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:15:08,447 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:15:08,450 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:15:09,121 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:15:09,122 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:15:09,122 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:15:09,123 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show regulatory compliance status
2026-02-01 19:15:09,123 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:15:11,052 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain explic...
2026-02-01 19:15:11,053 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show regulatory compliance status | Msg: Error: The database schema does not contain explic...
2026-02-01 19:15:11,053 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not contain explic...
2026-02-01 19:15:11,053 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:15:11,054 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Error tokenizing 'ut: users, kyc_status, kyc_expiry, risk_assessmen'
2026-02-01 19:15:11,054 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-02-01 19:15:11,854 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT u.kyc_status, u.kyc_expiry, u.risk_assessme...
2026-02-01 19:15:11,854 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:15:11,856 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:15:11,856 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT u.kyc_status, u.kyc_expiry, u.risk_assessment FROM users u
2026-02-01 19:15:11,858 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: u.kyc_expiry
[SQL: SELECT u.kyc_status, u.kyc_expiry, u.risk_assessment FROM users u]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT u.kyc_status, u.kyc_expiry, u.risk_assessment FROM users u
2026-02-01 19:15:11,858 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-02-01 19:15:11,859 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show regulatory compliance status
2026-02-01 19:15:11,859 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-02-01 19:15:20,956 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show regulatory compliance status | Domain: general
2026-02-01 19:15:20,957 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:15:20,957 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show regulatory compliance status
2026-02-01 19:15:20,959 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:15:21,851 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:15:21,851 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:15:21,852 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:15:21,854 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:15:22,964 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:15:22,965 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:15:22,965 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:15:22,965 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show regulatory compliance status
2026-02-01 19:15:22,966 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:15:25,905 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Regulatory compliance status is not a direc...
2026-02-01 19:15:25,905 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show regulatory compliance status | Msg: Error: Regulatory compliance status is not a direc...
2026-02-01 19:15:25,905 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Regulatory compliance status is not a direc...
2026-02-01 19:15:25,906 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:15:25,906 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 28.
  Error: Regulatory [4mcompliance[0m status is not a directly available column. Try asking about: users (kyc_status, kyc_expiry, risk_le
2026-02-01 19:15:25,906 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-02-01 19:15:26,533 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT kyc_status FROM users...
2026-02-01 19:15:26,534 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:15:26,535 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:15:26,535 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT kyc_status FROM users
2026-02-01 19:15:26,537 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-02-01 19:15:26,537 - nl2sql - INFO - workflow.py:92 - Query execution returned 500 rows.
2026-02-01 19:15:26,537 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:15:28,021 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Regul...
2026-02-01 19:15:28,021 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show regulatory compliance status
2026-02-01 19:15:28,021 - nl2sql - INFO - endpoints.py:48 - Query success! 500 rows returned.
2026-02-01 19:30:27,397 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:30:27,429 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:30:28,402 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:30:28,427 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:30:45,695 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:30:45,721 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:31:06,781 - nl2sql - INFO - endpoints.py:14 - Incoming query: Show regulatory compliance status | Domain: general
2026-02-01 19:31:06,860 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:31:06,860 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Show regulatory compliance status
2026-02-01 19:31:06,868 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:31:08,766 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:31:08,766 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:31:08,766 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:31:08,767 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:31:09,430 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:31:09,430 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:31:09,431 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:31:09,431 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Show regulatory compliance status
2026-02-01 19:31:09,433 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:31:10,219 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The database schema does not contain direct...
2026-02-01 19:31:10,220 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Show regulatory compliance status | Msg: Error: The database schema does not contain direct...
2026-02-01 19:31:10,221 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The database schema does not contain direct...
2026-02-01 19:31:10,223 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:31:10,226 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Error tokenizing ' about: users (kyc_status, risk_level, pep_status'
2026-02-01 19:31:10,229 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-02-01 19:31:10,980 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT
  kyc_status,
  risk_level,
  pep_status
FR...
2026-02-01 19:31:10,981 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:31:10,982 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:31:10,982 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT
  kyc_status,
  risk_level,
  pep_status
FROM users;
2026-02-01 19:31:10,983 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: pep_status
[SQL: SELECT
  kyc_status,
  risk_level,
  pep_status
FROM users;]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT
  kyc_status,
  risk_level,
  pep_status
FROM users;
2026-02-01 19:31:10,983 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-02-01 19:31:10,984 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Show regulatory compliance status
2026-02-01 19:31:10,984 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-02-01 19:31:45,825 - nl2sql - INFO - endpoints.py:14 - Incoming query: Pending audit items | Domain: general
2026-02-01 19:31:45,827 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:31:45,827 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Pending audit items
2026-02-01 19:31:45,828 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:31:46,524 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:31:46,524 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:31:46,524 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:31:46,525 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:31:47,163 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "status": "OPEN"
  ...
2026-02-01 19:31:47,163 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'status': 'OPEN'}
2026-02-01 19:31:47,166 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:31:47,917 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Are you looking for pending items related to user ...
2026-02-01 19:31:47,918 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: Pending audit items
2026-02-01 19:31:59,891 - nl2sql - INFO - endpoints.py:14 - Incoming query: login activity | Domain: general
2026-02-01 19:31:59,892 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:31:59,892 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: login activity
2026-02-01 19:31:59,892 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:32:00,594 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:32:00,596 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:32:00,596 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:32:00,605 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:32:01,218 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "resource_type": "l...
2026-02-01 19:32:01,218 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'resource_type': 'login_events'}
2026-02-01 19:32:01,219 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:32:01,219 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: login activity
2026-02-01 19:32:01,220 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:32:01,763 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM login_events LIMIT 10;...
2026-02-01 19:32:01,763 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT * FROM login_events LIMIT 10;...
2026-02-01 19:32:01,763 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT * FROM login_events LIMIT 10;...
2026-02-01 19:32:01,764 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:32:01,765 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:32:01,765 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM login_events LIMIT 10;
2026-02-01 19:32:01,767 - nl2sql - INFO - database.py:60 - Execution complete. Returned 10 rows.
2026-02-01 19:32:01,767 - nl2sql - INFO - workflow.py:92 - Query execution returned 10 rows.
2026-02-01 19:32:01,767 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:32:03,049 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Log...
2026-02-01 19:32:03,049 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: login activity
2026-02-01 19:32:03,050 - nl2sql - INFO - endpoints.py:48 - Query success! 10 rows returned.
2026-02-01 19:33:04,964 - nl2sql - INFO - endpoints.py:14 - Incoming query: Give a distribution of high risk users | Domain: general
2026-02-01 19:33:04,970 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:33:04,970 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give a distribution of high risk users
2026-02-01 19:33:04,981 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:33:05,693 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:33:05,693 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:33:05,693 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:33:05,694 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:33:06,314 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_level...
2026-02-01 19:33:06,314 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_level': 'HIGH'}
2026-02-01 19:33:06,315 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:33:06,315 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Give a distribution of high risk users
2026-02-01 19:33:06,316 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:33:07,021 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT risk_level, COUNT(user_id) AS user_count FR...
2026-02-01 19:33:07,022 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT risk_level, COUNT(user_id) AS user_count FR...
2026-02-01 19:33:07,022 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT risk_level, COUNT(user_id) AS user_count FR...
2026-02-01 19:33:07,022 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:33:07,024 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:33:07,024 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level, COUNT(user_id) AS user_count FROM users WHERE risk_level = 'HIGH' GROUP BY risk_level
2026-02-01 19:33:07,027 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-02-01 19:33:07,027 - nl2sql - INFO - workflow.py:92 - Query execution returned 1 rows.
2026-02-01 19:33:07,027 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:33:07,900 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Distr...
2026-02-01 19:33:07,900 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Give a distribution of high risk users
2026-02-01 19:33:07,900 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-02-01 19:34:55,901 - nl2sql - INFO - endpoints.py:14 - Incoming query: Give a distribution of high risk users | Domain: general
2026-02-01 19:34:55,909 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:34:55,909 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give a distribution of high risk users
2026-02-01 19:34:55,910 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:34:56,541 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:34:56,541 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:34:56,541 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:34:56,542 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:34:57,898 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "risk_assessment.le...
2026-02-01 19:34:57,898 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_assessment.level': 'HIGH'}
2026-02-01 19:34:57,899 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:34:57,899 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Give a distribution of high risk users
2026-02-01 19:34:57,899 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:34:58,535 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT risk_level, COUNT(user_id) FROM users WHERE...
2026-02-01 19:34:58,536 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT risk_level, COUNT(user_id) FROM users WHERE...
2026-02-01 19:34:58,536 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT risk_level, COUNT(user_id) FROM users WHERE...
2026-02-01 19:34:58,536 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:34:58,538 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:34:58,538 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level, COUNT(user_id) FROM users WHERE risk_level = 'HIGH' GROUP BY risk_level
2026-02-01 19:34:58,541 - nl2sql - INFO - database.py:60 - Execution complete. Returned 1 rows.
2026-02-01 19:34:58,541 - nl2sql - INFO - workflow.py:92 - Query execution returned 1 rows.
2026-02-01 19:34:58,542 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:34:59,617 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Distr...
2026-02-01 19:34:59,617 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Give a distribution of high risk users
2026-02-01 19:34:59,617 - nl2sql - INFO - endpoints.py:48 - Query success! 1 rows returned.
2026-02-01 19:35:26,146 - nl2sql - INFO - endpoints.py:14 - Incoming query: Give me a distribution of risk levels | Domain: general
2026-02-01 19:35:26,147 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:35:26,147 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give me a distribution of risk levels
2026-02-01 19:35:26,148 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:35:26,723 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:35:26,723 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:35:26,723 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:35:26,724 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:35:27,898 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:35:27,898 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:35:27,899 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:35:27,899 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Give me a distribution of risk levels
2026-02-01 19:35:27,899 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:35:28,455 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT risk_level, COUNT(user_id) AS user_count FR...
2026-02-01 19:35:28,455 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT risk_level, COUNT(user_id) AS user_count FR...
2026-02-01 19:35:28,455 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT risk_level, COUNT(user_id) AS user_count FR...
2026-02-01 19:35:28,455 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:35:28,456 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:35:28,457 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level, COUNT(user_id) AS user_count FROM users GROUP BY risk_level;
2026-02-01 19:35:28,459 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-02-01 19:35:28,459 - nl2sql - INFO - workflow.py:92 - Query execution returned 3 rows.
2026-02-01 19:35:28,460 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:35:29,897 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Distr...
2026-02-01 19:35:29,897 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Give me a distribution of risk levels
2026-02-01 19:35:29,897 - nl2sql - INFO - endpoints.py:48 - Query success! 3 rows returned.
2026-02-01 19:37:39,273 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:37:39,297 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:38:00,606 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:38:00,634 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:40:48,615 - nl2sql - INFO - endpoints.py:14 - Incoming query: Give me a distribution of risk of users | Domain: general
2026-02-01 19:40:48,625 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:40:48,626 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give me a distribution of risk of users
2026-02-01 19:40:48,649 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:40:50,674 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:40:50,674 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:40:50,674 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:40:50,675 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:40:53,610 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "risk_asses...
2026-02-01 19:40:53,610 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_assessment.level': ['LOW', 'MEDIUM', 'HIGH']}
2026-02-01 19:40:53,612 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:40:54,281 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Could you please specify what criteria you'd like ...
2026-02-01 19:40:54,281 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: Give me a distribution of risk of users
2026-02-01 19:41:05,149 - nl2sql - INFO - endpoints.py:14 - Incoming query: Users have a risk factor | Domain: general
2026-02-01 19:41:05,150 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:41:05,150 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Users have a risk factor
2026-02-01 19:41:05,150 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:41:05,814 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:41:05,814 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:41:05,814 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:41:05,814 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:41:06,438 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:41:06,438 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:41:06,439 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:41:06,439 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Users have a risk factor
2026-02-01 19:41:06,440 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:41:07,130 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: The request "Users have a risk factor" is t...
2026-02-01 19:41:07,130 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: Users have a risk factor | Msg: Error: The request "Users have a risk factor" is t...
2026-02-01 19:41:07,130 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: The request "Users have a risk factor" is t...
2026-02-01 19:41:07,131 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:41:07,133 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 18.
  Error: The [4mrequest[0m "Users have a risk factor" is too vague. Please specify what information you need about the risk fa
2026-02-01 19:41:07,134 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-02-01 19:41:07,649 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM users WHERE risk_level IS NOT NULL O...
2026-02-01 19:41:07,649 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:41:07,651 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:41:07,651 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE risk_level IS NOT NULL OR risk_score IS NOT NULL
2026-02-01 19:41:07,656 - nl2sql - INFO - database.py:60 - Execution complete. Returned 500 rows.
2026-02-01 19:41:07,656 - nl2sql - INFO - workflow.py:92 - Query execution returned 500 rows.
2026-02-01 19:41:07,656 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:41:08,514 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Distr...
2026-02-01 19:41:08,515 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Users have a risk factor
2026-02-01 19:41:08,515 - nl2sql - INFO - endpoints.py:48 - Query success! 500 rows returned.
2026-02-01 19:41:16,195 - nl2sql - INFO - endpoints.py:14 - Incoming query: Try again | Domain: general
2026-02-01 19:41:16,196 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:41:16,196 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Try again
2026-02-01 19:41:16,196 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:41:16,787 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "UNKNOWN",
  "confidence": 0...
2026-02-01 19:41:16,787 - nl2sql - INFO - intent_classification.py:82 - Classification Result: UNKNOWN (conf: 0.8) | Needs Clarification: False
2026-02-01 19:41:16,787 - nl2sql - INFO - workflow.py:24 - Intent classified: UNKNOWN (conf: 0.8) | Needs Clarification: False
2026-02-01 19:41:16,788 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:41:17,391 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:41:17,391 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:41:17,392 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:41:17,392 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Try again
2026-02-01 19:41:17,392 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:41:18,092 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT rule_name, severity, status, created_at FRO...
2026-02-01 19:41:18,093 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT rule_name, severity, status, created_at FRO...
2026-02-01 19:41:18,093 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT rule_name, severity, status, created_at FRO...
2026-02-01 19:41:18,093 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:41:18,094 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:41:18,094 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT rule_name, severity, status, created_at FROM alerts WHERE status = 'OPEN' AND severity = 'HIGH' ORDER BY created_at DESC;
2026-02-01 19:41:18,096 - nl2sql - INFO - database.py:60 - Execution complete. Returned 32 rows.
2026-02-01 19:41:18,096 - nl2sql - INFO - workflow.py:92 - Query execution returned 32 rows.
2026-02-01 19:41:18,096 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:41:19,065 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "table",
  "title": "Ope...
2026-02-01 19:41:19,065 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Try again
2026-02-01 19:41:19,065 - nl2sql - INFO - endpoints.py:48 - Query success! 32 rows returned.
2026-02-01 19:41:28,373 - nl2sql - INFO - endpoints.py:14 - Incoming query: Give me a distribution of risk of users | Domain: general
2026-02-01 19:41:28,374 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:41:28,374 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give me a distribution of risk of users
2026-02-01 19:41:28,375 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:41:29,021 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:41:29,021 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:41:29,021 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:41:29,021 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:41:30,436 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {
    "risk_assessment.le...
2026-02-01 19:41:30,437 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'risk_assessment.level': ['LOW', 'MEDIUM', 'HIGH']}
2026-02-01 19:41:30,437 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:41:31,195 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Could you tell me what criteria you'd like to use ...
2026-02-01 19:41:31,196 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: Give me a distribution of risk of users
2026-02-01 19:41:42,508 - nl2sql - INFO - endpoints.py:14 - Incoming query: High transactions | Domain: general
2026-02-01 19:41:42,508 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:41:42,508 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: High transactions
2026-02-01 19:41:42,509 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:41:43,091 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:41:43,091 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:41:43,092 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: True
2026-02-01 19:41:43,092 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:41:43,712 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {
    "transactio...
2026-02-01 19:41:43,712 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {'transaction_type': 'DEPOSIT', 'status': 'PROCESSING'}
2026-02-01 19:41:43,713 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:41:44,689 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: By what metric would you like to define "high tran...
2026-02-01 19:41:44,690 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: High transactions
2026-02-01 19:42:01,573 - nl2sql - INFO - endpoints.py:14 - Incoming query: total value | Domain: general
2026-02-01 19:42:01,574 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:42:01,574 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: total value
2026-02-01 19:42:01,574 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:42:02,470 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:42:02,470 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: True
2026-02-01 19:42:02,470 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: True
2026-02-01 19:42:02,471 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:42:03,629 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-02-01 19:42:03,629 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:42:03,629 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:42:04,252 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Are you looking for the total value of transaction...
2026-02-01 19:42:04,252 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: total value
2026-02-01 19:42:21,488 - nl2sql - INFO - endpoints.py:14 - Incoming query: value of transaction  | Domain: general
2026-02-01 19:42:21,489 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:42:21,489 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: value of transaction 
2026-02-01 19:42:21,489 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:42:22,412 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:42:22,412 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.8) | Needs Clarification: True
2026-02-01 19:42:22,412 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.8) | Needs Clarification: True
2026-02-01 19:42:22,413 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:42:23,207 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:42:23,208 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:42:23,208 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:42:23,824 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Are you looking for the total value of all transac...
2026-02-01 19:42:23,824 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: value of transaction 
2026-02-01 19:42:34,278 - nl2sql - INFO - endpoints.py:14 - Incoming query: total value | Domain: general
2026-02-01 19:42:34,279 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:42:34,279 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: total value
2026-02-01 19:42:34,279 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:42:35,336 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:42:35,336 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.8) | Needs Clarification: True
2026-02-01 19:42:35,336 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.8) | Needs Clarification: True
2026-02-01 19:42:35,337 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:42:35,984 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-02-01 19:42:35,984 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:42:35,985 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:42:36,775 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Are you looking for the total value of all transac...
2026-02-01 19:42:36,776 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: total value
2026-02-01 19:42:45,539 - nl2sql - INFO - endpoints.py:14 - Incoming query: value of all transactions, | Domain: general
2026-02-01 19:42:45,540 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:42:45,540 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: value of all transactions,
2026-02-01 19:42:45,540 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:42:46,112 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:42:46,112 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: True
2026-02-01 19:42:46,112 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: True
2026-02-01 19:42:46,113 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:42:46,650 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:42:46,650 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:42:46,651 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a helpful assistant helping clarify datab...
2026-02-01 19:42:47,893 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Could you please specify the time period for which...
2026-02-01 19:42:47,893 - nl2sql - INFO - endpoints.py:24 - Graph execution status: needs_clarification for query: value of all transactions,
2026-02-01 19:42:54,584 - nl2sql - INFO - endpoints.py:14 - Incoming query: last 6 months | Domain: general
2026-02-01 19:42:54,585 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:42:54,585 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: last 6 months
2026-02-01 19:42:54,586 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:42:55,266 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:42:55,266 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.8) | Needs Clarification: False
2026-02-01 19:42:55,266 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.8) | Needs Clarification: False
2026-02-01 19:42:55,267 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:42:55,866 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-02-01 19:42:55,866 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:42:55,867 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:42:55,867 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: last 6 months
2026-02-01 19:42:55,867 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:42:57,894 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: Error: Please specify what information you are loo...
2026-02-01 19:42:57,894 - nl2sql - WARNING - sql_generation.py:80 - SQL Generation guidance response for query: last 6 months | Msg: Error: Please specify what information you are loo...
2026-02-01 19:42:57,894 - nl2sql - INFO - workflow.py:63 - SQL Generated: Error: Please specify what information you are loo...
2026-02-01 19:42:57,895 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:42:57,896 - nl2sql - WARNING - workflow.py:71 - SQL Validation Error: Invalid expression / Unexpected token. Line 1, Col: 21.
  Error: Please [4mspecify[0m what information you are looking for in the last 6 months. Try asking about: transactions, login_ev
2026-02-01 19:42:57,896 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a SQL expert. The following SQLite query ...
2026-02-01 19:42:58,892 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT * FROM login_events WHERE timestamp >= date...
2026-02-01 19:42:58,893 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:42:58,894 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:42:58,894 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM login_events WHERE timestamp >= date('now', '-6 months')
2026-02-01 19:42:58,895 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: timestamp
[SQL: SELECT * FROM login_events WHERE timestamp >= date('now', '-6 months')]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT * FROM login_events WHERE timestamp >= date('now', '-6 months')
2026-02-01 19:42:58,895 - nl2sql - INFO - workflow.py:92 - Query execution returned 0 rows.
2026-02-01 19:42:58,896 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: last 6 months
2026-02-01 19:42:58,896 - nl2sql - INFO - endpoints.py:48 - Query success! 0 rows returned.
2026-02-01 19:43:11,637 - nl2sql - INFO - endpoints.py:14 - Incoming query: Give me the risk distribution | Domain: general
2026-02-01 19:43:11,639 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:43:11,639 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give me the risk distribution
2026-02-01 19:43:11,639 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:43:12,516 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 1....
2026-02-01 19:43:12,516 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:43:12,516 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:43:12,517 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:43:13,653 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-02-01 19:43:13,653 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:43:13,654 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:43:13,654 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Give me the risk distribution
2026-02-01 19:43:13,654 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:43:14,574 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT
  risk_level,
  COUNT(user_id) AS user_coun...
2026-02-01 19:43:14,574 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT
  risk_level,
  COUNT(user_id) AS user_coun...
2026-02-01 19:43:14,574 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT
  risk_level,
  COUNT(user_id) AS user_coun...
2026-02-01 19:43:14,574 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:43:14,575 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:43:14,575 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT
  risk_level,
  COUNT(user_id) AS user_count
FROM users
GROUP BY
  risk_level
ORDER BY
  user_count DESC;
2026-02-01 19:43:14,578 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-02-01 19:43:14,578 - nl2sql - INFO - workflow.py:92 - Query execution returned 3 rows.
2026-02-01 19:43:14,578 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:43:15,471 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "Distr...
2026-02-01 19:43:15,472 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Give me the risk distribution
2026-02-01 19:43:15,472 - nl2sql - INFO - endpoints.py:48 - Query success! 3 rows returned.
2026-02-01 19:43:29,019 - nl2sql - INFO - endpoints.py:14 - Incoming query: Give me the risk distribution | Domain: general
2026-02-01 19:43:29,020 - nl2sql - INFO - workflow.py:16 - Node: [classify_intent]
2026-02-01 19:43:29,020 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give me the risk distribution
2026-02-01 19:43:29,021 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an AI assistant for a Database system.
Yo...
2026-02-01 19:43:30,032 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:43:30,033 - nl2sql - INFO - intent_classification.py:82 - Classification Result: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:43:30,033 - nl2sql - INFO - workflow.py:24 - Intent classified: SELECT (conf: 0.9) | Needs Clarification: False
2026-02-01 19:43:30,034 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a Precise Entity Extractor and Resolver.
...
2026-02-01 19:43:30,609 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: {
  "resolved_entities": {},
  "metadata": {
    "...
2026-02-01 19:43:30,609 - nl2sql - INFO - entity_extractor.py:82 - Entities Extracted/Resolved: {}
2026-02-01 19:43:30,609 - nl2sql - INFO - workflow.py:54 - Node: [generate_sql]
2026-02-01 19:43:30,609 - nl2sql - INFO - sql_generation.py:25 - Generating SQL for domain: general | Query: Give me the risk distribution
2026-02-01 19:43:30,610 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are an expert SQL assistant for the general d...
2026-02-01 19:43:31,167 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: SELECT
  risk_level,
  COUNT(*) AS user_count
FROM...
2026-02-01 19:43:31,167 - nl2sql - INFO - sql_generation.py:91 - SQL Generated and cleaned: SELECT
  risk_level,
  COUNT(*) AS user_count
FROM...
2026-02-01 19:43:31,167 - nl2sql - INFO - workflow.py:63 - SQL Generated: SELECT
  risk_level,
  COUNT(*) AS user_count
FROM...
2026-02-01 19:43:31,167 - nl2sql - INFO - workflow.py:67 - Node: [validate_sql]
2026-02-01 19:43:31,168 - nl2sql - INFO - workflow.py:88 - Node: [execute_query]
2026-02-01 19:43:31,168 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT
  risk_level,
  COUNT(*) AS user_count
FROM users
GROUP BY
  risk_level;
2026-02-01 19:43:31,169 - nl2sql - INFO - database.py:60 - Execution complete. Returned 3 rows.
2026-02-01 19:43:31,169 - nl2sql - INFO - workflow.py:92 - Query execution returned 3 rows.
2026-02-01 19:43:31,170 - nl2sql - INFO - llm.py:44 - LLM [gemini] generating response for prompt snippet: 
You are a data visualization expert. Recommend th...
2026-02-01 19:43:32,150 - nl2sql - INFO - llm.py:55 - LLM response received. Snippet: ```json
{
  "chart_type": "bar",
  "title": "User ...
2026-02-01 19:43:32,151 - nl2sql - INFO - endpoints.py:24 - Graph execution status: success for query: Give me the risk distribution
2026-02-01 19:43:32,151 - nl2sql - INFO - endpoints.py:48 - Query success! 3 rows returned.
2026-02-01 19:46:28,040 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:46:28,065 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:46:43,953 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:46:43,981 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
>>>>>>> 2673a712ac617f63f7a7b0884fbe6da3c896e718
2026-02-01 19:54:54,756 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:54:54,894 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:55:12,309 - nl2sql - INFO - database.py:10 - DatabaseService initialized with engine: ./derivinsight_fixed.db
2026-02-01 19:55:12,404 - nl2sql - INFO - main.py:13 - Starting NL2SQL Pipeline on port 8080...
2026-02-01 19:55:33,638 - nl2sql - INFO - endpoints.py:16 - Incoming query: Give user trends based on risk | Domain: general
2026-02-01 19:55:33,642 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 19:55:33,642 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 19:55:33,642 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give user trends based on risk
2026-02-01 19:55:33,653 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:55:38,304 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:55:38,304 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-02-01 19:55:38,304 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:55:38,891 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-02-01 19:55:38,891 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:55:39,653 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:55:39,653 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-02-01 19:55:39,655 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-02-01 19:55:39,656 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-02-01 19:55:39,656 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: Give user trends based on risk
2026-02-01 19:55:39,658 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-02-01 19:55:39,658 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:56:08,105 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-02-01 19:56:08,107 - nl2sql - INFO - sql_generation.py:134 - SQL Generated and cleaned: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-02-01 19:56:08,107 - nl2sql - INFO - workflow.py:83 - SQL Generated: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-02-01 19:56:08,117 - nl2sql - INFO - workflow.py:87 - Node: [validate_sql]
2026-02-01 19:56:08,150 - nl2sql - INFO - workflow.py:108 - Node: [execute_query]
2026-02-01 19:56:08,151 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level, COUNT(user_id) FROM users GROUP BY risk_level;
2026-02-01 19:56:08,174 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-02-01 19:56:08,175 - nl2sql - INFO - workflow.py:112 - Query execution returned 0 rows.
2026-02-01 19:56:08,180 - nl2sql - INFO - endpoints.py:26 - Graph execution status: success for query: Give user trends based on risk
2026-02-01 19:56:08,180 - nl2sql - INFO - endpoints.py:50 - Query success! 0 rows returned.
2026-02-01 19:56:21,779 - nl2sql - INFO - endpoints.py:16 - Incoming query: Give user trends based on risk | Domain: general
2026-02-01 19:56:21,781 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 19:56:21,781 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 19:56:21,781 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give user trends based on risk
2026-02-01 19:56:21,782 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:56:31,852 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:56:31,852 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-02-01 19:56:31,853 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:56:32,330 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-02-01 19:56:32,331 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:56:33,098 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:56:33,099 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-02-01 19:56:33,108 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-02-01 19:56:33,111 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-02-01 19:56:33,111 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: Give user trends based on risk
2026-02-01 19:56:33,114 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-02-01 19:56:33,114 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:57:11,656 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-02-01 19:57:11,656 - nl2sql - INFO - sql_generation.py:134 - SQL Generated and cleaned: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-02-01 19:57:11,657 - nl2sql - INFO - workflow.py:83 - SQL Generated: SELECT risk_level, COUNT(user_id) FROM users GROUP...
2026-02-01 19:57:11,659 - nl2sql - INFO - workflow.py:87 - Node: [validate_sql]
2026-02-01 19:57:11,660 - nl2sql - INFO - workflow.py:108 - Node: [execute_query]
2026-02-01 19:57:11,661 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT risk_level, COUNT(user_id) FROM users GROUP BY risk_level;
2026-02-01 19:57:11,662 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-02-01 19:57:11,662 - nl2sql - INFO - workflow.py:112 - Query execution returned 0 rows.
2026-02-01 19:57:11,663 - nl2sql - INFO - endpoints.py:26 - Graph execution status: success for query: Give user trends based on risk
2026-02-01 19:57:11,663 - nl2sql - INFO - endpoints.py:50 - Query success! 0 rows returned.
2026-02-01 19:57:56,117 - nl2sql - INFO - endpoints.py:16 - Incoming query: What are the risk lev | Domain: general
2026-02-01 19:57:56,121 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 19:57:56,121 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 19:57:56,121 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: What are the risk lev
2026-02-01 19:57:56,122 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:58:01,944 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:58:01,945 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 0.85) | Needs Clarification: True
2026-02-01 19:58:01,945 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:58:02,450 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-02-01 19:58:02,450 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:58:03,083 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:58:03,084 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-02-01 19:58:03,088 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.85) | Needs Clarification: True
2026-02-01 19:58:03,089 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:58:05,404 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: I see you're asking about risk levels. While I can...
2026-02-01 19:58:05,405 - nl2sql - INFO - endpoints.py:26 - Graph execution status: needs_clarification for query: What are the risk lev
2026-02-01 19:58:16,925 - nl2sql - INFO - endpoints.py:16 - Incoming query: users with an elevated risk score | Domain: general
2026-02-01 19:58:16,930 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 19:58:16,930 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 19:58:16,930 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: users with an elevated risk score
2026-02-01 19:58:16,932 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:58:26,041 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:58:26,042 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-02-01 19:58:26,042 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:58:26,548 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-02-01 19:58:26,550 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:58:27,380 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "users.risk...
2026-02-01 19:58:27,381 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'users.risk_score': [45, 72, 89, 52, 75, 71]}
2026-02-01 19:58:27,383 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-02-01 19:58:27,384 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-02-01 19:58:27,384 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: users with an elevated risk score
2026-02-01 19:58:27,386 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-02-01 19:58:27,386 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:58:39,612 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT username FROM users WHERE UPPER(risk_level)...
2026-02-01 19:58:39,612 - nl2sql - INFO - sql_generation.py:134 - SQL Generated and cleaned: SELECT username FROM users WHERE UPPER(risk_level)...
2026-02-01 19:58:39,612 - nl2sql - INFO - workflow.py:83 - SQL Generated: SELECT username FROM users WHERE UPPER(risk_level)...
2026-02-01 19:58:39,613 - nl2sql - INFO - workflow.py:87 - Node: [validate_sql]
2026-02-01 19:58:39,615 - nl2sql - INFO - workflow.py:108 - Node: [execute_query]
2026-02-01 19:58:39,615 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT username FROM users WHERE UPPER(risk_level) LIKE '%ELEVATED%';
2026-02-01 19:58:39,616 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: username
[SQL: SELECT username FROM users WHERE UPPER(risk_level) LIKE '%ELEVATED%';]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT username FROM users WHERE UPPER(risk_level) LIKE '%ELEVATED%';
2026-02-01 19:58:39,616 - nl2sql - INFO - workflow.py:112 - Query execution returned 0 rows.
2026-02-01 19:58:39,617 - nl2sql - INFO - endpoints.py:26 - Graph execution status: success for query: users with an elevated risk score
2026-02-01 19:58:39,617 - nl2sql - INFO - endpoints.py:50 - Query success! 0 rows returned.
2026-02-01 19:58:56,825 - nl2sql - INFO - endpoints.py:16 - Incoming query: users with an HIGH risk score | Domain: general
2026-02-01 19:58:56,830 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 19:58:56,830 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 19:58:56,831 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: users with an HIGH risk score
2026-02-01 19:58:56,836 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:59:01,223 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: {
  "intent": "SELECT",
  "confidence": 1.0,
  "co...
2026-02-01 19:59:01,224 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:59:01,224 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:59:01,754 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["users"]...
2026-02-01 19:59:01,755 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:59:03,199 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "users.risk...
2026-02-01 19:59:03,199 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'users.risk_level': 'HIGH'}
2026-02-01 19:59:03,202 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 1.0) | Needs Clarification: False
2026-02-01 19:59:03,203 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-02-01 19:59:03,203 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: users with an HIGH risk score
2026-02-01 19:59:03,205 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-02-01 19:59:03,205 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:59:15,908 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT * FROM users WHERE UPPER(risk_level) LIKE '...
2026-02-01 19:59:15,909 - nl2sql - INFO - sql_generation.py:134 - SQL Generated and cleaned: SELECT * FROM users WHERE UPPER(risk_level) LIKE '...
2026-02-01 19:59:15,909 - nl2sql - INFO - workflow.py:83 - SQL Generated: SELECT * FROM users WHERE UPPER(risk_level) LIKE '...
2026-02-01 19:59:15,910 - nl2sql - INFO - workflow.py:87 - Node: [validate_sql]
2026-02-01 19:59:15,912 - nl2sql - INFO - workflow.py:108 - Node: [execute_query]
2026-02-01 19:59:15,912 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT * FROM users WHERE UPPER(risk_level) LIKE '%HIGH%';
2026-02-01 19:59:15,913 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-02-01 19:59:15,913 - nl2sql - INFO - workflow.py:112 - Query execution returned 0 rows.
2026-02-01 19:59:15,913 - nl2sql - INFO - endpoints.py:26 - Graph execution status: success for query: users with an HIGH risk score
2026-02-01 19:59:15,914 - nl2sql - INFO - endpoints.py:50 - Query success! 0 rows returned.
2026-02-01 19:59:40,219 - nl2sql - INFO - endpoints.py:16 - Incoming query: Give me insights on userlogins | Domain: general
2026-02-01 19:59:40,223 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 19:59:40,223 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 19:59:40,223 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: Give me insights on userlogins
2026-02-01 19:59:40,225 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 19:59:47,848 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 19:59:47,848 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: True
2026-02-01 19:59:47,848 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:59:48,361 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-02-01 19:59:48,374 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:59:49,068 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {},
  "metadata":...
2026-02-01 19:59:49,069 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {}
2026-02-01 19:59:49,071 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: True
2026-02-01 19:59:49,072 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 19:59:50,057 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: I understand you're interested in user login insig...
2026-02-01 19:59:50,059 - nl2sql - INFO - endpoints.py:26 - Graph execution status: needs_clarification for query: Give me insights on userlogins
2026-02-01 20:00:11,077 - nl2sql - INFO - endpoints.py:16 - Incoming query: **Failed login attempts** and their reasons? | Domain: general
2026-02-01 20:00:11,079 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 20:00:11,079 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 20:00:11,079 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: **Failed login attempts** and their reasons?
2026-02-01 20:00:11,080 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 20:00:14,735 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 20:00:14,735 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 0.98) | Needs Clarification: False
2026-02-01 20:00:14,735 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 20:00:15,259 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-02-01 20:00:15,261 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 20:00:17,490 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-02-01 20:00:17,491 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.status': 'FAILED'}
2026-02-01 20:00:17,493 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.98) | Needs Clarification: False
2026-02-01 20:00:17,494 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-02-01 20:00:17,494 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: **Failed login attempts** and their reasons?
2026-02-01 20:00:17,496 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-02-01 20:00:17,496 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 20:00:29,439 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT le.*, u.username FROM login_events le JOIN ...
2026-02-01 20:00:29,439 - nl2sql - INFO - sql_generation.py:134 - SQL Generated and cleaned: SELECT le.*, u.username FROM login_events le JOIN ...
2026-02-01 20:00:29,439 - nl2sql - INFO - workflow.py:83 - SQL Generated: SELECT le.*, u.username FROM login_events le JOIN ...
2026-02-01 20:00:29,440 - nl2sql - INFO - workflow.py:87 - Node: [validate_sql]
2026-02-01 20:00:29,442 - nl2sql - INFO - workflow.py:108 - Node: [execute_query]
2026-02-01 20:00:29,442 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT le.*, u.username FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE UPPER(le.status) LIKE '%FAILED%';
2026-02-01 20:00:29,442 - nl2sql - ERROR - database.py:67 - DATABASE EXECUTION ERROR: (sqlite3.OperationalError) no such column: u.username
[SQL: SELECT le.*, u.username FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE UPPER(le.status) LIKE '%FAILED%';]
(Background on this error at: https://sqlalche.me/e/20/e3q8) | Query: SELECT le.*, u.username FROM login_events le JOIN users u ON le.user_id = u.user_id WHERE UPPER(le.status) LIKE '%FAILED%';
2026-02-01 20:00:29,442 - nl2sql - INFO - workflow.py:112 - Query execution returned 0 rows.
2026-02-01 20:00:29,443 - nl2sql - INFO - endpoints.py:26 - Graph execution status: success for query: **Failed login attempts** and their reasons?
2026-02-01 20:00:29,443 - nl2sql - INFO - endpoints.py:50 - Query success! 0 rows returned.
2026-02-01 20:00:32,118 - nl2sql - INFO - endpoints.py:16 - Incoming query: **Login activity by country** or **device type**? | Domain: general
2026-02-01 20:00:32,119 - nl2sql - INFO - workflow.py:17 - Node: [classify_intent]
2026-02-01 20:00:32,119 - nl2sql - INFO - workflow.py:24 - Starting Intent Classification and Preprocessing in parallel for domain: general
2026-02-01 20:00:32,119 - nl2sql - INFO - intent_classification.py:15 - Classifying intent for domain: general | Query: **Login activity by country** or **device type**?
2026-02-01 20:00:32,120 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 20:00:57,825 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: ```json
{
  "intent": "SELECT",
  "confidence": 0....
2026-02-01 20:00:57,826 - nl2sql - INFO - intent_classification.py:95 - Classification Result: SELECT (conf: 0.95) | Needs Clarification: False
2026-02-01 20:00:57,826 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 20:00:58,386 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ["login_events"]...
2026-02-01 20:00:58,387 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-2.5-flash-lite] generating response...
2026-02-01 20:00:59,281 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-2.5-flash-lite]. Snippet: ```json
{
  "resolved_entities": {
    "login_even...
2026-02-01 20:00:59,283 - nl2sql - INFO - entity_extractor.py:144 - Final Extracted/Resolved Entities: {'login_events.country': ['Saudi Arabia', 'Singapore', 'France', 'India', 'Brazil', 'United Kingdom', 'Canada', 'Japan', 'Germany', 'UAE', 'Kuwait', 'Qatar', 'United States', 'Australia', 'Bahrain'], 'login_events.device_type': ['Desktop', 'Mobile', 'Tablet']}
2026-02-01 20:00:59,301 - nl2sql - INFO - workflow.py:34 - Intent classified: SELECT (conf: 0.95) | Needs Clarification: False
2026-02-01 20:00:59,303 - nl2sql - INFO - workflow.py:62 - Node: [generate_sql]
2026-02-01 20:00:59,303 - nl2sql - INFO - sql_generation.py:26 - Generating SQL for domain: general | Query: **Login activity by country** or **device type**?
2026-02-01 20:00:59,306 - nl2sql - INFO - sql_generation.py:52 - Using custom SQL prompt for domain: general
2026-02-01 20:00:59,306 - nl2sql - INFO - llm.py:56 - LLM [gemini] using model [gemini-3-flash-preview] generating response...
2026-02-01 20:01:15,356 - nl2sql - INFO - llm.py:88 - LLM response received from [gemini-3-flash-preview]. Snippet: SELECT country, device_type, COUNT(event_id) FROM ...
2026-02-01 20:01:15,358 - nl2sql - INFO - sql_generation.py:134 - SQL Generated and cleaned: SELECT country, device_type, COUNT(event_id) FROM ...
2026-02-01 20:01:15,358 - nl2sql - INFO - workflow.py:83 - SQL Generated: SELECT country, device_type, COUNT(event_id) FROM ...
2026-02-01 20:01:15,364 - nl2sql - INFO - workflow.py:87 - Node: [validate_sql]
2026-02-01 20:01:15,369 - nl2sql - INFO - workflow.py:108 - Node: [execute_query]
2026-02-01 20:01:15,370 - nl2sql - INFO - database.py:53 - Executing SQL: SELECT country, device_type, COUNT(event_id) FROM login_events GROUP BY country, device_type;
2026-02-01 20:01:15,372 - nl2sql - INFO - database.py:60 - Execution complete. Returned 0 rows.
2026-02-01 20:01:15,373 - nl2sql - INFO - workflow.py:112 - Query execution returned 0 rows.
2026-02-01 20:01:15,374 - nl2sql - INFO - endpoints.py:26 - Graph execution status: success for query: **Login activity by country** or **device type**?
2026-02-01 20:01:15,375 - nl2sql - INFO - endpoints.py:50 - Query success! 0 rows returned.
